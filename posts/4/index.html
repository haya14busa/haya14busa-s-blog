
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="ja"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>haya14busa</title>
  <meta name="author" content="haya14busa">

  
  <meta name="description" content="YAPC::Asia 2015 に1日目・2日目と参加してきました． ブログを書くまでがYAPCで，LTしてみたかったならやぷしー終了するまでにブログで発表すればいいじゃない YAPC 2015 初めての参加でしたが一言で言うと最高でした!!! 刺激になるトーク多すぎました． &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://haya14busa.com/posts/4/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="haya14busa" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39461503-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <div id="container">
    <header role="banner"><hgroup>
  <h1><a href="/">haya14busa</a></h1>
  
    <h2>haya14busa&#8217;s memo</h2>
  
</hgroup>

</header>
    <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="site:haya14busa.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
    <div id="main">
      <div id="content">
        <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/yapcasia-2015/">ブログを書くまでが #yapcasia なのでブログでLT発表して感想かく ― Vim駆動学習</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2015-08-23T10:24:12+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><p>YAPC::Asia 2015 に1日目・2日目と参加してきました．</p>

<h2>ブログを書くまでがYAPCで，LTしてみたかったならやぷしー終了するまでにブログで発表すればいいじゃない</h2>

<p>YAPC 2015 初めての参加でしたが一言で言うと<strong>最高</strong>でした!!! 刺激になるトーク多すぎました．</p>

<p>ただひとつ悔やまれるのは1日目の前日くらいに勢いでLT応募したけど，そのまま勢いで落ちたのでﾁｮｯﾄ発表してみたかった&hellip;倍率高すぎる〜</p>

<p>(本当に悔やまれるのはトラック被って見れなかった裏トラックを見れてないということで，資料とかまとめとかYouTube見ていくゾ!!!)</p>

<p>&hellip;ところで，YAPCはブログを書くまで終わらないんだからブログでLTしたかった内容発表すれば，
それはもうYAPCでLTしたことになるのでは&hellip;!?!?!?(混乱)</p>

<p>と考えたのでブログで発表したかった資料をあげる最高にカッコワルイことを今からします．
その後参加記みたいな何かを書いています．</p>

<p>いろいろと，読む前でも読んだ上でも思うことはあると思いますが自分でも思うことはあるので
察してそっとしておいてください!! いろいろと反省はしている．</p>

<h2>Vim 駆動学習</h2>

<script async class="speakerdeck-embed" data-id="62d0b9127b664ae5aad0e14742371fcc" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>


<ul>
<li><a href="http://yapcasia.org/2015/talk/show/8f1aad32-474d-11e5-a80e-c7de7d574c3a">Vim 駆動学習 - YAPC::Asia Tokyo 2015</a></li>
<li><a href="https://speakerdeck.com/haya14busa/vim-driven-learning">Vim Driven Learning // Speaker Deck</a></li>
</ul>


<p>※ 1箇所gifが表現できないのでクリックして見てと言っているけどSpeaker Deckだとクリックできないのでスルーしてください(PDFをダウンロードすれば一応クリックできるけど)</p>

<h2>LT説明や資料の反省とか．あと参考記事</h2>

<p>エモイ話だ&hellip;</p>

<p>基本的にはこれまでにどこかでアウトプットした内容で，なるべくそうならないように意識はしてたのだけど，
説明文とか内容とか何か聴衆に有益情報話すというより，単なる自分語り感が強すぎるのがｳｰﾝっていう感じだと思っています．</p>

<p>まぁ技術的な説明とかは他の人のほうが断然できるはずだし，
僕ができるのは僕の経験を話すこと．それが一番僕にしかできない発表で，
そこで何か聴衆に響かせることができたらいいなって考えたのでこういった内容になってます．</p>

<p>内容がだいたいどこかで以前アウトプットしたものになった原因は，これまで基本的には記事書くようにしていたからっていうことや，
聴衆がどうよりも経験としてYAPCみたいな舞台で発表したいというエゴによって自分のなかでGoサインが勢いで出てしまった感じになってます．</p>

<p>資料できてここまで書いて思ったけどたぶん落ちてよかったんじゃないかなぁみたいな思いもある．
普通に5minオーバーすると思うし．</p>

<p>これからまた頑張っていくゾイ!!!</p>

<h3>参考記事</h3>

<p>だいたい僕のブログ読んでたらLT資料読まなくてもだいたいわかる感じになっている．
もし興味出たっていう優しいかたは気になった記事を読んでいただけると少し詳しく書かれています．</p>

<ul>
<li>全体:

<ul>
<li><a href="http://haya14busa.com/vim_driven_learning/">1年間『Vim駆動学習』してきて最高に楽しかったのでオススメしたい - haya14busa</a></li>
<li><a href="http://haya14busa.com/haya14busa-s-happy-vimming-year-2014/">2014年の振り返り. またはプログラミング2年目をVimに捧げるとこうなるという話 - haya14busa</a></li>
</ul>
</li>
<li>vim-easymotionの話: <a href="http://haya14busa.com/mastering-vim-easymotion/">Vim-EasyMotionでカーソル移動を爆速にして生産性をもっと向上させる - haya14busa</a></li>
<li>incsearch.vimの話:

<ul>
<li><a href="http://haya14busa.com/enrich-your-search-experience-with-incsearch-vim/">incsearch.vimでVimの検索体験をリッチにする - haya14busa</a></li>
<li><a href="http://haya14busa.com/incsearch-dot-vim-ver-2/">Vimの検索はもっともっと便利になる! incsearch.vim v2.0 をリリースしました - haya14busa</a></li>
</ul>
</li>
<li>おもしろ開発系:

<ul>
<li><a href="https://github.com/haya14busa/eew.vim">緊急地震速報 on Vim</a> とか <a href="https://github.com/haya14busa/niconicomment.vim">Vimでニコニコlikeコメント</a> は記事は書いてなくてTwitterでやってた</li>
</ul>
</li>
<li>Vim script へ移植

<ul>
<li>underscore.vim は記事かいてなかった&hellip;</li>
<li>Vim版power-assert: <a href="http://haya14busa.com/vim-vital-power-assert/">Vim script版 power-assert! テスト書いてないとかお前それ Vim script の前でも同じこと言えんの? - haya14busa</a></li>
</ul>
</li>
</ul>


<p>自分の LT のくだり終了．</p>

<h2>YAPC::Asia 2015 Day1 感想</h2>

<h3>聴いたTalkと感想</h3>

<p>1日目は朝5時半くらいから起きて東京に向かったのでなかなか大変でしたが，早起きチャレンジ成功してよかった．</p>

<h4>1) <a href="http://yapcasia.org/2015/talk/show/a636430c-0fbf-11e5-8a02-43ec7d574c3a">メリークリスマス！ - YAPC::Asia Tokyo 2015</a></h4>

<p>perl を書いたことは無かったけど歌って踊るラリーウォールみれてよかった．
perl6 面白そうなようなので(又聞き)，クリスマス期待．</p>

<h4>2) <a href="http://yapcasia.org/2015/talk/show/9ec2791c-05e5-11e5-81fa-79c97d574c3a">世界展開する大規模ウェブサービスのデプロイを支える技術 - YAPC::Asia Tokyo 2015</a></h4>

<p>Miiverse のデプロイを支える技術の話だった．海を超えたgit pullとかその不可を抑えるためのランダムスリープみたいな
つらい話からはじまって，それを解決していった話が聞けました．
大規模ウェブサービスのデプロイ，やったこと一切なくてあまり個人の実感がわかないのでムズカシイけどこういう話も勉強していきたい．</p>

<h4>3) <a href="http://yapcasia.org/2015/talk/show/cc0ec485-1879-11e5-aca1-525412004261">TBD - YAPC::Asia Tokyo 2015</a></h4>

<p>Rubyのパパ Matz が Rubyの話しを封印したと思ったら10分で封印を解いたり，
Ruby のディスと見せかけて間接的にperlディスってたりしておもしろかった．
内容も面白くて，主流のアーキテクチャが変わると言語デザインも変わってきて，それに対応してデザインされているのが streem ならしい．</p>

<h4>4) <a href="http://yapcasia.org/2015/talk/show/de9e7a1e-136d-11e5-a9fc-d9f87d574c3a">Perlの上にも三年 〜 ずっとイケてるサービスを作り続ける技術 〜 - YAPC::Asia Tokyo 2015</a></h4>

<p>おもしろトークだった上にめっちゃ開発の参考になる話が多かった．紹介されていた本読みたい -> <a href="http://hitode909.hatenablog.com/entry/yapc2015books">YAPCの発表で紹介した本 - hitode909の日記</a>．
DDDとかユビキタス言語の導入の話とかがとてもいい話で，僕もやっていきたい．
最近自分でもプログラムやドキュメントに書いてる単語がブレていたりするのを感じていて，
<code>ユビキタス言語.md</code> (ファイル名違う気がする) とかをリポジトリに置いて管理するのとかもよさそうと思った．</p>

<p>事前条件/事後条件とかあってそこで 責任外のことをチェックせずお互いを信頼するとスッキリするという話もなんとなくスッキリして面白かった．</p>

<h4>5) <a href="http://yapcasia.org/2015/talk/show/523b9508-0d77-11e5-8174-67dc7d574c3a">うっかりをなくす技術 - YAPC::Asia Tokyo 2015</a></h4>

<p>うっかりすることよくあるので，うっかりをなくす技術を聞きに行った．
assertion ライブラリ的なものを最近作っていたのでassertionの話とかもっと聞きたかった．契約プログラミングとか???(わかってない)
defer/guard object とかスゴイよさそうだった．golang に defer とかあるようだし，goやっていきたい．</p>

<p>追記: あとせっかくうっかりをなくす技術聴いたのに2日目に会場に荷物忘れるうっかりをやらかした． そしてこの文をブログに書くのを忘れるといううっかりもして，うっかりしないようにするのはムズカシイ&hellip;</p>

<h4>6) <a href="http://yapcasia.org/2015/talk/show/22957e9c-1872-11e5-aca1-525412004261">Lightning Talks Day 1 - YAPC::Asia Tokyo 2015</a></h4>

<p>Slack + Hubot でお前の一番好きな二次元嫁キャラと一緒に仕事をする 話とかが思考がぶっ飛んでいて面白かった．
PHPでregister_globalsの話をしてた方が最初に<a href="https://github.com/gongo/emacs-ikku">gongo/emacs-ikku</a>とか作っていて
「Vimでやらなきゃ&hellip;負けてられない&hellip;」とか考えていたけどまだできていない．</p>

<h2>YAPC::Asia 2015 Day2 感想</h2>

<h3>聴いたTalkと感想</h3>

<h4><a href="http://yapcasia.org/2015/talk/show/5b1cd536-07ed-11e5-9e42-79c97d574c3a">Mackerel開発におけるScalaとGo、そしてPerl - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>複数の言語，技術を用途によって適切に使い分けてるのがすごい．</li>
<li>Scalaのimplicit conversion の解決遅すぎ問題のつらさわかる〜みたいな気持ちになったりした．</li>
<li>ちょっと最初の10minくらい遅れていってしまってツライ&hellip;ちゃんと見直したい．</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/f2816038-10ec-11e5-89bf-d7f07d574c3a">我々はどのように冗長化を失敗したのか - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>式年遷宮面白かった．</li>
<li>発表前から資料がアップロードされていてよさ．</li>
<li>冗長化ムズカシイ．</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/0af26fe4-0b7b-11e5-a29c-67dc7d574c3a">MySQLで2億件のシリアルデータと格闘したチューニングの話 - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>自分にとっては難しかったのとあまり集中して聞けてなかったのであまり記憶がない&hellip;(LT採択どうかな〜みたいな気持ちで気が気じゃなかったのもある)</li>
<li>あとから資料見てみたい．</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/bd04b86c-f9de-11e4-b996-8ab37d574c3a">Adventures in Refactoring - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>GitHubの中の人のリファクタリングの話でめっちゃよかった!!! リファクタリングしたい気持ちが高まりまくった．</li>
<li>リファクタリングは挙動を変えては行けなくて，それはバグも同じで一緒に修正したら問題の切り分けができなくてダメだよという話は，
わかるという思いと共に，そうは言ってもムズカシイので意識してデキルようにしていきたい．</li>
<li>リファクタリングをナゼするのかとか，成果を計測しなくてはならないというのは全然意識したことがなかった．資料とか見直しながらやっていきたい．</li>
<li>(変数・)メソッド名のアンダースコアはリファクタリングチャンス．なるほどという感じだった．</li>
<li>とにかくリファクタリングやっていくゾ!!!</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/e466d60a-11db-11e5-b07b-d7f07d574c3a">Posture for Engineers - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>肩こりがひどいので姿勢の話を聞きに行った．</li>
<li>いくつかヨガのポーズみたいなものを教えてもらったので実践できればいいのだけどデキルだろうか&hellip;</li>
<li>バランスボールのって開発してたら逆に肩こりと首こりがヤバくなった経験があってすぐにやめちゃったのでいい座り方・使い方がしりたい．(質問しそこねた)</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/b03162be-0052-11e5-ba92-89c77d574c3a">Run containerized workloads with Lattice - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>正直わからんかったマン(ムズカシイ&hellip;)</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/6bde6c69-187a-11e5-aca1-525412004261">Profiling &amp; Optimizing in Go - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>とにかくライブコーディングがカッコヨサで Go の標準で提供されている tool すごい強いし，コンパイル速くて書きやすそうだし，
まだ Go はかけてないけど，Go 書いていくゾ！という気持ちになった． Go 書き始めたらまた参照して学んで行きたい．</li>
</ul>


<h4><a href="http://yapcasia.org/2015/talk/show/69caedbd-1872-11e5-aca1-525412004261">Lightning Talks Day 2 - YAPC::Asia Tokyo 2015</a></h4>

<ul>
<li>どのLT もこれぞLTってカンジで良かった&hellip;あんなLTできるようになりたい．</li>
<li><a href="https://twitter.com/orga_chem">@orga_chem</a> さんの Vim script 静的解析の闇がトリで Vim script の闇を暴露していていい話だった．
Vim script はああいった感じでカワイイのでぜひ興味を持った皆さんには vint のチカラを借りながら Vim script を書いてみて欲しい．
基本静的解析のときツライという話で，<code>v:count</code>, 関数と変数のネームスペース， <code>map()</code> の引数とかが文字列って以外は普通に書いてるときの
闇としては避けられそう．(十分多い&hellip;???)</li>
</ul>


<h2>個人的な悔やまれることとか</h2>

<ul>
<li>最近Vim版power-assert作って補足して頂いたりしたので <a href="https://twitter.com/t_wada">@t_wada</a> さんに会ってご挨拶くらいしておきたかった．
Vim版 power-assert もっと便利にしておきたい．</li>
<li>世界の <a href="https://twitter.com/miyagawa">@miyagawa</a> さんを見かけて Rebuild.fm 大好きでめっちゃ聴いてますって言ってみたかったけど，誰かと話されていて，
Rebuild.fm 聴いてますとか耳たこかもしれないし，その後何か話せるか考えたけど訳分からんくておそらく Rebuild.fm で
Vim とかエディタの話をしてほしいとかは言わないまでも，Vimmerのゲスト増やしてくださいみたいな困らせるようなことを喋りそうで
そうこう言ってるうちに機会が過ぎてしまった&hellip;フベン&hellip;</li>
<li>Twitter のタイムラインを見る限り，オープンインターネッツ上で見たことあるひとがたくさんいたけど，現実の顔と一致しなくて結局
会わずじまいな人が多かったのでまた何かの機会にお会いしたい．会えたひとも何人かいてそれはよかった．</li>
<li>発表しようと思うならもっと早めに用意しないと，僕のレベルだと時間をいっぱいかけてやっと聴くに耐えるものになるかどうかギリギリみたいな
感じだと思うし，ちゃんと準備したい．</li>
</ul>


<h2>全体的に</h2>

<p>YAPC::Asia 2015，YAPC初めての参加でしたが本当に最高でした!!!
同時通訳の方の同時通訳がすごくて圧巻されたり，会場のWifiはあの人数だったのに個人的にはほとんど繋がっていて CONBU さん凄かった．
無限に湧き出てくるコーヒーも美味しかったし，懇親会も豪華だしスポンサーの皆様ありがとうございました．</p>

<p>そして発表者の皆様，<a href="https://twitter.com/lestrrat">@lestrrat</a>さんをはじめとした運営の皆様，他の参加者の方々，
(漏れていたとしたらその方々!)， 最高のYAPC本当にありがとうございました．楽しかったです!!!</p>

<p>絶対来年も参加したい！！！！</p>
</div>
  
  


      <footer>
      
      - <a href="/yapcasia-2015/">ブログを書くまでが #yapcasia なのでブログでLT発表して感想かく ― Vim駆動学習</a>
      <time datetime="2015-08-23T10:24:12+09:00" pubdate><span class='month'>Aug</span> <span class='day'>23</span> <span class='year'>2015</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/converence/'>converence,</a>, <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/vim-vital-power-assert/">Vim Script版 Power-assert! テスト書いてないとかお前それ Vim Script の前でも同じこと言えんの?</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2015-08-19T22:13:51+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>Vim script で最高の assertion 体験，vital-power-assert を作りました</h2>

<p><a href="https://gyazo.com/d044f6e7135cfb4314a0d88f0d02e572"><img src="https://i.gyazo.com/d044f6e7135cfb4314a0d88f0d02e572.png" alt="Gyazo" /></a></p>

<div class="github-card" data-github="haya14busa/vital-power-assert" data-width="500" data-height="150" data-theme="default"></div>


<p><a href="https://github.com/haya14busa/vital-power-assert">haya14busa/vital-power-assert</a></p>

<blockquote><p><strong>テスト書いてないとかお前それ Vim script の前でも同じこと言えんの?</strong></p></blockquote>

<p>ということで Vim script 版 power-assert, vital-power-assert を作りました.</p>

<p>Vim script でも power-assert できてテストをバリバリ書けるんだから
Vim で書いてる他の言語でテスト書いてないとか Vim が泣いちゃいますね&hellip;(煽り，そしてブーメラン)</p>

<h3>使い方とか <strong>力こそパワー!! 百聞よりパワー!!</strong></h3>

<p>使っている様子です</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>" in your vimrc
</span><span class='line'>NeoBundle 'vim-jp/vital.vim'
</span><span class='line'>NeoBundle 'haya14busa/vital-vimlcompiler'
</span><span class='line'>NeoBundle 'haya14busa/vital-power-assert'</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let s:V = vital#of('vital')
</span><span class='line'>let s:PowerAssert = s:V.import('Vim.PowerAssert')
</span><span class='line'>let s:assert = s:PowerAssert.assert
</span><span class='line'>execute s:PowerAssert.define('PowerAssert')
</span><span class='line'>function! s:power_assert() abort
</span><span class='line'>  let x = { 'ary': [1, 2, 3], 'power': 'assert' }
</span><span class='line'>  let l:zero = 0
</span><span class='line'>  let s:two = 2
</span><span class='line'>  PowerAssert index(x.ary, l:zero) is# s:two
</span><span class='line'>  " or
</span><span class='line'>  execute s:assert('index(x.ary, l:zero) is# s:two')
</span><span class='line'>endfunction
</span><span class='line'>call s:power_assert()</span></code></pre></td></tr></table></div></figure>


<p>上記コードを実行するとこうなります．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vital: PowerAssert:
</span><span class='line'>index(x.ary, l:zero) is# s:two
</span><span class='line'>     |||     |       |   |
</span><span class='line'>     |||     |       |   2
</span><span class='line'>     |||     |       0
</span><span class='line'>     |||     0
</span><span class='line'>     ||[1, 2, 3]
</span><span class='line'>     |{'ary': [1, 2, 3], 'power': 'assert'}
</span><span class='line'>     -1</span></code></pre></td></tr></table></div></figure>


<p>インストールや詳しい使い方は GitHub/help を参照してください．</p>

<p>-> <a href="https://github.com/haya14busa/vital-power-assert">haya14busa/vital-power-assert</a></p>

<p>基本的に関数とコマンドのassert方法を用意しているのですが，プラグインのコードに残しておいたりするものは
関数の <code>.assert()</code>, Vimのテスティングフレームワークで使う際などはコマンドでやることを推奨してます．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>" 関数で assert. 引数は文字列として渡す必要がある
</span><span class='line'>execute s:assert('index(x.ary, l:zero) is# s:two')
</span><span class='line'>" コマンドで assert. 文字列で囲う必要がないのでシンタックスハイライトも効く
</span><span class='line'>PowerAssert index(x.ary, l:zero) is# s:two</span></code></pre></td></tr></table></div></figure>


<p>両者ともデバッグ用変数をONにしないとassertは実行されないので，プラグインに埋め込んでおいても
プラグインのユーザが使ってる時は発動しないし，評価なにもされないのでコードに残しておいても
問題ないようになっています．(コマンドの方はユーザのVimにコマンドが新たに定義されてしまうので推奨しません)</p>

<h2>power-assert 最高! 一番好きな assertion ライブラリです！</h2>

<p>vital-power-assert はもちろん JavaScript の assertion ライブラリである
<a href="https://github.com/power-assert-js/power-assert">https://github.com/power-assert-js/power-assert</a>
にインスパイアされて作っています．</p>

<p>何がベンリなのかとかは <a href="https://twitter.com/t_wada">@t_wada</a>さんが本家のpower-assertの紹介とかで
各所で説明なされているので説明は不要だとおもいますが，</p>

<p>個人的にはやはり</p>

<ol>
<li>assert 失敗時の式がどうなってるか一目瞭然のグラフィカルな見た目</li>
<li>たくさんの matcher を一つ一つ憶えたりドキュメントを見なくても <code>assert</code> 一つだけ知ってれば使える優しさ</li>
</ol>


<p>あたりのよさが使ってみて，開発してみて本当によいなと思います．</p>

<p>マッチャーは自然言語的な書き方ができたり，
テストのコード自体が間違えにくいみたいなところがよいとチラッと聞いたことがありますが
僕は断然power-assertのほうが好きという思いが強まりました (間違ってたり他にもある場合は教えてください)</p>

<h2>Vim script 版 vital-power-assert のよさ</h2>

<p>(このあたりは特に Vim script 書いてる人/興味あるひと向けです)</p>

<p>power-assert としてのよさはもちろんのところ，
Vim script の assertion ライブラリとしての vital-power-assert
のいいところがあります．</p>

<p>それはassertionを実行する際のスコープが assert する行と
同じなので， スクリプトローカル変数やローカル関数など何でもassert する
式の中で使えるということです!!! (わかりづらい)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:let s:x = 2
</span><span class='line'>:PowerAssert s:x == 1
</span><span class='line'>" or
</span><span class='line'>:execute s:assert('s:x == 1')
</span><span class='line'>" =&gt; ちゃんとs:xも使える
</span><span class='line'>"   s:x == 1
</span><span class='line'>"   |   |
</span><span class='line'>"   |   0
</span><span class='line'>"   2</span></code></pre></td></tr></table></div></figure>


<p>例えば Vimのテスティングフレームワークの一つの <a href="https://github.com/thinca/vim-themis">thinca/vim-themis</a>
の assert コマンドではスクリプトローカル変数が使えなくて不便&hellip;ということがあったりするのですが
vital-power-assert を使えばそのあたりを気にせず使うことができます．ベンリ．</p>

<h2>どうやって実装しているか</h2>

<h3>Vim script のパース &amp; コンパイル</h3>

<ul>
<li><a href="https://github.com/ynkdir/vim-vimlparser">ynkdir/vim-vimlparser</a></li>
<li><a href="https://github.com/haya14busa/vital-vimlcompiler">haya14busa/vital-vimlcompiler</a></li>
</ul>


<p>power-assert のようにassert が失敗したときに式中のそれぞれの変数や関数，
演算子の評価結果を得るためにはまず与えられた式をパースする必要があります．
そこでは Vim script で Vim script をパースできる <a href="https://github.com/ynkdir/vim-vimlparser">ynkdir/vim-vimlparser</a>
を使用させていただいています． 使っていて改めて ynkdir さんすごすぎる&hellip;</p>

<p>vitalのライブラリとして使うために<a href="https://github.com/haya14busa/vital-vimlcompiler">haya14busa/vital-vimlcompiler</a>にバンドルしちゃっています．(ライセンス的に問題なさそうだったのでynkdirさんに相談するまえに衝動的にVim版power-assertを作ってしまいました&hellip;ｽｲﾏｾﾝ)</p>

<p>とにかく，vimlparser のおかげでVim scriptをパースしてASTを得ることができたので，
あとはASTをトラバースして評価したいノードを集めることができました．</p>

<h3>そして再コンパイル</h3>

<p>あとは集めたASTのノードの式中の位置を記録，
そしてASTをVim scriptに戻してスコープに気を付けながら評価すれば必要なものが揃います．</p>

<p>vimlparser に付属している <code>Compiler</code> オブジェクトはS式的なものにコンパイルするものだったので，
Vim scriptにコンパイルする <a href="https://github.com/haya14busa/vital-vimlcompiler">haya14busa/vital-vimlcompiler</a>
というライブラリを作って使用しています．</p>

<p>注意点としてまだ<code>expr</code>のコンパイルしか実装してないので関数とかはコンパイルできないです．
ドキュメントもないし今のところ完全に vital-power-assert 用になっていますが，何かできたら面白そう．</p>

<h3>Vim script スコープハック</h3>

<p>Vim のコマンドの引数は<code>String</code>として渡されてその場で評価しているわけではないので
普通にやるとスクリプトローカル変数が無いと怒られます．
もちろん文字列で受け取って <code>eval()</code> してもスコープは変わってるので対応できません．</p>

<p>これを完全に解消するためにはassertする行と同じ位置で評価する必要がありますが，
そこで <code>execute</code> を使うことによって実現しています．</p>

<p>どういうことかというと，<code>{rhs}</code> である <code>s:assert('...')</code> が評価され返り値が帰ってくるのですが，
その返り値に実行したいコマンドを文字列として返すと <code>:execute</code>によってそのコマンドが同じスコープで
実行できて&hellip; という感じで実装しております．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:execute s:assert('x == 1')
</span><span class='line'>" -&gt;
</span><span class='line'>:execute 'execute' "s:assert2(x == 1, 'x == 1')"
</span><span class='line'>" -&gt; {expr} と 文字列の '{expr}' を別の関数に渡し直す
</span><span class='line'>:execute s:assert2(x == 1, 'x == 1')
</span><span class='line'>" -&gt; 評価したいノードリストを引数にとる関数を返す
</span><span class='line'>:execute 'execute' "s:assert3('x == 1', [{pos: `xの位置`, value: x}])"
</span><span class='line'>" -&gt; { "value": x } で xが評価される
</span><span class='line'>:execute s:assert3('x == 1', [{"pos": `xの位置`, "value": x}])
</span><span class='line'>" -&gt; 実はこのあとここで `:throw` コマンドを返してthrowすることによってエラー位置をこの行にしたり...
</span><span class='line'>:throw ...</span></code></pre></td></tr></table></div></figure>


<p>コマンドも基本は同じでコマンドの<code>{rhs}</code>が<code>execute</code>になってるのですが，
どうしてもスクリプトローカル変数だけはコマンドを定義したファイルの方で評価されてしまうので
ファイルごとにコマンドは定義する必要があるのはこれが理由です．</p>

<p>つまりスクリプトローカル変数諦めるなら一回定義すればあとは同じように使えますが
そもそもコマンドは雑な開発用スクリプトとかテスティングフレームワークで使うことを想定しているので
そんな感じで察してください．</p>

<h3>グラフィカルな描画</h3>

<p>ところで見た目とユーザの驚き的には power-assert のあのグラフィカルな表示を作るところが華と見ることもできそうですが，
今のところとりあえず線が被らない最低限のアルゴリズムで作っているのでもっと改善した表示ができると思います．</p>

<p>もしいい感じのグラフ描画のアルゴリズムわかる人は僕に教えてくださると大変ウレシイです</p>

<h2>最後に</h2>

<p>勢いでﾜｰッと作っていてまだまだ改善点はあるのですが，一通り開発してテストしてる限りではめっちゃよい感じに動くので Vim script 書いてる方や興味あるかたは是非使って見ていただけると嬉しいです．</p>

<p>あと themis との連携を書いてますが，別に themis の作者である
<a href="https://github.com/thinca">thinca</a> さんに使い方とか確認をとったわけでもないので
もしかしたらもうちょっと良く出来たりするかもしれません．</p>

<p>フィードバックとか使い方の質問とか
github: <a href="https://github.com/haya14busa/vital-power-assert">https://github.com/haya14busa/vital-power-assert</a> ,
twitter: <a href="https://twitter.com/haya14busa">https://twitter.com/haya14busa</a> ,
Lingr: <a href="http://lingr.com/room/vim">http://lingr.com/room/vim</a>
あたりにいただけると嬉しさあります．</p>

<p><strong>Vim script でも power-assert して最高の assertion 書いていくゾ!!!</strong></p>

<script src="http://lab.lepture.com/github-cards/widget.js"></script>

</div>
  
  


      <footer>
      
      - <a href="/vim-vital-power-assert/">Vim script版 power-assert! テスト書いてないとかお前それ Vim script の前でも同じこと言えんの?</a>
      <time datetime="2015-08-19T22:13:51+09:00" pubdate><span class='month'>Aug</span> <span class='day'>19</span> <span class='year'>2015</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/incsearch-dot-vim-ver-2/">Vimの検索はもっともっと便利になる! incsearch.vim v2.0 をリリースしました</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2015-07-06T01:34:01+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><div class="github-card" data-github="haya14busa/incsearch.vim" data-width="500" data-height="150" data-theme="default"></div>


<p><a href="https://github.com/haya14busa/incsearch.vim">haya14busa/incsearch.vim</a></p>

<p>incsearch.vim について知らないかたはこちらの記事を参照してください．
簡単に言えばVimのインクリメンタル検索をカイゼンするプラグインです．
-> <a href="http://haya14busa.com/enrich-your-search-experience-with-incsearch-vim/">incsearch.vimでVimの検索体験をリッチにする - haya14busa</a></p>

<h2>incsearch.vim v2.0 をリリースした!</h2>

<p>v0.9, v1.0, v1.1, v1.2, &hellip; とこれまで incsearch.vim をインクリメンタルにカイゼンにカイゼンを重ねてきました&hellip;
そして本日， incsearch.vim は晴れて一段階進化し， バージョン2.0 となりました!</p>

<p>この進化を一言で言えば，incsearch.vim はもっともっと Vim の検索を便利にすべく <strong>進化・拡張可能</strong> になりました．</p>

<h2>2.0で何ができるようになったか?</h2>

<p>百聞は一見に如かず．以下のgifとともに拡張プラグイン達をご覧ください!</p>

<h3>曖昧検索 | fuzzy search</h3>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/master/incsearch.vim/extensions/incsearch-fuzzy.gif" alt="incsearch-fuzzy.gif" /></p>

<ul>
<li>GitHub: <a href="https://github.com/haya14busa/incsearch-fuzzy.vim">haya14busa/incsearch-fuzzy.vim</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>NeoBundle <span class="s1">&#39;haya14busa/incsearch-fuzzy.vim&#39;</span>
</span><span class='line'><span class="c">&quot; マッピング例</span>
</span><span class='line'>map z<span class="sr">/ &lt;Plug&gt;(incsearch-fuzzy-/</span><span class="p">)</span>
</span><span class='line'>map z? <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>fuzzy<span class="p">-</span>?<span class="p">)</span>
</span><span class='line'>map zg/ <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>fuzzy<span class="p">-</span>stay<span class="p">)</span>
</span><span class='line'><span class="c">&quot; サクッとためす</span>
</span><span class='line'><span class="c">&quot; :call incsearch#call(incsearch#config#fuzzy#make())</span>
</span></code></pre></td></tr></table></div></figure>


<h3>曖昧スペル検索 | fuzzy spell search</h3>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/master/incsearch.vim/extensions/incsearch-fuzzyspell.gif" alt="incsearch-fuzzyspell.gif" /></p>

<ul>
<li>GitHub: <a href="https://github.com/haya14busa/incsearch-fuzzy.vim">haya14busa/incsearch-fuzzy.vim</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>NeoBundle <span class="s1">&#39;haya14busa/incsearch-fuzzy.vim&#39;</span>
</span><span class='line'><span class="c">&quot; マッピング例</span>
</span><span class='line'>map z<span class="sr">/ &lt;Plug&gt;(incsearch-fuzzyspell-/</span><span class="p">)</span>
</span><span class='line'>map z? <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>fuzzyspell<span class="p">-</span>?<span class="p">)</span>
</span><span class='line'>map zg/ <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>fuzzyspell<span class="p">-</span>stay<span class="p">)</span>
</span><span class='line'><span class="c">&quot; サクッとためす</span>
</span><span class='line'><span class="c">&quot; :call incsearch#call(incsearch#config#fuzzyspell#make())</span>
</span></code></pre></td></tr></table></div></figure>


<h3>高速でインクリメンタルなmigemo検索 | migemo search</h3>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/master/incsearch.vim/extensions/incsearch-migemo.gif" alt="incsearch-migemo.gif" /></p>

<ul>
<li>GitHub: <a href="https://github.com/haya14busa/incsearch-migemo.vim">haya14busa/incsearch-migemo.vim</a></li>
<li>参照: <a href="http://0xcc.net/migemo/">Migemo: ローマ字のまま日本語をインクリメンタル検索</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>NeoBundle <span class="s1">&#39;haya14busa/incsearch-migemo.vim&#39;</span>
</span><span class='line'><span class="c">&quot; マッピング例</span>
</span><span class='line'>map <span class="k">m</span><span class="sr">/ &lt;Plug&gt;(incsearch-migemo-/</span><span class="p">)</span>
</span><span class='line'>map <span class="k">m</span>? <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>migemo<span class="p">-</span>?<span class="p">)</span>
</span><span class='line'>map mg/ <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>migemo<span class="p">-</span>stay<span class="p">)</span>
</span><span class='line'><span class="c">&quot; サクッとためす</span>
</span><span class='line'><span class="c">&quot; :call incsearch#call(incsearch#config#migemo#make())</span>
</span></code></pre></td></tr></table></div></figure>


<h3>EasyMotion との連携 | integration with vim-easymotion</h3>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/master/incsearch.vim/extensions/incsearch-easymotion.gif" alt="incsearch-easymotion.gif" /></p>

<ul>
<li>GitHub:

<ul>
<li><a href="https://github.com/haya14busa/incsearch-easymotion.vim">haya14busa/incsearch-easymotion.vim</a></li>
<li><a href="https://github.com/easymotion/vim-easymotion">easymotion/vim-easymotion</a></li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>NeoBundle <span class="s1">&#39;haya14busa/incsearch-easymotion.vim&#39;</span>
</span><span class='line'><span class="c">&quot; マッピング例</span>
</span><span class='line'>map z<span class="sr">/ &lt;Plug&gt;(incsearch-easymotion-/</span><span class="p">)</span>
</span><span class='line'>map z? <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>easymotion<span class="p">-</span>?<span class="p">)</span>
</span><span class='line'>map zg/ <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>easymotion<span class="p">-</span>stay<span class="p">)</span>
</span><span class='line'><span class="c">&quot; サクッとためす</span>
</span><span class='line'><span class="c">&quot; :call incsearch#call(incsearch#config#easymotion#make())</span>
</span></code></pre></td></tr></table></div></figure>


<h3>拡張はcomposable!</h3>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/master/incsearch.vim/extensions/incsearch-fuzzy-easymotion.gif" alt="incsearch-fuzzy-easymotion.gif" />
incsearch.vim x fuzzy x easymotion</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; incsearch.vim x fuzzy x vim-easymotion</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:config_easyfuzzymotion<span class="p">(</span>...<span class="p">)</span> abort
</span><span class='line'>  <span class="k">return</span> extend<span class="p">(</span>copy<span class="p">(</span>{
</span><span class='line'>  \   <span class="s1">&#39;converters&#39;</span>: [<span class="nb">incsearch</span>#config#fuzzy#converter<span class="p">()</span>]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;modules&#39;</span>: [<span class="nb">incsearch</span>#config#easymotion#module<span class="p">()</span>]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;keymap&#39;</span>: {<span class="s2">&quot;\&lt;CR&gt;&quot;</span>: <span class="s1">&#39;&lt;Over&gt;(easymotion)&#39;</span>}<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;is_expr&#39;</span>: <span class="m">0</span><span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;is_stay&#39;</span>: <span class="m">1</span>
</span><span class='line'>  \ }<span class="p">),</span> <span class="k">get</span><span class="p">(</span><span class="k">a</span>:<span class="p">,</span> <span class="m">1</span><span class="p">,</span> {}<span class="p">))</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> <span class="p">&lt;</span>Space<span class="p">&gt;</span>/ <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>config_easyfuzzymotion<span class="p">())</span>
</span></code></pre></td></tr></table></div></figure>


<h2>仕組み</h2>

<h3>converter 機能</h3>

<ul>
<li><code>:h incsearch-config-converters</code></li>
</ul>


<p>バージョン2.0でのメイン追加機能，パターンコンバート機能です．
入力したパターンを変換して正規表現を返すコンバーター(複数可)を指定することによって，
入力した正規表現だけでなく，変換された正規表現も追加で検索してくれます．</p>

<p>fuzzy, fuzzyspell, migemo の拡張はどれもこの新たに入った仕組み，converter機能を使っています．</p>

<p>他にも スネークケースとキャメルケースを相互変換してどちらも検索できるようにするとか，
<code>{a,b}</code>を<code>\(a\|b\)</code>に変換するようなオレオレ簡易正規表現シンタックス(?)シュガーを作るとか，
inputを受け取って正規表現を返すというシンプルな機能ながら，活用可能性はたくさんあります！
(※  これらはそのうち実装していくと思います)</p>

<h3>module 機能</h3>

<ul>
<li>GitHub: <a href="https://github.com/osyo-manga/vital-over">osyo-manga/vital-over</a></li>
<li><code>:h incsearch-config-modules</code></li>
<li><code>:h Vital.Over.Commandline-modules</code></li>
</ul>


<p>vital-over という incsearch.vim が使用しているライブラリにおけるモジュールを追加できる機能です．
これがどんなことができて，どうやって作ればいいかといったことはそれだけで別の一つの記事どころか数十記事書ける内容なので割愛しますが，
かなりいろんなことができるようになるはずです．(が，その分何でもできすぎるので注意は必要そうですが)．</p>

<p><a href="https://github.com/haya14busa/incsearch-easymotion.vim">haya14busa/incsearch-easymotion.vim</a>
がこの機能を使って検索後に <a href="https://github.com/easymotion/vim-easymotion">easymotion/vim-easymotion</a> の機能を呼び出しています．</p>

<h2>自分で拡張を作ることも可能！※ ただしAPIが固まってるとは言ってない</h2>

<p>もちろんもっと便利な拡張を自分で作っていくことも可能です．
ここでは例としてちょっとした <code>converter</code> を作ってみましょう</p>

<h3>参照</h3>

<ul>
<li><code>:h incsearch#go()</code></li>
<li><code>:h incsearch-config()</code></li>
</ul>


<h3>仕様</h3>

<ul>
<li>正規表現をエスケープして単なる文字列として返し，検索する．</li>
<li>つまりは<code>\V</code>の機能．ただし，普通の正規表現に<strong>加えて</strong>検索できるところが違う．</li>
</ul>


<h3>実装</h3>

<p><code>pattern</code> を受け取って正規表現を返す関数 (<code>s:noregexp()</code>) を実装して，
<code>incsearch#go()</code>に渡すconfigの<code>converters</code>として渡してあげるだけ．
※ converterオブジェクトを作って渡してあげる方法もありますが，現時点では関数を渡してできること大差ない．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:noregexp<span class="p">(</span>pattern<span class="p">)</span> abort
</span><span class='line'>  <span class="k">return</span> <span class="s1">&#39;\V&#39;</span> . escape<span class="p">(</span><span class="k">a</span>:pattern<span class="p">,</span> <span class="s1">&#39;\&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:config<span class="p">()</span> abort
</span><span class='line'>  <span class="k">return</span> {<span class="s1">&#39;converters&#39;</span>: [<span class="k">function</span><span class="p">(</span><span class="s1">&#39;s:noregexp&#39;</span><span class="p">)</span>]}
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> z/ <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>config<span class="p">())</span>
</span><span class='line'><span class="c">&quot; 例: /\vpattern と検索したら \vpattern がマッチする．普通の検索なら pattern だけ</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>めっちゃ簡単!!!</strong></p>

<h2>Special Thanks</h2>

<p>おしょーさん(<a href="https://github.com/osyo-manga">github@osyo-manga</a>)のライブラリには
毎度お世話になっており，incsearch.vim v2.0 はコマンドラインライブラリである
<a href="https://github.com/osyo-manga/vital-over">osyo-manga/vital-over</a> の拡張性があってこそ
リリースできたことだったり，cmigemoコマンドでも高速に migemo 検索できるのはそのまま
<a href="https://github.com/osyo-manga/vital-migemo">osyo-manga/vital-migemo</a> のおかげだったりします．</p>

<p>また <a href="http://lingr.com/room/vim/">Lingrのvim部屋</a> でもincsearch.vimの開発に関わる質問をしたりして参考にしたりフィードバックをもらったりしました．
皆さんありがとうございますっ！</p>

<h2>終わりに．そして次のカイゼンへ&hellip;</h2>

<p>incsearch.vim はシンプルかつVimデフォルトの検索と同じように快適に使用できるオススメプラグインです．
それがバージョン2.0 になり，望めばもっともっと便利に，拡張可能なものになりました．
気になった方は是非つかってみてください．</p>

<p>そして incsearch.vim にはまだまだ改善点があるかと思います(ｼﾞｯｻｲあります)．
なにか見つけた方や「おまえーっ&hellip;APIがなーっ&hellip;ふわふわでなぁーっ&hellip;使いにくくてなーっ&hellip;ゆるさーん(バシーン)」
という方は <a href="https://github.com/haya14busa/incsearch.vim/issues">Issues</a> や
<a href="https://twitter.com/haya14busa">twitter:@haya14busa</a>, はたまた <a href="http://lingr.com/room/vim/">Lingrのvim部屋</a>
あたりなどでフィードバックいただければカイゼンしていきたいと思うのでよろしくお願いしますっ</p>

<div class="github-card" data-github="haya14busa/incsearch.vim" data-width="500" data-height="150" data-theme="default"></div>


<p><a href="https://github.com/haya14busa/incsearch.vim">haya14busa/incsearch.vim</a></p>

<script src="http://lab.lepture.com/github-cards/widget.js"></script>

</div>
  
  


      <footer>
      
      - <a href="/incsearch-dot-vim-ver-2/">Vimの検索はもっともっと便利になる! incsearch.vim v2.0 をリリースしました</a>
      <time datetime="2015-07-06T01:34:01+09:00" pubdate><span class='month'>Jul</span> <span class='day'>06</span> <span class='year'>2015</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/haya14busa-s-happy-vimming-year-2014/">2014年の振り返り. またはプログラミング2年目をVimに捧げるとこうなるという話</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2014-12-30T00:00:00+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>この記事について</h2>

<p>この記事は <a href="http://qiita.com/advent-calendar/2014/vim">Vim Advent Calendar 2014</a> の30日目かもしれません(または来年, Vim記事集約系のイベントやりたいという気持ちの1つです).</p>

<p>今年の2月に <a href="http://haya14busa.com/vim_driven_learning/">1年間『Vim駆動学習』してきて最高に楽しかったのでオススメしたい - haya14busa</a> というVim歴換算で1年を振り返ったエントリーを書いたのですが, 今回は2014年を振り返ってみたら, やっぱりVim活たのしかったなぁという日記的エントリーです.</p>

<p>また思い返してみると僕がプログラミング始めたのは2年と少し前だったので, 2014年はプログラミング2年目の年でもありました.
この文脈でみると<strong>「プログラミング2年目をVimに捧げるとどうなるか?」</strong> というエントリーとも言えそうです. (※1年目からかなりの割合をVimに捧げていました)</p>

<h2>2014年, 今年のVim活を振り返る</h2>

<p>※Vim活が9割です</p>

<h3>カーソル移動系人気プラグインの vim-easymotion の開発を乗っ取った!</h3>

<div class="github-card" data-github="Lokaltog/vim-easymotion" data-width="400" data-height="153" data-theme="default"></div>


<p><img src="../images/easymotion/20141230_easymotion_contribution_graph.png" alt="20141230_easymotion_contribution_graph" />
<img src="../images/gif/easymotion_on_speed_ex.gif" alt="easymotion_on_speed_ex" /></p>

<ul>
<li><a href="https://github.com/Lokaltog/vim-easymotion">Lokaltog/vim-easymotion</a></li>
<li><a href="https://github.com/haya14busa/vim-easyoperator-phrase">haya14busa/vim-easyoperator-phrase</a></li>
<li><a href="https://github.com/haya14busa/vim-easyoperator-line">haya14busa/vim-easyoperator-line</a></li>
<li>ブログ記事: <a href="http://haya14busa.com/mastering-vim-easymotion/">Vim-EasyMotionでカーソル移動を爆速にして生産性をもっと向上させる - haya14busa</a></li>
<li>執筆時GitHubスター数: 1556</li>
</ul>


<p>これは2013年の後半からforkして活動していて, 今年の2月くらいに起こった出来事なのですでに下記の記事に少し感想を書いています.</p>

<p>-> <a href="http://haya14busa.com/vim_driven_learning/">1年間『Vim駆動学習』してきて最高に楽しかったのでオススメしたい - haya14busa</a></p>

<p>記事執筆現在, GitHub のStar数 1556 で, 開発を引き継いだ時点での Star数は 1000 にちょっと届かない程度でした.
もともとほっといた場合の伸び具合がどれくらいかはわからないですが, 自分が引き継いだ時点で Star数 約1000 のリポジトリが, さらに500強増えたという事実は本当に嬉しいです.
GitHub Star 500+ めでたい.</p>

<p>これだけ 「たくさんのスター数がついている≒たくさんの人に使っていただけている」 プロジェクトを開発 &amp; メンテするというのはなかなかに学ぶことがおおくてとても楽しかったです.
今後はリファクタリング含めもっと便利にしたいなぁと思っているんですが, そう思ってから半年くらい経過しております(すでに十分に便利&amp;安定してきているのでモチベが低い).</p>

<h3>最高の検索体験を提供したい! incsearch.vim つくった</h3>

<div class="github-card" data-github="haya14busa/incsearch.vim" data-width="400" data-height="153" data-theme="default"></div>


<p><img src="../images/gif/incsearch/incremental_regex_building.gif" alt="incremental_regex_building" /></p>

<ul>
<li><a href="https://github.com/haya14busa/incsearch.vim">haya14busa/incsearch.vim</a></li>
<li><a href="https://github.com/osyo-manga/vital-over">osyo-manga/vital-over</a></li>
<li>ブログ記事: <a href="http://haya14busa.com/enrich-your-search-experience-with-incsearch-vim/">incsearch.vimでVimの検索体験をリッチにする - haya14busa</a>

<ul>
<li><a href="http://qiita.com/advent-calendar/2014/vim">Vim Advent Calendar 2014</a> の 14日目の記事でもあります</li>
</ul>
</li>
<li>執筆時GitHubスター数: 231</li>
</ul>


<p>今年の前半がvim-easymotionだとしたら, 後半はほとんど incsearch.vim でした.
実はこのプラグインは最初はサクッと気晴らしにつくったぜーというレベルのものだったのですが,
なんだかんだちゃんとしたものにしようという流れになり目一杯頑張りました.</p>

<p>また使用しているライブラリの <a href="https://github.com/osyo-manga/vital-over">osyo-manga/vital-over</a>
にもコントリビューションという名のリクエスト丸投げや, 設計についてコメント, ダメダメな Pull Request
を交えながらいろいろ関わらせていただきました.
おしょーさんありがとうございます, 迷惑いっぱいかけてスイマセンッ, これからもよろしくお願いします..!</p>

<p>便利さの9割は vital-over のおかげなのですが, 自分が1から開発してるリポジトリーでスター数3桁を達成してこれもまた非常に嬉しいです. これもめでたい.</p>

<p>GitHubの VimL trending で Repositories &amp; Developers の両方で1位も獲得できました&hellip;! 嬉しさ.</p>

<p><img src="../images/github/github-trending-viml-today-incsearch-2014-10-21%2009:26:33.png" alt="github-trending-viml-today-incsearch" />
<img src="../images/github/github-developer-today-vimL-2014-10-22%2022:51:58.png" alt="github-developer-today-vimL-2014-10-22 22:51:58" /></p>

<h3>VimConf 2014 で発表した</h3>

<ul>
<li><a href="http://vimconf.vim-jp.org/2014/">VimConf 2014</a></li>
<li>皆さんの発表などなど: <a href="http://vimconf.vim-jp.org/2014/reports/">Reports - VimConf 2014</a></li>
<li>ブログ記事: <a href="http://haya14busa.com/vimconf2014/">VimConf2014 で検索とその拡張について発表した - haya14busa</a></li>
<li>スライド: <a href="https://docs.google.com/presentation/d/1ie2VCSt9onXmoY3v_zxJdMjYJSbAelVR-QExdUQK-Tw/pub">/-improved</a></li>
<li>発表動画: <a href="https://www.youtube.com/watch?v=yB1H5V8e1j4&amp;list=PLx8bw5NQypsnuX8NJPRHvURhXqj2NUnGZ&amp;index=12">/-improved #VimConf2014 - YouTube</a></li>
</ul>


<p>VimConf2014 という感極まるVimのカンファレンスが今年も開催されたのですが, そこでLT枠で発表させていただきました.
Vimの便利な検索機能と上述した incsearch.vim の紹介をしました. 発表グダったりもしましたが, よかったという反応をいただけたり, スライドを英語で書いたので英語圏の人にも見てもらって便利さを伝えられたのは良かったです. 英語というより gif をふんだんに活用したので伝わったという説もある.
(<a href="http://usevim.com/2014/11/14/vimconf/">usevim</a>, <a href="http://www.reddit.com/r/vim/comments/2lwrv0/vimconf_2014_reports/">reddit</a> )</p>

<p>ちなみに動画はテンパッて間違ったことも多々言ってるので鵜呑みにしないでください&hellip; この辺慣れるには場数を踏む必要がありそう</p>

<h3>最高の検索体験を提供したい + α!. vim-asterisk 勢いでつくった</h3>

<div class="github-card" data-github="haya14busa/vim-asterisk" data-width="400" data-height="153" data-theme="default"></div>


<p><img src="https://raw.githubusercontent.com/haya14busa/i/master/vim-asterisk/asterisk_z_star.gif" alt="asterisk_z_star" /></p>

<ul>
<li><a href="https://github.com/haya14busa/vim-asterisk">haya14busa/vim-asterisk</a></li>
<li>執筆時GitHubスター数: 34</li>
</ul>


<p>Vim の <code>*</code> ってとても便利なのですが, 自分のユースケースとしては次のマッチにジャンプして欲しくないという不満があったので, そこを解消するために作りました.
<code>*</code> からの <code>gn</code> テキストオブジェクト活用でスムーズに編集できるようになってとても気に入っています.</p>

<p>結構小さいプラグインではあるのですが, 今まで得たVim scriptの知識や経験をたくさん使っていたり, ビジュアルモードにおける <code>*</code> 機能は <a href="https://github.com/thinca/vim-visualstar">thinca/vim-visualstar</a> の部分をお借りしたり, マルチバイトの扱いを<a href="https://github.com/haya14busa/vim-asterisk/pulls?q=is%3Apr+is%3Aclosed">プルリク</a>貰って直したりとなかなかよさ気なものになりました.</p>

<p>実は似たような機能を提供してるプラグインはいくつかあるのですが, どれも不満がまだありました(Vimの検索機能周りの拡張は結構落とし穴が多い).
incsearch.vim の経験などが活きて落とし穴はうまく回避できました. 気になった方は是非使ってみてください.</p>

<h3>vimrc 読書会にいっぱい参加 &amp; 管理のデータ化・自動化 &amp; 統計ページ をつくった</h3>

<ul>
<li><a href="http://vim-jp.org/reading-vimrc/">vimrc読書会</a></li>
<li><a href="http://vim-jp.org/reading-vimrc/stat/#/">vimrc読書会 Stat</a></li>
<li>ブログ記事: <a href="http://haya14busa.com/reading-vimrc-stat/">vimrc読書会Stat作った - haya14busa</a></li>
<li><a href="http://vim-jp.org/reading-vimrc/stat/#/u/haya14busa">たくさん参加してる様子</a></li>
</ul>


<p>確か管理者権限貰ったのは恐らく今年(すこしあやしい&hellip;厳密には去年だったかも&hellip;)で, 参加するだけでなくちょっとずつ運営面でも関わらせていただきました.
Jekyll を覚えて 読書会のデータを yaml でデータ化したり,
そのデータを使って Angularとd3.jsで 読書会の統計ページをつくったり,
データ化によって扱いやすくなったので python や ruby で簡単なスクリプトを作成して更新作業を自動化したりしました.
読書会は毎週やるので更新が一瞬でできるようになって非常に便利になりました. 統計ページのJS, よくない部分多々あるのでそのうち書き直したい.</p>

<p><strong>毎週土曜日23:00からやっているので皆さん参加しましょう!</strong> -> <a href="http://lingr.com/signup?letmein=vim">http://lingr.com/signup?letmein=vim</a></p>

<h3>Vim プラグイン読書会やってた</h3>

<ul>
<li><a href="http://haya14busa.github.io/reading-vimplugin/">Vimプラグイン読書会</a></li>
</ul>


<p>こちらも1ヶ月周期でやっていました. Vim プラグイン開発, 興味ある. という方にオススメです! 一緒に読みましょう.
またvimrc読書会とVim プラグイン読書会での経験が, Vim以外の普段の開発のレビューにも活かされたような気も&hellip;しま&hellip;す(自信なし).</p>

<p>執筆時現在次の日付が更新されてないという少々のグダりを見せていますが, 落ち着いたら必ず更新します!</p>

<h3>Osaka.vim やで</h3>

<ul>
<li><a href="http://osaka-vim.connpass.com/">Osaka.vim - connpass</a></li>
<li>ブログ記事: <a href="http://localhost:4000/osaka-vim-01/">Osaka.vim #1 に行ってきた - haya14busa</a></li>
</ul>


<p><strong>connpass上では運営になっていますが一切の運営をしていません&hellip;!</strong></p>

<p>関西のVim勉強会, 近年ではほとんどなかったので便利. 関西の皆さん参加しましょう.</p>

<h3>Vimで緊急地震速報が見れるの便利では&hellip;? eew.vim つくった</h3>

<ul>
<li><a href="https://github.com/haya14busa/eew.vim">haya14busa/eew.vim</a></li>
<li>Emacs移植: <a href="http://d.hatena.ne.jp/syohex/20140829/1409291511">eew.vimを移植しました - Life is very short</a></li>
<li>Sublime移植: <a href="https://github.com/tgfjt/Sublime-eew">tgfjt/Sublime-eew</a></li>
</ul>


<blockquote class="twitter-tweet" lang="en"><p>総務省の某審議会のエライ人が「家でテレビで録画を見ていた際、緊急地震速報が出なかった。なんとかならないのか」との意見を述べ、プチ衝撃が走っているらしい。ｗｗｗ 確かに、テレビ見てることには変わりないけれど。</p>&mdash; 閑居 (@doatease2313) <a href="https://twitter.com/doatease2313/status/504522127622418434">August 27, 2014</a></blockquote>


<blockquote class="twitter-tweet" data-cards="hidden" lang="en"><p>とりあえずでつくった <a href="https://t.co/hQQuAnnF9M">https://t.co/hQQuAnnF9M</a> RT <a href="https://twitter.com/haya14busa">@haya14busa</a> Vimに緊急地震速報流すの便利なのでは！？！？！？</p>&mdash; はやぶさ (@haya14busa) <a href="https://twitter.com/haya14busa/status/505004191199162368">August 28, 2014</a></blockquote>


<p>EmacsやSublimeに移植されたりとちょっとだけ話題になった(すこし).</p>

<h3>その他ちっちゃい Vim plugin 達</h3>

<ul>
<li><a href="https://github.com/haya14busa/unite-ghq">haya14busa/unite-ghq</a>

<ul>
<li>uniteでghqできるの便利では&hellip;?と思ってつくって公開したら, そのわずか数時間前に sorah さんが <a href="https://github.com/sorah/unite-ghq">sorah/unite-ghq</a> を公開しており,
しかもこちらのほうが基本的によくできていて「ｱｱｱｯ&hellip;」とリアルで声がでた少し苦い思い出のあるプラグイン. 自分のバージョン使ってるの自分だけだとおもう. でも便利.
既存プラグインの検索は直前まで入念にやりましょうという教訓を得ました. (数日前にやった時点ではなかったので大丈夫だと思ってた)</li>
</ul>
</li>
<li><a href="https://github.com/haya14busa/unite-reading-vimrc">haya14busa/unite-reading-vimrc</a>

<ul>
<li>vimrc読書会のログやvimrcのリンクをuniteで絞り込んで開ける. たまに vimrc読書会 の管理とか過去の記録を見るときに便利.</li>
</ul>
</li>
<li><a href="https://github.com/haya14busa/endtagcomment.vim">haya14busa/endtagcomment.vim</a>

<ul>
<li>よくvimrcで見かけるhtmlタグにコメントをつけるスクリプトをforkしてプラグイン化しただけ. もともと便利</li>
</ul>
</li>
<li><a href="https://github.com/haya14busa/unite-action-vimfiler_lcd">haya14busa/unite-action-vimfiler_lcd</a>

<ul>
<li>vimfilerで<code>lcd</code>してから開くというuniteアクションが欲しかった. 結局つかってないのであまり便利じゃない.</li>
</ul>
</li>
<li><a href="https://github.com/haya14busa/vim-textobj-number">haya14busa/vim-textobj-number</a>

<ul>
<li>数字のテキストオブジェクト. たまに便利. テキストオブジェクト学ぶかぁーという意図も含まれてた気がするけど結局それ以降テキストオブジェクト系プラグインは作成してない. なにかアイデア湧いたら作りたい.</li>
</ul>
</li>
</ul>


<h2>Vim活以外の進捗(残りの1割)</h2>

<ul>
<li>プログラミングのバイトを4月からはじめました(たぶんVim活アピール補正はかかりました. ある意味 Vim script もペイする言語&hellip;?).</li>
<li>それに伴って Scala をやりはじめたんですが視野が広がってとてもよかったし, もっと学んでいきたいです.</li>
<li>JavaScript もそこそこ書いて, Angular.js に触れたりなどしました. underscore.js も便利.</li>
<li>しかし Scala その他 Vim 以外のOSS活動の進捗ﾀﾞﾒです</li>
<li>heroku にPythonで小さいウェッブアプリをつくったのですが, 乗っかってるサービスが終了したので一緒にお亡くなりになってつらい.</li>
</ul>


<h3>勉強会にちょっとずつ参加するようになった</h3>

<ul>
<li><a href="http://scalamatsuri.org/">Enjoy.scala ! 日本最大級の Scala のカンファレンス - ScalaMatsuri</a></li>
<li><a href="http://kansaifp.doorkeeper.jp/events/17206">関西関数型道場 - 第02回 - 関西関数型道場 | Doorkeeper</a></li>
<li><a href="http://fpscala-osaka.connpass.com/">fpscala-osaka - connpass</a></li>
</ul>


<p>Vim 以外の勉強会にも今年はちょっとずつ参加するようになりました(Vimも基本的には今年からですが). しかしこれは進捗でゎなぃな&hellip;</p>

<h2>その他</h2>

<h3>GitHub current streak 365 日達成した</h3>

<blockquote class="twitter-tweet" lang="en"><p>気づいたらGitHubｺﾝﾄﾘﾋﾞｭｯｼｮﾝ Current streak 365日を達成していたっ&#8230;!!! <a href="http://t.co/XMED6OLFUp">pic.twitter.com/XMED6OLFUp</a></p>&mdash; はやぶさ (@haya14busa) <a href="https://twitter.com/haya14busa/status/544899856037208065">December 16, 2014</a></blockquote>


<p>dotfile 1行変更といったものがたくさんあるので全く大したことはしてないのですが, 日によってはそのついでにちゃんとプログラミングするぞっ! というきっかけになるので自分には合ってる継続的進捗管理術でした. 1年継続めでたい.</p>

<h3>2014年 GitHub の Pull Requests / Issues 一覧</h3>

<p><em>追記:</em></p>

<ul>
<li><a href="https://github.com/pulls?q=is%3Apr+author%3Ahaya14busa+created%3A%222014-01-01+..+2015-01-01%22+">2014年に出した Pull Requests 一覧</a></li>
<li><a href="https://github.com/issues?q=is%3Aissue+author%3Ahaya14busa+created%3A%222014-01-01+..+2015-01-01%22+">2014年に開いた Issues 一覧</a></li>
</ul>


<p>PullRequest 8 opens / 83 closed, Issues 53 open / 95 closed ※99% Vimである</p>

<h3>Podcast 聴くようになった</h3>

<p>聴いてるPodcastは</p>

<ul>
<li><a href="http://rebuild.fm/">Rebuild</a></li>
<li><a href="http://mozaic.fm/">mozaic.fm</a></li>
<li><a href="https://itunes.apple.com/jp/podcast/bairingarunyusu-bilingual/id653415937?mt=2">バイリンガルニュース (Bilingual News)</a></li>
<li><a href="http://thechangelog.com/podcast/">The Changelog Podcast</a></li>
<li><a href="https://itunes.apple.com/us/podcast/the-binpress-podcast/id897178291?mt=2">The Binpress Podcast</a></li>
<li>その他適当に気になったもの.</li>
</ul>


<p>という感じです. 例に漏れず(?), Rebuild.fm から聴き始めてめっちゃおもしろいっ! となり, そこから バイリンガルニュース や The Changelog を聴くようになりました.
最近はずっと気になってはいたけど聞いていなかった mozaic.fm を聴くようになって, こちらも Rebuild とは別のベクトルのよさがあって全部聴きました. 技術系(?)英語 podcast の binpress podcast というポッドキャストは, 全部無料でスクリプトがついているという<em>エイゴ・ゼンゼン・キキトレナイ勢</em>としては歓喜のサービスがついていてお気に入りです. おもしろさは回によって違う感じですが, 英語もついでに学ぶかーという方にはオススメです.</p>

<p>リスニング能力高めてもっと英語のポッドキャストを楽しめるようになりたい&hellip;</p>

<h3>英語の記事をコンスタントに読む &amp; 検索するようになった</h3>

<ul>
<li><a href="http://www.reddit.com/r/vim/">reddit.com/r/vim</a></li>
<li><a href="https://news.ycombinator.com/">Hacker News</a></li>
<li><a href="https://medium.com/">Medium</a></li>
<li><a href="http://getprismatic.com/home">Prismatic</a></li>
</ul>


<p>1年目も別に避けたりはしてなかったのですが, 最近は能動的に英語の情報に触れようとする確率が高くなったかなと思います.
検索や話題になっている記事を除けば, 見ているのはだいたい上記のリンクです.
ただ単に読んでるだけではなかなか得るものも少ないので, 自分から英語で発信する能力をつけたいなーというのが最近の悩みです.
現状 GitHub の issue のやりとりやプラグインのドキュメントは基本英語を使ってるのですが, もっともっと使っていかないとなかなか身につかないですねー.</p>

<h2>来年の抱負とか</h2>

<ul>
<li>Vim もっと頑張る.</li>
<li>Vim のソースコード側も C言語ちょっとぐらい読み書きできるようになって簡単なバグくらいなら報告だけでなく修正案まで出せるようにしたい.</li>
<li>Vim 以外も頑張る. なにか小さなウェッブサービスとか適当につくったりしたい.</li>
<li>Scala力をより深めるのに加えて C, Go, Haskell あたりの言語を触って学んでいきたいという思いがある.</li>
<li>データベース周りとか, 今触ってるレイヤーと別の部分も触っていきたい. 最低限基礎力が欲しい.</li>
<li>英語力をつけていきたい. Vim について英語で適当に英語用Twitterアカウントつくってつぶやくとかなら継続してできるのでは&hellip;?という考えがある.
欲を言えば Lingr の Vim 部屋のノリで英語でチャットとかできれば一番いいんじゃないかという思いがある. IRC に #vim チャンネルあるらしいけど, IRCよくわからない&hellip;ログ読みたい&hellip;</li>
<li>人生は厳しいので人生についてちゃんと考える必要がある. 人生キビシイ.</li>
</ul>


<h2>「プログラミング2年目をVimに捧げるとどうなるか?」</h2>

<p>少々Vim以外の進捗が少なすぎる気がするのは反省ですが, Vim活によってVimというコンテキストに留まらず, たくさんの貴重な経験ができました.
git や GitHub, テスト, CI, オブジェクト指向やらクロージャ, 変数や関数の名前の付け方, 英語での技術系コミュニケーションなどなど, たくさんのことを Vim駆動で理解したり, 理解を深めた1年間だったと思います.</p>

<p>Vim駆動学習, よさがあるのでオススメです. ※ただし用法用量を守って正しく Vim 活しないと Vim 以外の進捗が遅れます. 反省&hellip;</p>

<p>また Vim だといろいろな言語を使ってる人がいて, しかも雲の上のような存在の人もたくさんいたり, オンラインでもオフラインの勉強会でも活動が活発なのでVim以外にもいろんなことが知れるし, プログラミング初学者でも最初から Vim をガンガン使ってプログラミングしていくのはおもしろいかなぁと思います.</p>

<p>振り返ってみるとたくさんのVimmerにお世話になったなぁと思います. ※もちろんVimmerでないひとにもお世話になりました.</p>

<p>みなさん今年はお世話になりました. 来年の2015年もぜひ仲良くしてください. よろしくお願いします.</p>

<p>以上, <a href="https://twitter.com/haya14busa">@haya14busa</a> の 2年目の<del>プログラミング</del> Vim活記録でした.</p>

<script src="http://lab.lepture.com/github-cards/widget.js"></script>


<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

</div>
  
  


      <footer>
      
      - <a href="/haya14busa-s-happy-vimming-year-2014/">2014年の振り返り. またはプログラミング2年目をVimに捧げるとこうなるという話</a>
      <time datetime="2014-12-30T00:00:00+09:00" pubdate><span class='month'>Dec</span> <span class='day'>30</span> <span class='year'>2014</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/diary/'>diary,</a>, <a class='category' href='/categories/vim/'>vim,</a>, <a class='category' href='/categories/poemu/'>ポエム</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/enrich-your-search-experience-with-incsearch-vim/">incsearch.vimでVimの検索体験をリッチにする</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2014-12-11T22:38:41+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><p>この記事は<a href="http://qiita.com/advent-calendar/2014/vim">Vim Advent Calendar 2014</a>の14日目の記事です。
13日目は deris さんによる<a href="http://deris.hatenablog.jp/entry/2014/12/13/173125">スマートフォンでVimを操作するためにやっておいたほうがいいこと - derisの日記</a> でした。</p>

<h2>1. incsearch.vim つくった</h2>

<h3>Vimの検索体験をリッチにする, incsearch.vim を作りました</h3>

<div class="github-card" data-github="haya14busa/incsearch.vim" data-width="500" data-height="150" data-theme="default"></div>


<p><a href="https://github.com/haya14busa/incsearch.vim">haya14busa/incsearch.vim</a></p>

<p><img src="../images/gif/incsearch/incremental_regex_building.gif" alt="incremental_regex_building" /></p>

<p><br></p>

<h3>あなたとincsearch.vim 今すぐインストール</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>NeoBundle <span class="s1">&#39;haya14busa/incsearch.vim&#39;</span>
</span><span class='line'>Plugin <span class="s1">&#39;haya14busa/incsearch.vim&#39;</span>
</span><span class='line'>Plug <span class="s1">&#39;haya14busa/incsearch.vim&#39;</span>
</span><span class='line'>map /  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>forward<span class="p">)</span>
</span><span class='line'>map ?  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>backward<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span>/ <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>stay<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>TL;DR</h3>

<ol>
<li>Vim デフォルトの検索だとインクリメンタルハイライトは1つのマッチしかみてくれない</li>
<li>incsearch.vim はマッチしたもの<strong>すべて</strong>をインクリメンタルにハイライトする</li>
<li>デフォルトのコマンドラインと高い<strong>互換性</strong>を持っているのでインストールしてデフォルトの<code>/</code>を置き換えてもスムーズかつ手軽に使える</li>
<li>本日バージョン1.0としてリリースしました</li>
<li>ぜひ使ってみてください&hellip;!</li>
</ol>


<p>※ ホントにToo long になった感があるので記事は長くて嫌いになってもincsearch.vimはシンプルに使えるので嫌いにならないでくださいっ&hellip;!</p>

<h2>2. Introduction</h2>

<p>Vimの検索を便利にする. incsearch.vim を バージョン 1.0 としてリリースしました!</p>

<p>「百聞は一見に如かず」ということで, 冒頭のgifなどを見ていただくだけで大事なことはすべて伝えつくしてしまった感があります.
「もう便利さはわかった!」 という方は記事なんてすっ飛ばして是非ブラウザバックして使ってみてください!</p>

<p>しかし今まで日本語でまともに解説したことがなかったこともあるので, ちょっとした便利機能やカスタマイズの仕方, 開発についてなど話していきたいと思います. もうすでに使っていたり, 聞いたりしたことあるよーという方も, 本日バージョン1.0としてリリースし, 以前から比べてインクリメンタルに改善してきたので少しは新しい情報もあるかなーと思います</p>

<h2>3. incsearch.vim の機能を解説していくっ!</h2>

<h3>3.1 シンプルにすべてをハイライトするっ</h3>

<ol>
<li>デフォルトの <a href="http://vim-jp.org/vimdoc-ja/options.html#%27incsearch%27">:h &lsquo;incsearch&rsquo;</a> とは違い, マッチしたパターンのすべてをハイライトする</li>
<li>別ウィンドウのハイライトも対応できる(オプションで変更可, version 1.0 で追加されました)</li>
</ol>


<p>一番シンプルかつメインの機能としてマッチしたパターンをすべてハイライトします.
便利さ, 自明っぽいので説明を省きます!</p>

<p><img src="../images/gif/incsearch/incsearch_window.gif" alt="incsearch_window" /></p>

<h3>3.2 正規表現をインテラクティブに作って確認する</h3>

<ol>
<li>デフォルトの検索だとエンターを押して<code>:set hlsearch</code> 状態になるまで, 現在入力している正規表現がどこにマッチしているかわからない</li>
<li>incsearch.vim はもちろん正規表現に対応しており, スムーズに正規表現を作っていける</li>
<li><code>&lt;Plug&gt;(incsearch-stay)</code> というマッピングを提供しており, これはカーソルが動かないので途中でウィンドウ外に飛ぶといったこともない</li>
</ol>


<p>マップ例:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>map <span class="k">g</span>/ <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>stay<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="../images/gif/incsearch/incremental_regex_building.gif" alt="incremental_regex_building" /></p>

<p>(冒頭のgifと同じ)</p>

<p>これは vimrc によく書かれているプラグインマネージャが提供してるインストールコマンドから, インストールされているプラグインの部分とマッチする正規表現を作ってます(簡易版ですが). 普段の検索時にも勿論便利なのですが, 正規表現作る際の便利さは1つしかマッチを確認できないデフォルトの挙動と比べると段違いに捗ります. もしも incsearch.vim でデフォルトの検索を置き換えるまでもないかなーという人でも, 正規表現による検索の際のために<code>g/</code>など好みのマッピングに定義しておくとこういうケースでは便利に使えると思われます.</p>

<h3>3.3 検索中のインクリメンタルカーソル移動とスクロールで快適ファイル内検索</h3>

<ol>
<li>Emacsは検索中にカーソルを前後に動かせるけどVimにはない&hellip;

<ul>
<li>※ Vim には <code>n</code>/<code>N</code> があるので別になくてもよい</li>
</ul>
</li>
<li>incsearch.vim はデフォルトでは <code>&lt;Tab&gt;</code>/<code>&lt;S-Tab&gt;</code>で前後のマッチに移動できる</li>
<li>Emacsや他のエディタでは見ない機能としてスクロール機能を提供しており, 画面内に目的地がないと判断すれば一気にスキップして画面外の次のマッチに飛べる(デフォルトでは<code>&lt;C-j&gt;</code>/<code>&lt;C-k&gt;</code>)</li>
</ol>


<p><img src="../images/gif/incsearch/incremental_move_and_scroll.gif" alt="incremental_move_and_scroll" /></p>

<p><em>なにが便利か?</em></p>

<h4>a) オペレータ待機モード時のモーションとドットリピート</h4>

<p>ノーマルモードでは問題でもないですが, <code>d/{pattern}</code> といった オペレータ待機モード
で使う場合, 決定したあとに <code>n</code>/<code>N</code> を使うことはできません. しかし,
最初に目測でマッチを確認してからカウントをつけて <code>3d/{pattern}</code> とするのはとてもしんどい上に間違う可能性もあり, 生産的ではありません&hellip;</p>

<p>また1回だけの場合は ビジュアルモード を使えば上記の問題は回避できますが, これだとドットリピート が効きません.</p>

<p>そこで, incsearch.vim の <code>&lt;Tab&gt;</code>/<code>&lt;S-Tab&gt;</code> (<code>:h &lt;Over&gt;(incsearch-next)</code>) を使って
検索中にカーソルを移動させれば一目で目的地まであとどれくらいかもわかるし,
オペレータと組み合わせるモーションとしての使用も, その後のドットリピートの問題も解消できます.</p>

<h4>b) <code>:h jumplist</code> の更新が1回で済む</h4>

<p>ノーマルモードでは問題でもないといったな? あれは嘘だ!</p>

<p>Vimには <code>:h jump-motions</code> というモーションの種類があり, これに属するモーションを
行うとジャンプ前のカーソル位置が記憶され, <code>&lt;C-o&gt;</code>/<code>&lt;C-i&gt;</code> でそれらのカーソル位置を
行ったり来たりできる超便利機能が存在します. 検索系のモーション(<code>/</code>,<code>?</code>,<code>n</code>,<code>N</code>, etc..)
はこの jump-motions に属しており incsearch.vim でも勿論対応しているのでその機能を
バリバリ使うことができます.</p>

<p>ここで問題なのは <code>n</code>や<code>N</code> も jump-motions ということです. 検索後に <code>n</code>/<code>N</code>で移動したあとやっぱり検索した元の位置に戻りたいな〜という時に
<code>n</code>/<code>N</code> を押した回数分<code>&lt;C-o&gt;</code>を押す(またはカウントを前置する)必要があって地味に不便です.</p>

<p>incsearch.vim で検索中に<code>&lt;Tab&gt;</code>を押して移動してから検索を決定すれば勿論 <code>jumplist</code>
の更新は1回で済むので<code>jumplist</code>を汚すことなく十二分にそのジャンプ機能の便利さを享受することができます.
地味なよさがありますね.</p>

<h4>c) スクロール機能で <code>n</code> 連打せずファイル内をサクっと検索</h4>

<p>a), b) は1つ1つ前後に移動する機能の紹介でしたが, incsearch.vim は スクロール(デフォルトでは
<code>&lt;C-j&gt;</code>がスクロールダウン, <code>&lt;C-k&gt;</code>がスクロールアップ)という機能を搭載しており, これは人に
よってはライフチェンジングになりうるなかなかオススメ機能の1つです.</p>

<p>先ほどのgifを見てもらうとわかりやすいかと思うのですが,</p>

<p><em>デフォルトの場合</em></p>

<ol>
<li>「あーファイル内の{pattern}って部分に用があるな〜」</li>
<li>「よーし<code>/{pattern}&lt;CR&gt;</code>で検索して<code>n</code>, <code>n</code>, <code>n</code>, &hellip;」</li>
<li>「まだ見つからない&hellip;(ファイル内に<code>{pattern}</code>がたくさんあって辿り着かない)」</li>
<li>=> 不便&hellip;</li>
</ol>


<p><em>incsearch.vimのスクロール機能を使った場合</em></p>

<ol>
<li>「あーファイル内の{pattern}って部分に用があるな〜」</li>
<li>「よーし<code>/{pattern}</code>で incsearch.vim を起動しよう」</li>
<li>「あー画面内にいっぱい<code>{pattern}</code>がある&hellip;よし<code>&lt;C-j&gt;</code> で次の画面へ」</li>
<li>「<code>&lt;C-j&gt;</code>を数回押して目的地発見. 任意で<code>&lt;Tab&gt;</code>/<code>&lt;S-Tab&gt;</code>で前後に移動してから<code>&lt;CR&gt;</code>!」</li>
<li>=> <em>幸せ便利</em></li>
</ol>


<p>勿論, そもそもファイル内にたくさん存在しないようなキーワードを使って検索したり, タグが存在するなら
ctagsなどを使用してタグジャンプしたほうが断然よいですが,
いつでもユニークなキーワードが思い浮かんだり, タグが存在するわけではないので万能ではありません.
検索だとかなり汎用性が高いので個人的にはとても多用してる機能の１つになってます.</p>

<p>また他にもファイルの横断検索を補助するような機能を提供しているVimの機能や
プラグインなどなどはあるとは思いますが, 以下のようなメリットがあります</p>

<ol>
<li>&ldquo;検索&rdquo; として使える

<ul>
<li><code>gn</code>や<code>:substitute</code>と連携したりなど&#8221;検索&#8221;は他のVimの機能と一緒に使うことによって,
相乗効果でより手に馴染む快適なキーストロークでエディットすることができます.</li>
</ul>
</li>
<li>周囲のコンテキスト, 前後の行がみやすい

<ul>
<li><code>:vimgrep</code> や <code>unite-line</code> といった機能はだいたい前後の行が見れなかったりして
ユースケースによっては困ることもあります. ただし<code>grep</code>
などは複数のファイルを扱える大きなメリットがあるので使い分けれるようになるのが一番よさそうです.</li>
</ul>
</li>
</ol>


<h3>3.4 オート:nohlsearch</h3>

<ol>
<li><code>:set hlsearch</code>って便利でもあるけどだいたいウザイ

<ul>
<li><code>nnoremap &lt;Esc&gt;&lt;Esc&gt; :&lt;C-u&gt;nohlsearch&lt;CR&gt;</code> と言ったマッピングで検索後に消す人が多いと思います.</li>
</ul>
</li>
<li>incsearch.vim の <code>オート:nohlsearch</code> 機能を使えば検索後カーソル移動したらハイライトが消えるようになります.</li>
<li>地味に便利</li>
</ol>


<p><img src="../images/gif/incsearch/incsearch_auto_nohlsearch.gif" alt="incsearch_auto_nohlsearch" /></p>

<h4>設定</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">set</span> <span class="nb">hlsearch</span>
</span><span class='line'><span class="k">let</span> <span class="k">g</span>:<span class="nb">incsearch</span>#auto_nohlsearch <span class="p">=</span> <span class="m">1</span>
</span><span class='line'>map <span class="k">n</span>  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">n</span><span class="p">)</span>
</span><span class='line'>map <span class="k">N</span>  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">N</span><span class="p">)</span>
</span><span class='line'>map *  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span>*<span class="p">)</span>
</span><span class='line'>map #  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span>#<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span>* <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">g</span>*<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span># <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">g</span>#<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>※ <code>&lt;Plug&gt;(incsearch-nohl-n)</code> などは単なる <code>&lt;Plug&gt;(incsearch-nohl)n</code> のエイリアス
なので独自の <code>n</code>や<code>*</code>の機能を提供しているわけではありません</p>

<h3>3.5 他のプラグインと組み合わせて使う</h3>

<p>(3.4のつづき)</p>

<p><code>incsearch.vim</code> は <code>/</code> とそれにまつわる検索の便利機能を提供するようにシンプルにしようとデザインしてるつもりです(そこっ!検索にまつわる〜とか言ってる時点でシンプルではないとか言わない!). なので <code>n</code> や <code>*</code> を拡張したい場合に備え別の拡張プラグインと同時に扱える用に設計しています.</p>

<p>普通に一緒に使う分には何も考えなくとも併用できますが, incsearch.vim の オート :nohlsearch 機能 を使いたい場合はマッピングをちょっといじる必要があるので自分が使ってる例を出してみます</p>

<h4>n 拡張プラグイン vim-auzu と一緒に使う</h4>

<div class="github-card" data-github="osyo-manga/vim-anzu" data-width="500" data-height="150" data-theme="default"></div>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>map   <span class="k">n</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">n</span><span class="p">)</span>
</span><span class='line'>map   <span class="k">N</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">N</span><span class="p">)</span>
</span><span class='line'>nmap  <span class="k">n</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>anzu<span class="p">-</span><span class="k">n</span><span class="p">-</span>with<span class="p">-</span>echo<span class="p">)</span>
</span><span class='line'>nmap  <span class="k">N</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>anzu<span class="p">-</span><span class="k">N</span><span class="p">-</span>with<span class="p">-</span>echo<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>vim-anzu は <code>n</code>/<code>N</code> を押すとファイル内の <code>現在位置までの数/全マッチ数</code> を表示してくれる拡張機能です.</p>

<h4>* 拡張プラグイン vim-asterisk と一緒に使う</h4>

<div class="github-card" data-github="haya14busa/vim-asterisk" data-width="500" data-height="153" data-theme="default"></div>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>map *  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span>*<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span>* <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span><span class="k">g</span>*<span class="p">)</span>
</span><span class='line'>map #  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span>#<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span># <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span><span class="k">g</span>#<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>または vim-asterisk の<code>z*</code>機能(カーソルが動かない<code>*</code>) をメインに使う場合</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>map *  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>nohl0<span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span>z*<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span>* <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>nohl0<span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span>gz*<span class="p">)</span>
</span><span class='line'>map #  <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>nohl0<span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span>z#<span class="p">)</span>
</span><span class='line'>map <span class="k">g</span># <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>nohl0<span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>asterisk<span class="p">-</span>gz#<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>vim-asterisk は僕が最近作った <code>*</code> をカイゼンするプラグインです. 機能としては</p>

<ol>
<li>カーソルを動かさない <code>*</code> 機能の提供(マッピングにzのprefixがついてる)

<ul>
<li>動かさずに <code>*</code> や <code>g*</code> でカーソル位置の単語を検索レジスタ(<code>@/</code>)に入れたあとに
<code>gn</code> などを組み合わせて編集したいというケースでは次のマッチに飛ぶ必要がないので
カーソル動かないバージョンの <code>*</code> が欲しかった. どうせ <code>n</code>/<code>N</code> ですぐ動かせる</li>
<li><code>noremap * *N</code> という解決法はダサいしウィンドウが一時的に動くので不便</li>
</ul>
</li>
<li>ビジュアルモードで選択したテキストを検索するvisual-star 機能

<ul>
<li>サクッと勢いで作ったので <a href="https://github.com/thinca/vim-visualstar">thinca/vim-visualstar</a>
のマルチバイトや <code>keyword</code> の扱いの部分のコードをお借りしています. ありがとうございます</li>
<li>visual-star は <code>CursorMoved</code> イベントが2回発生してしまうという問題があり,
incsearch.vim の オート:nohlsearch 機能と併用できなかった.
なので visual-star機能と同時に使いたい場合はvim-asteriskのvim-asterisk機能を使うと便利</li>
</ul>
</li>
<li>ignorecase だけでなく smartcase の値も一緒にみてくれる

<ul>
<li>デフォルトはなぜか <code>ignorecase</code> の値しかみてくれず, <code>smartcase</code> を設定していても<code>ignorecase</code>状態で検索される</li>
<li>非直感的すぎるので vim-asterisk は <code>:set ignorecase</code>の値も<code>:set smartcase</code>をみるようになっています</li>
</ul>
</li>
</ol>


<h3>3.6 Vim のデフォルトからちょっとカイゼン</h3>

<h4>a) magic オプションカイゼン</h4>

<p>Vimには <code>'magic'</code> という正規表現のエスケープする文字を変えるオプションがありますが
<code>\m</code>, <code>\M</code> しか設定できません(<code>:h /magic</code>).
またこれは<code>/</code>だけでなくすべての正規表現の挙動を変えてしまい設定すると,
対応できていないプラグインが動かなくなったりする問題があります (<code>:h 'magic'</code>)</p>

<p>incsearch.vim ではこれをカイゼンして <code>\v</code>, <code>\V</code>, <code>\m</code>, <code>\M</code> の, どの magic でも設定できる. また勿論他のプラグインには一切影響しません.</p>

<p><em>例</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">let</span> <span class="k">g</span>:<span class="nb">incsearch</span>#<span class="nb">magic</span> <span class="p">=</span> <span class="s1">&#39;\v&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>b) カーソル下単語補完やCtrl-Wによる単語削除のカイゼン</h4>

<p>Vimは<code>set incsearch</code>状態で検索中に<code>&lt;C-r&gt;&lt;C-w&gt;</code>を押すとコマンドラインのカーソル前の単語とのマッチをみて,
バッファのカーソル下の単語を補完してくれる機能を持っています.
この機能自体はとてもべんりなのですが, コマンドラインが <code>/\vwo</code> の状態, カーソル下の単語が <code>word</code> の時に
<code>&lt;C-r&gt;&lt;C-w&gt;</code> を押しても補完が発動せず単にカーソル下の単語が挿入され <code>/\vwoword</code>になってしまいます.</p>

<p>これはvery magicオプションを設定する<code>\v</code>の<code>v</code>部分と<code>wo</code>との区別がなく<code>vwor</code>
がコマンドラインのカーソル前の単語と認識されているのが原因なので, カーソル前の単語
の範囲をかしこく決めてくれる機能を提供しています(オプションでoffにすることは可能です. <code>:h g:incsearch#smart_backward_word</code>)</p>

<p><code>&lt;C-w&gt;</code> によるカーソル前の単語の削除も同様の問題がありこれもカイゼンして,
<code>/\vword</code>状態で<code>&lt;C-w&gt;</code>を押すとデフォルトだと<code>/\</code>となるところを<code>\v</code>となるようにしています</p>

<p><img src="../images/gif/incsearch/incsearch_smart_backward_word.gif" alt="incsearch_smart_backward_word" /></p>

<p>見た目はとっても地味で聞いてもピンとこないかもしれないですが, 挙動が直感的になるとても気に入ってる機能のひとつです. ｼﾞｯｻｲﾍﾞﾝﾘ</p>

<h3>3.6 マッピングについて</h3>

<ol>
<li><code>:cnoremap</code> や <code>:cmap</code> に設定されているマッピングは自動で適用される</li>
<li>incsearch.vim が提供する機能へのマッピングや, <code>:cnoremap</code> の設定の上書き,
incsearch.vim でのみマッピングしたいという場合は <code>:h IncSearchNoreMap</code> コマンド
を使います</li>
</ol>


<p><em>設定例</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>augroup <span class="nb">incsearch</span><span class="p">-</span><span class="nb">keymap</span>
</span><span class='line'>    <span class="k">autocmd</span><span class="p">!</span>
</span><span class='line'>    <span class="k">autocmd</span> <span class="nb">VimEnter</span> * <span class="k">call</span> <span class="k">s</span>:incsearch_keymap<span class="p">()</span>
</span><span class='line'>augroup END
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:incsearch_keymap<span class="p">()</span>
</span><span class='line'>    IncSearchNoreMap <span class="p">&lt;</span>Right<span class="p">&gt;</span> <span class="p">&lt;</span>Over<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span>next<span class="p">)</span>
</span><span class='line'>    IncSearchNoreMap <span class="p">&lt;</span>Left<span class="p">&gt;</span>  <span class="p">&lt;</span>Over<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">prev</span><span class="p">)</span>
</span><span class='line'>    IncSearchNoreMap <span class="p">&lt;</span>Down<span class="p">&gt;</span>  <span class="p">&lt;</span>Over<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="nb">scroll</span><span class="p">-</span><span class="k">f</span><span class="p">)</span>
</span><span class='line'>    IncSearchNoreMap <span class="p">&lt;</span>Up<span class="p">&gt;</span>    <span class="p">&lt;</span>Over<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="nb">scroll</span><span class="p">-</span><span class="k">b</span><span class="p">)</span>
</span><span class='line'><span class="k">endfunction</span>
</span></code></pre></td></tr></table></div></figure>


<h3>3.7 autocmd で拡張できる</h3>

<p>参照: <code>:h incsearch-autocmd</code></p>

<p>incsearch.vim は Vim デフォルトのコマンドラインのと違い独自の autocmd イベントを発行しているので, それをつかってincsearch.vimを拡張することができます. 以下は <a href="https://github.com/inside/vim-search-pulse">inside/vim-search-pulse</a> というプラグインの機能を簡単に組み込んでみた例です. 個人的には要らないけどなんかカッコイイ&hellip;!?</p>

<p><img src="../images/gif/incsearch/incsearch_autocmd_flash.gif" alt="incsearch_autocmd_flash" /></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:flash<span class="p">()</span>
</span><span class='line'>  <span class="k">for</span> _ <span class="k">in</span> range<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</span><span class='line'>    <span class="k">set</span> <span class="nb">cursorline</span><span class="p">!</span>
</span><span class='line'>    <span class="k">redraw</span>
</span><span class='line'>    sleep <span class="m">50</span>m
</span><span class='line'>  <span class="k">endfor</span>
</span><span class='line'>  <span class="k">set</span> <span class="nb">cursorline</span><span class="p">!</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'>augroup <span class="nb">incsearch</span><span class="p">-</span>pulse
</span><span class='line'>    <span class="k">autocmd</span><span class="p">!</span>
</span><span class='line'>    <span class="k">autocmd</span> <span class="nb">User</span> IncSearchExecute <span class="k">call</span> <span class="k">s</span>:flash<span class="p">()</span>
</span><span class='line'>augroup END
</span><span class='line'>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>my<span class="p">-</span>flash<span class="p">)</span> :<span class="p">&lt;</span>C<span class="p">-</span><span class="k">u</span><span class="p">&gt;</span><span class="k">call</span> <span class="p">&lt;</span>SID<span class="p">&gt;</span>flash<span class="p">()&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>map <span class="k">n</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">n</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>my<span class="p">-</span>flash<span class="p">)</span>
</span><span class='line'>map <span class="k">N</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span><span class="nb">incsearch</span><span class="p">-</span><span class="k">nohl</span><span class="p">-</span><span class="k">N</span><span class="p">)&lt;</span>Plug<span class="p">&gt;(</span>my<span class="p">-</span>flash<span class="p">)</span>
</span><span class='line'><span class="c">&quot; デフォルトの場合</span>
</span><span class='line'><span class="c">&quot; map n n&lt;Plug&gt;(my-flash)</span>
</span><span class='line'><span class="c">&quot; map N N&lt;Plug&gt;(my-flash)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>4. Development</h2>

<p>開発の話とか.</p>

<h3>4.1 Design</h3>

<p>ここまでいろいろと紹介しておいてどうかという話なのですが, incsearch.vim は
<em>シンプル</em>に機能を提供し , デフォルトのコマンドラインと高い<em>互換性</em>を保ちつつ,
それでいて<em>拡張性</em>の高いものにしようというコンセプトでつくっています(実際そうなっているとは言ってない)</p>

<p>特に一番苦心したのはデフォルトのコマンドラインとの互換性を保つように開発するところでした.
現在はVimのデフォルトの<code>/</code>でできるほとんどのことはできますが,</p>

<p>ビジュアルモードでのハイライトだったり, vim-repeat といった別のプラグインに依存せず
ドットリピートを可能にしたり, 逆にそれを可能にした <code>&lt;expr&gt;</code> マッピングによる <code>textlock</code> という
Vimの制限を解消するために, 必要でない部分は<code>&lt;expr&gt;</code> マッピングを使わないようにするといった回り道を
しながら, 現在はほぼデフォルトと互換性のある状態にできたと思います.</p>

<h4><code>&lt;expr&gt;</code> についてちょっと解説したりする</h4>

<ol>
<li><code>:h :map-&lt;expr&gt;</code></li>
<li>ドットリピート対応できる</li>
<li><code>:h function-search-undo</code> とかの制限をかいくぐれる</li>
<li>いろいろいじった上で最終的にデフォルトのマッピングを返して実行! ということができるのでデフォルトのモーションを拡張する際にとても便利</li>
<li>しかし問題点もある</li>
</ol>


<p><code>&lt;expr&gt;</code> とは expression mapping の略で, <code>{rhs}</code>(right-hand-side) を評価した値を返してくれます.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span>expr<span class="p">&gt;</span> <span class="k">g</span><span class="sr">/ printf(&quot;/</span>%<span class="k">s</span>\<span class="p">&lt;</span>CR<span class="p">&gt;</span>&quot;<span class="p">,</span> input<span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>上記のマッピング例では, <code>{rhs}</code> の <code>input('&gt;')</code> が評価され, そこで入力した値を<code>{pattern}</code>とすると
それが<code>printf()</code>によって最終的には <code>/{pattern}&lt;CR&gt;</code> になります.</p>

<p>何がいいのかというと, 実際に <code>dg/pattern</code> などと使った際に, <code>{rhs}</code> が評価されて <code>d/pattern</code> になります.
これはそもそも最初から <code>d/pattern</code> と打った時と同様の挙動になるので, あたかもデフォルトの<code>/</code>を使ったような挙動を簡単に実装できるのです!
これによって ドットリピート や <code>:function-search-undo</code> に対応することが可能となります.</p>

<p>とは行ってもイマイチわかりにくいと思うので <code>&lt;expr&gt;</code> を使わないマッピングを見てみましょう.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:non_expr_search<span class="p">()</span>
</span><span class='line'>    execute <span class="s1">&#39;normal!&#39;</span> printf<span class="p">(</span><span class="s2">&quot;/%s\&lt;CR&gt;&quot;</span><span class="p">,</span> input<span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">))</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'><span class="nb">noremap</span> z/ :<span class="p">&lt;</span>C<span class="p">-</span><span class="k">u</span><span class="p">&gt;</span><span class="k">call</span> <span class="p">&lt;</span>SID<span class="p">&gt;</span>non_expr_search<span class="p">()&lt;</span>CR<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>単に検索という意味では動いているように見えるのですが, <code>function-search-undo</code>の制限により
ハイライトされず, また <code>dz/pattern</code> は <code>d:&lt;C-u&gt;call &lt;SID&gt;non_expr_search()&lt;CR&gt;</code> となるので,
ドットリピート時にも <code>s:non_expr_search</code> 関数が呼ばれてしまします. これによってその中の
<code>input()</code>がドットリピートでも呼ばれてしまい入力待ちになってしまいます.
これでは以前に入力した値をつかって検索してくれるデフォルトのドットリピートの挙動が再現出来ていません&hellip;不便&hellip;</p>

<p>普通のマッピングだとこういう問題があるのでそれを解消ができる <code>&lt;expr&gt;</code>
はデフォルトのモーションの拡張にとてもあっているのですが,
<code>&lt;expr&gt;</code> は<code>&lt;expr&gt;</code>で上述した副作用として <code>:normal</code> が使えないといった問題もあるので
これから<code>&lt;expr&gt;</code>を使ってプラグイン作りたいっという方は注意して使ってみてください.</p>

<p>incsearch.vim や先ほど紹介した vim-asterisk も<code>&lt;expr&gt;</code>を活用して便利にしたりしています.
他にも <a href="https://github.com/rhysd/clever-f.vim">rhysd/clever-f.vim</a> や <a href="https://github.com/deris/vim-shot-f">deris/vim-shot-f</a>
といった <code>f</code> を拡張するプラグインでも <code>&lt;expr&gt;</code> が使用されており, もともとこの<code>&lt;expr&gt;</code>でドットリピートに対応するという方法は
僕は clever-f で初めてみました. スゴイ.</p>

<h3>4.2 vital-over, または incsearch.vim のカスタムコマンドラインインターフェースについて</h3>

<div class="github-card" data-github="osyo-manga/vital-over" data-width="400" data-height="150" data-theme="default"></div>


<p>incsearch.vim は vital-over というカスタムコマンドラインインターフェースを提供するライブラリを使わせていただいてます.
incsearch.vim のデザインとしてVimデフォルトとの互換性を目指していると先ほど書いたのですが,
実はincsearch.vimがやっている部分は検索だけで,
コマンドラインインターフェースがVimのデフォルトと同じように使えるのはこの vital-over というライブラリのおかげです.
本当にアツイプラグインなので興味あるVim プラグイン開発者は是非使ってみてください!</p>

<p>モジュール性が高いのでガッツリとしたコマンドラインとしてではなく, ちょっと便利な <code>input()</code> や
<code>getchar()</code> として使えるかなーと思います. そのうち何かまた作ってみたい&hellip;!</p>

<h3>4.3 テストとかLintとか</h3>

<ol>
<li>themis.vim でテスト書いた</li>
<li>vim-lint / vint (期待)</li>
<li>テストって便利って改めて気づいた&hellip;!</li>
<li>themis のテスト書き方自体は <a href="https://github.com/vim-jp/vital.vim">vim-jp/vital.vim</a> など他のものを参考にするとよいと思う</li>
</ol>


<div class="github-card" data-github="thinca/vim-themis" data-width="400" data-height="150" data-theme="default"></div>


<div class="github-card" data-github="syngan/vim-vimlint" data-width="400" data-height="153" data-theme="default"></div>


<p><img src="../images/gif/incsearch/incsearch_dot_reporter_test.png" alt="incsearch_dot_reporter_test.png" />
<img src="../images/gif/incsearch/incsearch_badges.png" alt="incsearch_badges.png" /></p>

<p>今回incsearch.vim は(現在が開発&amp;メンテしてるvim-easymotionでもちょっとずつやってはいましたが)割と初めてスクラッチでテストやlintをしながら
書いたものだったのですが Vim script の開発周りの環境はかなり便利です. 特に <strong>Vim</strong> を使えるところが開発しやすくてよいです.</p>

<p>CI も travis で 最新に近い Vim と travis.org の Vim のバージョンの両方でテスト
(<a href="https://github.com/vim-jp/vital.vim/pull/241">Test on the latest Vim by crazymaster · Pull Request #241 · vim-jp/vital.vim</a>) したり,
<a href="http://d.hatena.ne.jp/thinca/20140812/1407775202">Vim プラグインを Windows 環境でテストする - 永遠に未完成</a>
を参考に Windows 環境 でもテストがしてみたりしてなかなかよかったです. (<del>Windows環境だけで違う挙動になるのヤメローッ!</del>)</p>

<p>Lint に関しては <a href="https://github.com/Kuniwak/vint">Kuniwak/vint</a> という python 製ツールも気になっているので期待ですね.</p>

<h3>4.4 Vim script 楽しいっ</h3>

<p>テストやLintツールもあるし,
<a href="https://github.com/vim-jp/vital.vim">vim-jp/vital.vim</a> や
<a href="https://github.com/osyo-manga/vital-over">osyo-manga/vital-over</a>
といったライブラリ, Vim から引ける膨大な<code>:help</code>, 困ったら <a href="http://lingr.com/room/vim/archives#message-20835831">vim-jp – Lingr</a>
や <a href="https://github.com/vim-jp/issues/issues">Issues · vim-jp/issues</a> に相談, バグ報告できる環境,
Vim を使って開発できる Vim script を書くのは楽しいです&hellip;!</p>

<p><br>
&hellip;&hellip;..
<br>
<br>
<strong>&hellip;.ほんとうですよっ!?</strong> (言語仕様は寛容な心でカバー)
<br>
<br></p>

<p>ぜひぜひみなさんVim プラグイン開発やっていって開発効率を上げたり快適でリッチなエディタ環境を作ってみましょう&hellip;!</p>

<p>(※ 用法, 用量を守ってただしくVimしましょう)</p>

<h2>5. 最後に</h2>

<p>話が逸れてる感をひしひしと感じますが, あくまで incsearch.vim を紹介・解説する記事だったはずなので話を戻しましょう.</p>

<p>incsearch.vim, 今でもとても便利だと思っているのですが, まだまだ開発していく余地があります. (後方互換性を壊すことはしないと思います)</p>

<p>autocmd の拡張例を上述しましたが, まだコマンドラインの中身をいじれるようなインターフェースは実は提供できていません.
どこまでオープンにしていけばいいのか, オープンにしたら本当に便利になるのか,
などなど僕にとっては難しくゆっくり考えながら決めて行きたいです.  意見頂けたりとかコントリビューションお待ちしています&hellip;!</p>

<p>Vim Advent Calendar でテンションあがってちょっと長くなってしまいました. ここまで読んでくださった方ありがとうございます.</p>

<p><a href="https://github.com/haya14busa/incsearch.vim">incsearch.vim</a> 是非1度使ってみてください. 気に入って頂けるとそれはとっても嬉しいです!</p>

<p>それではVim Advent Calendar 2014の14日目の記事でした.</p>

<p>Happy Vimming!</p>

<script src="http://lab.lepture.com/github-cards/widget.js"></script>

</div>
  
  


      <footer>
      
      - <a href="/enrich-your-search-experience-with-incsearch-vim/">incsearch.vimでVimの検索体験をリッチにする</a>
      <time datetime="2014-12-11T22:38:41+09:00" pubdate><span class='month'>Dec</span> <span class='day'>11</span> <span class='year'>2014</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/5">&larr; Older</a>
    
    <a href="/archives">Blog Archives</a>
    
    <a class="next" href="/posts/3">Newer &rarr;</a>
    
  </div><!-- /div.pagination -->
</div><!-- /div.blog-index -->

      </div><!-- /div#content -->
    </div><!-- /div#main -->
  </div><!-- /div.container -->
  <footer><div id="footer-widgets-wrapper">
  <div id="footer-first" class="footer-widget">
    <h3>About Me</h3>
    <section class="about-me">
      
        <img class="icon-image" src="https://0.gravatar.com/avatar/dca89778aa3e6bc49f0e100df1a1a1f0?s=240" alt="icon_image">
      
      <div>
        <ul>
          
            <li>GitHub: <a href="https://github.com/haya14busa">@haya14busa</a></li>
          
          
            <li>Twitter: <a href="https://twitter.com/haya14busa">@haya14busa</a></li>
          
            <li>Blog: <a href="http://haya14busa.com">http://haya14busa.com</a></li>
        </ul>
        <p>
          V!mm!shment Th!s World!
        </p>
      </div>
    </section>
  </div><!-- /div#footer-second -->

  <div id="footer-second" class="footer-widget">
    <h3>Recent Posts</h3>
    <section id="hatena-popular" class="hatena-bookmark">
      <script language="javascript" type="text/javascript" src="http://b.hatena.ne.jp/js/widget.js" charset="utf-8"></script>
      <script language="javascript" type="text/javascript">
        Hatena.BookmarkWidget.url   = "http://haya14busa.com";
        Hatena.BookmarkWidget.title = "Recent Posts";
        Hatena.BookmarkWidget.sort  = "hot";
        Hatena.BookmarkWidget.width = 0;
        Hatena.BookmarkWidget.num   = 10;
        Hatena.BookmarkWidget.theme = "notheme";
        Hatena.BookmarkWidget.load();
      </script>
    </section>
  </div><!-- /div#footer-second -->

  <div id="footer-third" class="footer-widget">
    <h3>Popular Posts</h3>
    <section id="hatena-popular" class="hatena-bookmark">
      <script language="javascript" type="text/javascript" src="http://b.hatena.ne.jp/js/widget.js" charset="utf-8"></script>
      <script language="javascript" type="text/javascript">
        Hatena.BookmarkWidget.url   = "http://haya14busa.com";
        Hatena.BookmarkWidget.title = "Popular Posts";
        Hatena.BookmarkWidget.sort  = "count";
        Hatena.BookmarkWidget.width = 0;
        Hatena.BookmarkWidget.num   = 10;
        Hatena.BookmarkWidget.theme = "notheme";
        Hatena.BookmarkWidget.load();
      </script>
    </section>
  </div><!-- /div#footer-third -->
</div><!-- /div#footer-widgets-wrapper -->

<div id="credit" role="contentinfo">
  <p>
    Copyright &copy; 2017 - <a href="https://github.com/haya14busa/">haya14busa</a> -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/haya14busa/mjolvim-octotheme">Mjolvim</a></span>
  </p>
</div>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'haya14busa-s-memo';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
