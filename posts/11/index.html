
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="ja"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>haya14busa</title>
  <meta name="author" content="haya14busa">

  
  <meta name="description" content="Install nltk $ pip install nltk wordnetのコーパスをPythonインタプリタからダウンロード $ python
Python 2.7.5 (default, Jul 19 2013, 19:37:30)
[GCC 4.2.1 Compatible Apple &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://haya14busa.com/posts/11/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="haya14busa" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39461503-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <div id="container">
    <header role="banner"><hgroup>
  <h1><a href="/">haya14busa</a></h1>
  
    <h2>haya14busa&#8217;s memo</h2>
  
</hgroup>

</header>
    <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="site:haya14busa.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
    <div id="main">
      <div id="content">
        <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/python-nltk-natural-language-processing/">Python,NLTKで自然言語処理</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2013-08-16T00:00:00+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>Install nltk</h2>

<pre><code>$ pip install nltk
</code></pre>

<p>wordnetのコーパスをPythonインタプリタからダウンロード</p>

<pre><code>$ python
Python 2.7.5 (default, Jul 19 2013, 19:37:30)
[GCC 4.2.1 Compatible Apple LLVM 4.2 (clang-425.0.28)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import nltk
&gt;&gt;&gt; nltk.download()
</code></pre>

<p>MacならGUIの画面が起動するので適当に従ってダウンロード。</p>

<p>書き終わってから気づいたけど以下ナチュラルに<code>see()</code>使ってます。代わりに<code>dir()</code>使うか、そもそも飛ばすか、便利なので<code>see</code>をインストールしましょう。</p>

<pre><code>$ pip install see
</code></pre>

<p>~/.pythonstartup に</p>

<pre><code>from see import see
</code></pre>

<p>を記述しておくと便利</p>

<p><a href="https://github.com/haya14busa/dotfiles/blob/master/.pythonstartup">dotfiles/.pythonstartup at master · haya14busa/dotfiles</a></p>

<h2>Stemming and Lemmatisation</h2>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Stemming">Stemming &#8211; Wikipedia, the free encyclopedia</a>

<ul>
<li>語幹化</li>
</ul>
</li>
<li><a href="http://en.wikipedia.org/wiki/Lemmatisation">Lemmatisation &#8211; Wikipedia, the free encyclopedia</a>

<ul>
<li>見出し語化, レンマ化</li>
</ul>
</li>
</ul>


<p>語幹化、見出し語化の前に、大文字・小文字を正規化しておく。(語幹化は大文字小文字混ざってても動くっぽいけどレンマ化は動かない)</p>

<pre><code>&gt;&gt;&gt; print 'Python'.lower()
python
</code></pre>

<h3>Stemming</h3>

<pre><code>&gt;&gt;&gt; from nltk import stem
&gt;&gt;&gt; see(stem)
    help()                 .ISRIStemmer()         .LancasterStemmer()
    .PorterStemmer()       .RSLPStemmer()         .RegexpStemmer()
    .SnowballStemmer()     .StemmerI()            .WordNetLemmatizer()   .api
    .isri                  .lancaster             .porter
    .regexp                .rslp                  .snowball
    .wordnet
&gt;&gt;&gt; stemmer = stem.PorterStemmer()
&gt;&gt;&gt; stemmer.stem('dialogue')
'dialogu'
&gt;&gt;&gt; stemmer2 = stem.LancasterStemmer()
&gt;&gt;&gt; stemmer2.stem('dialogue')
'dialog'
</code></pre>

<p>PorterStemmerとLancasterStemmerでアルゴリズムが違うっぽい。</p>

<p>Lancasterのほうがアグレッシブ。</p>

<blockquote><p>Porter: Most commonly used stemmer without a doubt, also one of the most gentle stemmers. One of the few stemmers that actually has Java support which is a plus, though it is also the most computationally intensive of the algorithms(Granted not by a very significant margin). It is also the oldest stemming algorithm by a large margin.</p>

<p>Lancaster: Very aggressive stemming algorithm, sometimes to a fault. With porter and snowball, the stemmed representations are usually fairly intuitive to a reader, not so with Lancaster, as many shorter words will become totally obfuscated. The fastest algorithm here, and will reduce your working set of words hugely, but if you want more distinction, not the tool you would want.</p>

<p>&#8211; <cite><a href="http://stackoverflow.com/questions/10554052/what-are-the-major-differences-and-benefits-of-porter-and-lancaster-stemming-alg">java &#8211; What are the major differences and benefits of Porter and Lancaster Stemming algorithms? &#8211; Stack Overflow</a></cite></p></blockquote>

<p>個人的にdialogueとdialogでstemが違うとつらいのでLancaster使ってみて、ミスが多いようならPorter使う予定。</p>

<p>他にもSnowballとかあるけど割愛</p>

<h3>Lemmatisation</h3>

<pre><code>&gt;&gt;&gt; from nltk import stem
&gt;&gt;&gt; lemmatizer = stem.WordNetLemmatizer()
&gt;&gt;&gt; lemmatizer.lemmatize('dialogs')
'dialog'
&gt;&gt;&gt; lemmatizer.lemmatize('dialogues')
'dialogue'
&gt;&gt;&gt; lemmatizer.lemmatize('cookings')
'cooking'
&gt;&gt;&gt; lemmatizer.lemmatize('cooking', pos='v')
'cook'
</code></pre>

<h2>Tokenization</h2>

<p><a href="http://en.wikipedia.org/wiki/Tokenization">Tokenization &#8211; Wikipedia, the free encyclopedia</a></p>

<pre><code>&gt;&gt;&gt; from nltk import tokenize
&gt;&gt;&gt; see(tokenize)
    help()                    .BlanklineTokenizer()     .LineTokenizer()
    .PunktSentenceTokenizer()                           .PunktWordTokenizer()
    .RegexpTokenizer()        .SExprTokenizer()         .SpaceTokenizer()
    .TabTokenizer()           .TreebankWordTokenizer()  .WhitespaceTokenizer()
    .WordPunctTokenizer()     .api                      .blankline_tokenize()
    .line_tokenize()          .load()                   .punkt
    .regexp                   .regexp_tokenize()        .sent_tokenize()
    .sexpr                    .sexpr_tokenize()         .simple
    .treebank                 .util                     .word_tokenize()
    .wordpunct_tokenize()
&gt;&gt;&gt; aio1 = 'He grinned and said, "I make lots of money.  On weekdays I receive
an average of 50 orders a day from all over the globe via the Internet."'
</code></pre>

<h3>Sentence Tokenization</h3>

<pre><code>&gt;&gt;&gt; tokenize.sent_tokenize(aio1)
['He grinned and said, "I make lots of money.', 'On weekdays I receive an average of 50 orders a day from all over the globe via the Internet.', '"']
</code></pre>

<h3>Word Tokenization</h3>

<pre><code>&gt;&gt;&gt; tokenize.word_tokenize(aio1)
['He', 'grinned', 'and', 'said', ',', '``', 'I', 'make', 'lots', 'of', 'money.', 'On', 'weekdays', 'I', 'receive', 'an', 'average', 'of', '50', 'orders', 'a', 'day', 'from', 'all', 'over', 'the', 'globe', 'via', 'the', 'Internet', '.', "''"]
&gt;&gt;&gt; tokenize.wordpunct_tokenize(aio1)
['He', 'grinned', 'and', 'said', ',', '"', 'I', 'make', 'lots', 'of', 'money', '.', 'On', 'weekdays', 'I', 'receive', 'an', 'average', 'of', '50', 'orders', 'a', 'day', 'from', 'all', 'over', 'the', 'globe', 'via', 'the', 'Internet', '."']
</code></pre>

<h2>Delete Stopwords</h2>

<p><a href="http://en.wikipedia.org/wiki/Stop_words">Stop words &#8211; Wikipedia, the free encyclopedia</a></p>

<pre><code>&gt;&gt;&gt; from nltk.corpus import stopwords
&gt;&gt;&gt; stopset = set(stopwords.words('english')
... )
&gt;&gt;&gt; stopset
set(['all', 'just', 'being', 'over', 'both', 'through', 'yourselves', 'its', 'before', 'herself', 'had', 'should', 'to', 'only', 'under', 'ours', 'has', 'do', 'them', 'his', 'very', 'they', 'not', 'during', 'now', 'him', 'nor', 'did', 'this', 'she', 'each', 'further', 'where', 'few', 'because', 'doing', 'some', 'are', 'our', 'ourselves', 'out', 'what', 'for', 'while', 'does', 'above', 'between', 't', 'be', 'we', 'who', 'were', 'here', 'hers', 'by', 'on', 'about', 'of', 'against', 's', 'or', 'own', 'into', 'yourself', 'down', 'your', 'from', 'her', 'their', 'there', 'been', 'whom', 'too', 'themselves', 'was', 'until', 'more', 'himself', 'that', 'but', 'don', 'with', 'than', 'those', 'he', 'me', 'myself', 'these', 'up', 'will', 'below', 'can', 'theirs', 'my', 'and', 'then', 'is', 'am', 'it', 'an', 'as', 'itself', 'at', 'have', 'in', 'any', 'if', 'again', 'no', 'when', 'same', 'how', 'other', 'which', 'you', 'after', 'most', 'such', 'why', 'a', 'off', 'i', 'yours', 'so', 'the', 'having', 'once'])
&gt;&gt;&gt; aio1words = tokenize.wordpunct_tokenize(aio1)
&gt;&gt;&gt; aio1words
['He', 'grinned', 'and', 'said', ',', '"', 'I', 'make', 'lots', 'of', 'money', '.', 'On', 'weekdays', 'I', 'receive', 'an', 'average', 'of', '50', 'orders', 'a', 'day', 'from', 'all', 'over', 'the', 'globe', 'via', 'the', 'Internet', '."']
&gt;&gt;&gt; for word in aio1words:
...  if len(word) &lt; 3 or word in stopset:
...   continue
...  print word
...
grinned
said
make
lots
money
weekdays
receive
average
orders
day
globe
via
Internet
====================
filter で
====================
&gt;&gt;&gt; print filter(lambda w: len(w) &gt; 2 and w not in stopset, aio1words)
['grinned', 'said', 'make', 'lots', 'money', 'weekdays', 'receive', 'average', 'orders', 'day', 'globe', 'via', 'Internet']
</code></pre>

<h2>Links</h2>

<ul>
<li><a href="http://nltk.org/">Natural Language Toolkit — NLTK 2.0 documentation</a></li>
<li><a href="https://github.com/japerk/PyCon-NLTK-Tutorial">japerk/PyCon-NLTK-Tutorial</a></li>
<li><a href="http://petitviolet.hatenablog.com/entry/20120523/1337760714">正規表現・自然言語処理 &#8211; I/O Error : My Knowledge</a></li>
<li><a href="https://github.com/pika-shi/sphinx_information_retrieval/blob/master/natural_language_processing.rst">sphinx_information_retrieval/natural_language_processing.rst at master · pika-shi/sphinx_information_retrieval</a></li>
</ul>


<div class="amz-container" style="overflow:hidden;margin-bottom:20px;">
  <div class="amz-left" style="float:left; margin:0 20px 0;">
    <a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873114705/haya14busa-22/ref=nosim/" rel="nofollow" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51EoFqAGo1L._SL160_.jpg" class="amz-img" /></a>
  </div>
  
  <div class="amz-right" style="overflow:hidden;">
    <div class="amz-title" style="margin-bottom:20px;">
      <a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873114705/haya14busa-22/ref=nosim/" rel="nofollow" target="_blank">入門 自然言語処理</a>
    </div>
    
    <div class="amz-detail">
      <div class="amz-info1" style="white-space:nowrap;">
        Steven Bird,Ewan Klein,Edward Loper
      </div>
      
      <div class="amz-info2" style="white-space:nowrap;">
        オライリージャパン 2010-11-11
      </div>
      
      <div class="amz-price" style="white-space:nowrap;">
        ￥ 3,990
      </div>
      
      <div class="amz-link" style="margin-top:20px;">
        <a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873114705/haya14busa-22/ref=nosim/" rel="nofllow" target="_blank">Amazon.co.jp で詳細を見る</a>
      </div>
    </div>
  </div>
</div>




<div class="amz-container" style="overflow:hidden;margin-bottom:20px;">
  <div class="amz-left" style="float:left; margin:0 20px 0;">
    <a href="http://www.amazon.co.jp/exec/obidos/ASIN/0596516495/haya14busa-22/ref=nosim/" rel="nofollow" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51QhcSlOO4L._SL160_.jpg" class="amz-img" /></a>
  </div>
  
  <div class="amz-right" style="overflow:hidden;">
    <div class="amz-title" style="margin-bottom:20px;">
      <a href="http://www.amazon.co.jp/exec/obidos/ASIN/0596516495/haya14busa-22/ref=nosim/" rel="nofollow" target="_blank">Natural Language Processing with Python</a>
    </div>
    
    <div class="amz-detail">
      <div class="amz-info1" style="white-space:nowrap;">
        Steven Bird,Ewan Klein,Edward Loper
      </div>
      
      <div class="amz-info2" style="white-space:nowrap;">
        Oreilly & Associates Inc 2009-06-30
      </div>
      
      <div class="amz-price" style="white-space:nowrap;">
        ￥ 3,724
      </div>
      
      <div class="amz-link" style="margin-top:20px;">
        <a href="http://www.amazon.co.jp/exec/obidos/ASIN/0596516495/haya14busa-22/ref=nosim/" rel="nofllow" target="_blank">Amazon.co.jp で詳細を見る</a>
      </div>
    </div>
  </div>
</div>



</div>
  
  


      <footer>
      
      - <a href="/python-nltk-natural-language-processing/">Python,NLTKで自然言語処理</a>
      <time datetime="2013-08-16T00:00:00+09:00" pubdate><span class='month'>Aug</span> <span class='day'>16</span> <span class='year'>2013</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/python/'>python</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/change-vim-easymotion-from-lokaltog-to-forked/">Vim-EasyMotionをforkされた拡張バージョンに変更する</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2013-08-16T00:00:00+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><p>追記: VAC2012でもっと詳しい紹介記事を書きました</p>

<p><a href="http://haya14busa.com/vim-lazymotion-on-speed/">Vim-Easymotionを拡張してカーソルを縦横無尽に楽々移動する « haya14busa</a></p>

<h2>Vim-Easymotionが好き</h2>

<p>僕がvimのプラグインを導入して、一番最初に感動したのは<a href="https://github.com/Lokaltog/vim-easymotion">vim-easymotion</a>でした[要出典]</p>

<p>特にvim触りたての頃なんてj連打で移動していたりなんかしてるので、カーソル移動系のプラグインは余計感動モノです。</p>

<p>そんなvim-easymotionを今でも使いまくってるのですが、少し不満な点、こんな機能あったら良くない？っていう点がありました。</p>

<ol>
<li>移動先の候補がたくさんあって2回打たなければならないとき面倒くさい

<ul>
<li>この記事で解決</li>
</ul>
</li>
<li>カーソルより左(F)か右(f)かのどちらかでしかサーチできないけど、画面内に収まってる全範囲でサーチ出来るようにしたい。

<ul>
<li>この記事で解決</li>
</ul>
</li>
<li>Visualモードでのバグを是非fixしてほしい

<ul>
<li>仕様かも。相対行使ってるから難しいとか？</li>
</ul>
</li>
<li>Insertモードでも使いたい()

<ul>
<li>無理。しかも正直なくてもよい</li>
</ul>
</li>
</ol>


<p>2に関しては最初は<code>H&lt;Leader&gt;f</code>して、エスケープで中断されたら<C-o>でカーソル位置を戻すvimscriptとか作ればいいのかなーとか考えてたりしたんだけど、そういえばForkされてるやつあるんじゃね？と思いつきGithubへ。</p>

<h2>Githubで探す</h2>

<p><a href="https://github.com/Lokaltog/vim-easymotion">Lokaltog/vim-easymotion</a></p>

<p>Githubのネットワークグラフで探してみると、案の定拡張機能付きのForkされたものがありました。</p>

<p>ただ多すぎてどれが一番いいかわからないorz</p>

<p>単純に一番最新のものを使うという手もあるけど、スターも付いてなかったのでそこそこスターついてて、拡張された奴を選びました。</p>

<p><a href="https://github.com/supasorn/vim-easymotion">supasorn/vim-easymotion</a></p>

<p><code>&lt;Leader&gt;s</code>でforword-backword serchが出来る他、<code>vl</code>や<code>yl</code>で行選択や行単位のヤンクを便利にしてくれるというお節介機能付き。(<code>vl</code>とか使うのでやめて…)</p>

<p>またtwo-key comboとして、候補が多い時はじめから2つキーを表示してくれるようになります。</p>

<h2>ということで.vimrc</h2>

<p>.vimrc</p>

<pre><code>" vim-easymotion
"------------------------------------
let g:EasyMotion_leader_key = ';'
let g:EasyMotion_keys='hjklasdgyuiopqwertnmzxcvb;:f'

hi link EasyMotionTarget ErrorMsg
hi link EasyMotionShade  Comment

" forked easymotion extention
let g:EasyMotion_special_select_line = 0
let g:EasyMotion_special_select_phrase = 0

let g:EasyMotion_leader_key = ';'
</code></pre>

<p>呼び出すキーを&#8217;;&lsquo;に変更.</p>

<pre><code>let g:EasyMotion_keys='hjklasdgyuiopqwertnmzxcvb;:f'
</code></pre>

<p>晴れて最初から2つキーを表示してくれるようになったので、候補から打ちにくいキーは全面的に消してみる。</p>

<pre><code>let g:EasyMotion_special_select_line = 0
let g:EasyMotion_special_select_phrase = 0
</code></pre>

<p><code>vl</code>で行選択を楽にって言われてもそこまで便利にならないし、何より<code>vl</code>とか普通に使うので機能をOFFに。</p>

<p>ドキュメントがFork元のものなので、ソース直接見ないとキーマップの変更の仕方とかわからないという罠。</p>

<p>ハイライトの設定も追加しなくてはならないのによくわかんないので保留…</p>

<p>すこしつまずきはあったもののこれで快適easymotion生活！</p>

<h2>使いそうなコマンドまとめ</h2>

<dl>
<dt><code>;f</code></dt>
<dd>  カーソルより右側の任意の文字を検索</dd>
<dt><code>;F</code></dt>
<dd>  カーソルより左側の任意の文字を検索</dd>
<dt><strong><code>;s</code></strong></dt>
<dd>  画面内の任意の文字を検索(双方向)</dd>
<dt><code>;j</code></dt>
<dd>  下方向に行移動</dd>
<dt><code>;k</code></dt>
<dd>  上方向に行移動</dd>
<dt><code>;w</code></dt>
<dd>  カーソルより右側の単語移動</dd>
<dt><code>;b</code></dt>
<dd>  カーソルより左側の単語移動</dd>
<dt><code>;n</code></dt>
<dd>  前方検索</dd>
<dt><code>;N</code></dt>
<dd>  後方検索</dd>
</dl>
</div>
  
  


      <footer>
      
      - <a href="/change-vim-easymotion-from-lokaltog-to-forked/">Vim-EasyMotionをforkされた拡張バージョンに変更する</a>
      <time datetime="2013-08-16T00:00:00+09:00" pubdate><span class='month'>Aug</span> <span class='day'>16</span> <span class='year'>2013</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/vimrepress-and-wordpress-using-git/">GitでWordPressにPostしたいと思ったけど結局VimRepress導入した</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2013-08-07T00:00:00+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>GitでWPにPostしたくなった</h2>

<p>最近Git使い出して、GitHubに気軽にコードとREADMEをpushしたりできて、こんなに便利だと記事をGitで管理して、出来れば<code>git push</code>,または簡単なコマンドを打てばWordPressに投稿できるようにしたい！と思うのは必然ですよね？.</p>

<p><code>git push</code>はWordPress運用してるサーバーにgitがないとだめだし、そのままpushとかはできなさそうなのでXML_RPCプロトコルが使えそう</p>

<ul>
<li><a href="http://ja.wikipedia.org/wiki/XML-RPC">XML-RPC &#8211; Wikipedia</a></li>
<li><a href="http://codex.wordpress.org/XML-RPC_WordPress_API">XML-RPC WordPress API « WordPress Codex</a></li>
</ul>


<p>一応そもそもGitで作れるブログにするとかいう選択肢もあるのだけど、すでにWordPress使ってるし、テーマとかプラグイン便利なのであまり移行する気が起こらないのでとりあえず却下。</p>

<h2>GitでWPにポスト?</h2>

<p>「Git WordPress」で検索するとWordPressのテーマかプラグイン、またはそもそもWordPress本体をGitで管理する話ばっかりでノイズが酷かったけど一応なんとなくそれっぽいのは見つけました.</p>

<p><a href="http://www.brool.com/index.php/posting-to-wordpress-from-git">Posting To WordPress From Git | brool</a></p>

<p>ただ考えてみればタイトルやらタグやらつけるのも大変そうで、そもそも手を付ける前に次の策に移行しました…一応今からor今度やってみるかも(フラグ)</p>

<p>なぜそんな手を付ける前に移行したかというと、そういえばVimでWordPressにPostするとかいう記事をどっかで記憶があったから。ということでそっちを試してみる.</p>

<h2>VimRepress</h2>

<h3>Install</h3>

<p>.vimrc</p>

<pre><code>NeoBundle 'pentie/VimRepress'
</code></pre>

<p><a href="https://github.com/vim-scripts/VimRepress">vim-scripts/VimRepress</a>が公式だけど、開発止まっててforkされてるやつを導入.</p>

<p>記事書きながら,<a href="https://github.com/sousu/VimRepress">sousu/VimRepress</a>もいいかもしれないと読んでて思ったけど、試してはいません.ローカルに一時保存出来る機能とかあるらしくて良さそう.</p>

<h3>Settings</h3>

<p>~/.vimpressrc</p>

<pre><code>[Blog0]
blog_url = http://haya14busa.com
username = haya14busa
password = password
store_markdown = n

[Blog1]
blog_url = http://hogehoge.com
username = hogehoge
</code></pre>

<p><code>~/.vimpressrc</code>にブログURLなどを保存.passwordはオプションで書かなかった場合その都度入力できる.</p>

<h3>Markdown</h3>

<p>VimRepressはMarkdownをサポートしてて</p>

<pre><code>$ easy_install python-markdown2
</code></pre>

<p>or</p>

<pre><code>$ pip install markdown2
</code></pre>

<p>すれば有効になる</p>

<p>ただ僕は<a href="http://wordpress.org/plugins/markdown-on-save-improved/">WordPress › Markdown on Save Improved « WordPress Plugins</a>をすでに使ってました.こっちだと<a href="http://michelf.ca/projects/php-markdown/extra/">PHP Markdown Extra</a>が使えること、また<code>"EditFormat : HTML</code>かつMarkdown On Save Improvedをインストールした状態でMarkdown形式で書くと、ちゃんと変換されてPostできることを確認したことから、VimRepressのMarkdownは使ってません.</p>

<h2>使い方</h2>

<p>詳しくは<code>:h vimpress</code>か記事末尾のリンクがわかりやすい</p>

<p>余談だけど<code>:h vimrepress</code>じゃないところが辛かった.なぜプラグイン名と違うのか.</p>

<h3>起動</h3>

<ul>
<li><code>:BlogList</code>で記事一覧を見てEnterで編集画面

<ul>
<li>デフォルトでは最新の10記事表示.でもMoreでどんどん読める.</li>
</ul>
</li>
<li><code>:BlogNew</code>で新記事の編集画面</li>
</ul>


<p><code>:BlogOpen</code>もあるけどあまり使わなさそう.記事が大量にあって,昔の記事をurlから起動する時とかに使えそう?.</p>

<h3>Edit</h3>

<p>編集画面</p>

<pre><code>"=========== Meta ============
"StrID : 
"Title : GitでWordPressにPostしたいと思ったけど結局VimRepress導入した
"Slug  : install-vimrepress
"Cats  : WordPress
"Tags  : wordpress, git, vim
"=============================
"EditType   : post
"EditFormat : HTML
"BlogAddr   : http://haya14busa.com
</code></pre>

<p>StrIDは自動で挿入されるので空白でOK.Slugも一応いらない.Cats(Category)はすでにカテゴリーが作られていないとダメっぽいです.Tagsは新しいものでもOK.VimRepressのMarkdown機能を使う場合はEditFormatをMarkdownに.</p>

<h3>Preview</h3>

<ul>
<li><code>:BlogPreviw draft</code>でブラウザが起動し、WordPressの下書きプレビュー

<ul>
<li>デフォルトの<code>:BlogPreviw (local)</code>だとローカルプレビューでCSS効いてなかったり、Markdown on save ImprovedでMarkdown対応している場合使い物にならない.</li>
</ul>
</li>
<li><code>:BlogPreviw publish</code>だと投稿してプレビューだけどそれプレビューじゃなくね？</li>
</ul>


<h3>Post and Save</h3>

<ul>
<li><code>:BlogSave (draft)</code>で下書き保存

<ul>
<li>なお<code>:w</code>しても意味なし。癖でやっちゃうからVimRepressの編集画面ではaliasするとかしたい.Vimscript勉強したらできるかな?</li>
</ul>
</li>
<li><code>:BlogSave publish</code>で投稿！

<ul>
<li>または<code>:BlogPreview publish</code></li>
</ul>
</li>
</ul>


<h3>コンフリクトしてうざったい</h3>

<p>.vimrc</p>

<pre><code>nnoremap &lt;CR&gt; o&lt;ESC&gt;
</code></pre>

<p>インサートモードに入らずにEnterキーで改行を挿入出来るようにキーマップしてるとVimRePressの<code>:BlogList</code>から編集画面に飛ぶエンターの挙動とコンフリクトしてエラーがいっぱいでちゃう。一応動くけど。</p>

<p>VimRepress側の設定でなんとかしたいけどわからなかった.Help見る限り,keymap用の変数とかも用意されてないっぽいし[要出典]</p>

<h3>結論:捗る</h3>

<p>既存記事の編集とかも含め、管理画面にアクセスせずに投稿できるのがとても捗る.</p>

<p>ただ今までは<a href="http://haya14busa.com/darkroom-js/">ブラウザで動くシンプルなエディタ「Darkroom.js」 « haya14busa</a>を使ってブラウザ完結で記事書いたりして、アプリ間の移動がいらなかったり、iPadでも全く同じ方法で使えたりと、Darkroom-jsも捨てがたい.そもそもiPadではVimRepress使えないし、時と場合によって使い分ける所存.</p>

<p>(Darkroom-jsに対するアクションなくて寂しいのでぜひ見てやってください.)</p>

<h2>Link</h2>

<h3>Repository</h3>

<ul>
<li><a href="https://github.com/pentie/VimRepress">pentie/VimRepress</a></li>
<li><a href="https://github.com/vim-scripts/VimRepress">vim-scripts/VimRepress</a></li>
<li><a href="https://github.com/sousu/VimRepress">sousu/VimRepress</a></li>
</ul>


<h3>VimRepress</h3>

<ul>
<li><a href="http://tsuchikazu.net/vim_markdown_wordpress/">Vimを使ってMarkdown形式でWordPressに投稿してみる | tsuchikazu blog</a></li>
<li><a href="http://akakyouryuu.com/blog/vim%E3%81%8B%E3%82%89vimrepress%E3%81%A7wordpress%E3%81%AB%E6%8A%95%E7%A8%BF%E3%81%99%E3%82%8B/">vimからVimRepressでWordPressに投稿する | 赤恐竜</a></li>
<li><a href="http://sousu.jp/wp/tool/wordpress-vim-markdown/">WordPress+Vim+Markdownでメモ環境の構築</a></li>
</ul>


<h3>Other</h3>

<ul>
<li><a href="http://www.brool.com/index.php/posting-to-wordpress-from-git">Posting To WordPress From Git | brool</a></li>
<li><a href="http://ja.wikipedia.org/wiki/XML-RPC">XML-RPC &#8211; Wikipedia</a></li>
<li><a href="http://codex.wordpress.org/XML-RPC_WordPress_API">XML-RPC WordPress API « WordPress Codex</a></li>
</ul>

</div>
  
  


      <footer>
      
      - <a href="/vimrepress-and-wordpress-using-git/">GitでWordPressにPostしたいと思ったけど結局VimRepress導入した</a>
      <time datetime="2013-08-07T00:00:00+09:00" pubdate><span class='month'>Aug</span> <span class='day'>07</span> <span class='year'>2013</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/wordpress/'>wordpress</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/install-stylus-nib-and-vim-auto-compile/">Stylus,nibのインストールとVimで自動コンパイル</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2013-08-07T00:00:00+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>Install</h2>

<p>まずはnode.js</p>

<pre><code>$ brew install node
</code></pre>

<p>Stylusとnibのインストール</p>

<pre><code>$ npm install -g stylus nib
</code></pre>

<p>これでOK</p>

<h2>Vimで自動コンパイル</h2>

<p>.vimrc</p>

<pre><code>autocmd BufWritePost,FileWritePost *.styl silent !stylus &lt;afile&gt; -u nib &gt;/dev/null
</code></pre>

<p>Node.jsで自動でコンパイルさせるとか,<code>Stylus -w</code>させるとか色々方法はあると思うけど、Vimで設定しておくと手軽に使える.</p>

<p>本当はちゃんと条件分岐したほうがいいんだろうな…</p>

<h2>Example</h2>

<p>example.styl</p>

<pre><code>@import 'nib'

.nib
    border-radius:10px
</code></pre>

<p>これを保存(:w)すると自動でexample.cssが生成されます.</p>

<p>example.css</p>

<pre><code>.nib {
  -webkit-border-radius: 10px;
  border-radius: 10px;
}
</code></pre>

<p>これだけだとnibの必要性薄そうに見えるけど<code>global-reset()</code>とかその他機能が目白押しで便利</p>

<h2>for Emmet (zen-coding)</h2>

<p><a href="https://github.com/mattn/emmet-vim">mattn/emmet-vim</a></p>

<p>.vimrc</p>

<pre><code>autocmd BufRead,BufNewFile *.styl set filetype=sass

" let g:user_emmet_settings = {
" \  'styl' : {
" \    'filters' : 'fc',
" \  },
" \}
</code></pre>

<p>コメントアウトしてあるように、設定したりして見たのだけど、うまく*.stylファイルでちゃんとcssの設定に変わらないので<code>filetype=sass</code>にしてお茶を濁してます.というか<code>fl:l|fc</code>自体効かないので他がおかしいのかも…</p>

<h2>Link</h2>

<ul>
<li><a href="http://learnboost.github.io/stylus/">Stylus</a></li>
<li><a href="http://visionmedia.github.io/nib/">nib &#8211; CSS3 extensions for Stylus</a></li>
<li><a href="http://bonpworks.tumblr.com/post/14120084222/stylus-nib-node-canvas">Stylus, Nib, node-canvas をインストール •• connecting dots</a></li>
<li><a href="http://bonpworks.tumblr.com/post/14222158520/stylus-nib">Stylus + Nib を使ってみた •• connecting dots</a></li>
<li><a href="http://astronaughts.net/css-preprocessor-advent-calendar-2012-sixday/">磯野ー、Stylus を導入しようぜー！ | astronaughts.net</a></li>
</ul>

</div>
  
  


      <footer>
      
      - <a href="/install-stylus-nib-and-vim-auto-compile/">Stylus,nibのインストールとVimで自動コンパイル</a>
      <time datetime="2013-08-07T00:00:00+09:00" pubdate><span class='month'>Aug</span> <span class='day'>07</span> <span class='year'>2013</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/stylus/'>stylus</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/edit-vimrc-easily/">Vimでvimrcを編集しやすくする記述とvimrcのリロードでモードラインの設定が無視される問題</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2013-08-07T00:00:00+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>Edit &amp; Automatically Reload .vimrc</h2>

<p>.vimrc</p>

<pre><code>"------------------------------------
" Open &amp; Reload .vimrc
"------------------------------------
set foldmethod=expr
set modeline
command! Evimrc  e $MYVIMRC

augroup source-vimrc
  autocmd!
  autocmd BufWritePost *vimrc source $MYVIMRC | set foldmethod=marker
  autocmd BufWritePost *gvimrc if has('gui_running') source $MYGVIMRC
augroup END

"------------------------------------
" Lokaltog/vim-easymotion
"------------------------------------
hi link EasyMotionTarget ErrorMsg
hi link EasyMotionShade  Comment

"------------------------------------
"vim: foldmethod=marker
</code></pre>

<p>.vimrcを編集するときは<code>:Evimrc</code>(:ev<TAB>で補完させる).<br/>
.vimrcを編集後のリロードは最初はコマンドを使おうと思ったけど保存時の自動実行のほうが手軽で良さげ.ただ,関数とか途中まで記述してる状態で保存しちゃうと困りそうでもあるかも？</p>

<h2>問題点</h2>

<p>なるべく最小構成の環境で試したから自分だけではないとおもうのだけど,</p>

<ol>
<li>vimrcの<code>set foldmethod=expr</code>とvimのモードラインの<code>"vim: foldmethod=marker</code>の記述で違うものを設定してる場合,リロード時にvimrcの方の記述の設定に変わってしまう.

<ul>
<li>しかも最小構成では発生しなかったけど,使ってるvimrcでは一度閉じてから読み込み直してもそのままモードライン記述が無視された.</li>
<li>最小構成の方でも試したからloadviewの問題ではないっぽい.</li>
</ul>
</li>
<li>なぜかEasymotionのターゲットのハイライトが消えて,超絶読みにくくなる問題も発生</li>
</ol>


<h2>解決策</h2>

<p>上記vimrcに記述したとおり</p>

<ol>
<li>普通は<code>autocmd BufWritePost *vimrc source $MYVIMRC</code>と記述するところを<code>autocmd BufWritePost *vimrc source $MYVIMRC | set foldmethod=marker</code>として無理やり変える.</li>
<li>今まで設定してなかったけど上記vimrcのようにEasymotionのハイライト設定してしまう.</li>
</ol>


<h2>というか</h2>

<p>vimrcの編集とリロードをしやすくする設定を未だしてなかったあたりVimmerを名乗れるない感じですね…今までわざわざ<code>:source ~/.vimrc</code>するかvim再起動させてた.</p>

<p>出来るのは知ってたけど後回しにしてた結果がこれだよ.でも自動で再読み込みさせることも出来るのは収穫だった.有名どころの記述はコマンドかキーマッピングで実装してる気がする.オートロードさせるとかなり捗りますね.ただfoldの状態がリセットされるので,折りたたみを閉じてる状態でやるとちょっとびっくりする.</p>

<p>Easymotionのハイライトに関しては原因が全くわからなかった…検索とかのハイライトは機能していたのでハイライト機能自体がおかしくなったわけじゃないっぽい</p>

<p>リロード時にモードラインの記述が無視されるのは,最初はバグ的な何かだと思ったけど,<code>source ~/.vimrc</code>の場合,そもそもコメントであるモードラインの記述は読み込まない仕様かも.</p>

<h2>Link</h2>

<ul>
<li><a href="http://c4se.hatenablog.com/entry/2013/05/15/115205">vimrcを編集し、保存時に自動で再読み込みする &#8211; c4se記：さっちゃんですよ☆</a></li>
<li><a href="http://vim-users.jp/2009/09/hack74/">Vim-users.jp &#8211; Hack #74: 簡単にvimrcを編集する</a></li>
</ul>

</div>
  
  


      <footer>
      
      - <a href="/edit-vimrc-easily/">Vimでvimrcを編集しやすくする記述とvimrcのリロードでモードラインの設定が無視される問題</a>
      <time datetime="2013-08-07T00:00:00+09:00" pubdate><span class='month'>Aug</span> <span class='day'>07</span> <span class='year'>2013</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/12">&larr; Older</a>
    
    <a href="/archives">Blog Archives</a>
    
    <a class="next" href="/posts/10">Newer &rarr;</a>
    
  </div><!-- /div.pagination -->
</div><!-- /div.blog-index -->

      </div><!-- /div#content -->
    </div><!-- /div#main -->
  </div><!-- /div.container -->
  <footer><div id="footer-widgets-wrapper">
  <div id="footer-first" class="footer-widget">
    <h3>About Me</h3>
    <section class="about-me">
      
        <img class="icon-image" src="https://0.gravatar.com/avatar/dca89778aa3e6bc49f0e100df1a1a1f0?s=240" alt="icon_image">
      
      <div>
        <ul>
          
            <li>GitHub: <a href="https://github.com/haya14busa">@haya14busa</a></li>
          
          
            <li>Twitter: <a href="https://twitter.com/haya14busa">@haya14busa</a></li>
          
            <li>Blog: <a href="http://haya14busa.com">http://haya14busa.com</a></li>
        </ul>
        <p>
          V!mm!shment Th!s World!
        </p>
      </div>
    </section>
  </div><!-- /div#footer-second -->

  <div id="footer-second" class="footer-widget">
    <h3>Recent Posts</h3>
    <section id="hatena-popular" class="hatena-bookmark">
      <script language="javascript" type="text/javascript" src="http://b.hatena.ne.jp/js/widget.js" charset="utf-8"></script>
      <script language="javascript" type="text/javascript">
        Hatena.BookmarkWidget.url   = "http://haya14busa.com";
        Hatena.BookmarkWidget.title = "Recent Posts";
        Hatena.BookmarkWidget.sort  = "hot";
        Hatena.BookmarkWidget.width = 0;
        Hatena.BookmarkWidget.num   = 10;
        Hatena.BookmarkWidget.theme = "notheme";
        Hatena.BookmarkWidget.load();
      </script>
    </section>
  </div><!-- /div#footer-second -->

  <div id="footer-third" class="footer-widget">
    <h3>Popular Posts</h3>
    <section id="hatena-popular" class="hatena-bookmark">
      <script language="javascript" type="text/javascript" src="http://b.hatena.ne.jp/js/widget.js" charset="utf-8"></script>
      <script language="javascript" type="text/javascript">
        Hatena.BookmarkWidget.url   = "http://haya14busa.com";
        Hatena.BookmarkWidget.title = "Popular Posts";
        Hatena.BookmarkWidget.sort  = "count";
        Hatena.BookmarkWidget.width = 0;
        Hatena.BookmarkWidget.num   = 10;
        Hatena.BookmarkWidget.theme = "notheme";
        Hatena.BookmarkWidget.load();
      </script>
    </section>
  </div><!-- /div#footer-third -->
</div><!-- /div#footer-widgets-wrapper -->

<div id="credit" role="contentinfo">
  <p>
    Copyright &copy; 2016 - <a href="https://github.com/haya14busa/">haya14busa</a> -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/haya14busa/mjolvim-octotheme">Mjolvim</a></span>
  </p>
</div>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'haya14busa-s-memo';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
