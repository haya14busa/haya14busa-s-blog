
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="ja"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>haya14busa</title>
  <meta name="author" content="haya14busa">

  
  <meta name="description" content="GitHub: haya14busa/reviewdog: A code review dog who keeps your codebase healthy 英語記事: reviewdog — A code review dog who keeps your codebase healthy &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://haya14busa.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="haya14busa" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39461503-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <div id="container">
    <header role="banner"><hgroup>
  <h1><a href="/">haya14busa</a></h1>
  
    <h2>haya14busa&#8217;s memo</h2>
  
</hgroup>

</header>
    <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="site:haya14busa.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
    <div id="main">
      <div id="content">
        <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/reviewdog/">Reviewdog を飼ってコードレビューや開発を改善しませんか</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2016-10-24T07:44:34+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><p><img src="https://raw.githubusercontent.com/haya14busa/i/d598ed7dc49fefb0018e422e4c43e5ab8f207a6b/reviewdog/reviewdog.logo.png" alt="reviewdog logo" /></p>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/dc0ccb1e110515ea407c146d99b749018db05c45/reviewdog/sample-comment.png" alt="" /></p>

<p>GitHub: <a href="https://github.com/haya14busa/reviewdog">haya14busa/reviewdog: A code review dog who keeps your codebase healthy</a></p>

<p>英語記事: <a href="https://medium.com/@haya14busa/reviewdog-a-code-review-dog-who-keeps-your-codebase-healthy-d957c471938b#.r3hb734et">reviewdog — A code review dog who keeps your codebase healthy – Medium</a></p>

<p>reviewdog というlinter などのチェックツールの結果を自動で GitHub の Pull Request にコメントしたり，
ローカルでも diff の結果から新たに導入されたエラーだけを表示するようにフィルタリングできるツールを作りました．</p>

<p><a href="https://medium.com/@haya14busa/reviewdog-a-code-review-dog-who-keeps-your-codebase-healthy-d957c471938b#.r3hb734et">英語記事</a> を Medium に書いたし，README も書いたので
日本語記事はまぁいらないかなぁと思ったけど，柄にもなく Vim 関連以外で普通に便利ツールを書いてしまって，これは日本語でも簡単に共有しようかなぁと思いこの記事を書いています．
(とはいえ機能の実現方法として Vim は関係はしてるんですけどね.)</p>

<p>特に和訳とかではなく，英語ではなかなか文章に落としづらかったことをだらだら書こうかと思います．英語は難しい&hellip;
(だらだらと日本語を書いてるので日本語ができてるとは言ってない)</p>

<h2>背景とかきっかけ</h2>

<p>compiler や lint といったコードをチェックするツールはものによっては直さなくてもいいものをレポートすることがありますよね．
例えば Scala の compiler はオプションを与えたらかなりいろんな警告を出してくれますが，
別に直さなくてもいいケースがあるものがあったり， Play framework
で使ってると ルーティングファイルやテンプレートファイルに対して，こちらが直せない警告を
バンバンだしてきたりします．(これはバージョンを上げると直るっぽい?)</p>

<p><a href="https://github.com/golang/lint">golint</a> は <code>-set_exit_status</code> を付けないと問題を見つけても exit status が 1 になりませんが，
これはもともとあくまで コーディングスタイル の問題を見つけるものだという思想からでしょう．</p>

<blockquote><p>Golint differs from govet. Govet is concerned with correctness, whereas golint is concerned with coding style.</p></blockquote>

<p>Go の OSS プロジェクトでは CI で golint の問題があればビルドをFAILにすることが結構多いと思いますが，
本来直さなくてもいいところまで直さなくてはいけなくて消耗したりしていませんか?</p>

<p>去年 Google のインターンで Go 書いてたときは，実際 golint のエラーでテストがfail するとかではなく，
bot が自動でコメントしてくれてあとは勝手に直せという感じで便利でした．</p>

<p>まぁ直さなくてもいい結果は少なくて大抵は直すのですが，直さなくてもいいものはゼロではないです．
コメントで bot に直さなくてもいいものを指摘されたら単に無視してcloseすればいいので無駄に消耗せずにすんで便利．</p>

<p>また CI で落とすために指摘してくれると便利なことは多いけど設定で off にしてしまうケースもあるかなーと思います．
例えば JavaScript で関数の引数に使ってないものがあったら警告してくれると便利なケースもあるかなぁーという反面，
コールバック用関数などでは渡ってくるのがわかってるからいいんだよ！というケースとか．</p>

<p>あとは既存のコードベースに新しく linter を導入しようとすると，既存のコードに対してエラー
出まくって導入するために直していくのが面倒だなぁ&hellip; 放置していると新しいコードに対しても
lint が走らないので消耗する&hellip;ということもあるかと思います．</p>

<p>上記の問題を解決する1つの方法としては，とりあえずPull Request の差分に関して lint をかけたり
して自動でbotがコメントしてくれる仕組みがあれば，100% 円満解決ではなくともかなりつらみが
解消されるかと思います．</p>

<p>世の中にはすでにそういうサービスは一応あって <a href="https://houndci.com/">Hound CI</a>
とか <a href="https://sideci.com/">SideCI</a> がそうなんですが，使える言語やツールは限られています．
たとえば Vim の linter を Vim プラグインのレポジトリに対して使えるようになることはないでしょう.</p>

<p>また，ローカルでも(差分に対して lint などを書けるという意味で)実行できないと Pull Request 出さないとチェックできないので不便です．</p>

<p>ということで作ったのが <a href="https://github.com/haya14busa/reviewdog">reviewdog</a> になります．</p>

<p>あんまり技術的に面白いことがあったというよりは，本来あるべきものなのになかったので作ったという感じ．
汎用的に lint の結果をパースする手段をどのツールも提供してるものがないのが問題で，
reviewdog は Vim の Quickfix 用の &lsquo;errorformat&rsquo; という機能を Go で port することによって実現しました．</p>

<p>GitHub: <a href="https://github.com/haya14busa/errorformat">haya14busa/errorformat: Vim&rsquo;s quickfix errorformat implementation in Go</a></p>

<p>&lsquo;errorformat&rsquo; 形式を採用したのは僕が単に Vimmer だから&hellip; というのももちろんあるんですが，
仕様の全体を理解するのは結構大変とはいえ，簡単なerrorformatを書くのは簡単だし，それでいて
難しい複数行のエラーメッセージをパースできる利点があります．</p>

<p>emacs では compilation モードが Vim の quickfix に対応するようで，errorformat に対応するものは
正規表現とサブマッチのインデックスっぽいのですが，簡単な複数行エラーには対応してそうですが，
Vim の &lsquo;errorformat&rsquo; のほうが汎用的っぽいなーと思いました(詳しく見れてません)</p>

<p>&lsquo;errorformat&rsquo;, 実装ポーティングして仕様を理解していくと，かなりよくできているなーという印象で
Vim は時代の先を走ってると思いました．</p>

<p>また reviewdog 以外でも <a href="https://github.com/alecthomas/gometalinter">https://github.com/alecthomas/gometalinter</a> のもっと汎用的なバージョンを言語を問わず
errorformat を使って作るとかも可能なんじゃないかな〜と思います．(gometalinter 個人的にあんまり好きくないし)</p>

<h2>インストールとか使い方書こうかと思ったけど疲れたのでREADMEとか英語のpost読んでください</h2>

<ul>
<li><a href="https://github.com/haya14busa/reviewdog">haya14busa/reviewdog: A code review dog who keeps your codebase healthy</a></li>
<li><a href="https://medium.com/@haya14busa/reviewdog-a-code-review-dog-who-keeps-your-codebase-healthy-d957c471938b#.r3hb734et">reviewdog — A code review dog who keeps your codebase healthy – Medium</a></li>
</ul>


<p>あと雑だけど Google Doc の design doc な何かも一応ある <a href="https://docs.google.com/document/d/1mGOX19SSqRowWGbXieBfGPtLnM0BdTkIc9JelTiu6wA/edit#">reviewdog - Google Docs</a></p>

<h2>CI サービス連携問題</h2>

<p>reviewdog は Pull Request hook と実行環境さえあれば対応できてオープンなCIサービスの場合はGitHubへコメントするための
API トークンを安全に環境変数などで保存する方法があれば対応できます．</p>

<p>travis や circle ci といったメジャーなCIサービスは両方対応していて，最初は全然このあたりは問題ではないなーと思ってたのですが，
実はOSS用のリポジトリに対して使おうとすると fork レポジトリからの pull-request では暗号化された環境変数は使えない!
という問題があって，これどうすかなぁーということにかなり悩まされました．
考えてみれば当たり前で，<code>echo $SECRET_VAR</code> とかした悪意あるPull Request が開かれたら簡単に漏れちゃいます．</p>

<p>そこで，いろいろ CI サービスを探ってると <a href="https://drone.io/">https://drone.io/</a> の OSS バージョン
<a href="https://github.com/drone/drone">https://github.com/drone/drone</a> を見つけました．</p>

<p>help (<a href="http://readme.drone.io/usage/secrets/">Secrets · Drone</a>) を読むと，
yaml ファイルのチェックサムとセクション分けによって(完璧ではないものの)安全に
秘密の環境変数をforkからのプルリクでも使えるようになっているようです．
完全に便利なので travis とか circle ci でもこの機能ほしい&hellip;</p>

<p>drone.io OSS バージョンは <a href="https://drone.io/">https://drone.io/</a> とは別物という感じで環境変数の扱い以外も
結構便利っぽく，drone.io も reviewdog はデフォルトでサポートしました．</p>

<p>ただ OSS で雑にGitHubに上げたサービスに対して使うケースでも drone.io
をどこかにホスティングしなくてはならないのが不便なところです&hellip;
個人的にはreviewdogのために Degital Ocean に月500円で drone.io 用サーバを立ててみて，
今の所かなり便利感ありますが，ワガママをOSS用にどっかホスティングしてほしい.</p>

<p>で，じゃあ結局forkからのPull Requestも受け付けるOSS用リポジトリにreviewdog導入
したい場合どうすればいいかというと，現状は Circle CI の <a href="https://circleci.com/docs/fork-pr-builds/#unsafe-fork-pr-builds">Building Pull Requests from forks - CircleCI</a>
機能をセキュリティリスクと引き換えに ON にするしかないかなーという感じです．</p>

<p>GitHub の Personal Access Token, しかも scope を適切に <code>public_repo</code> とかに設定しておけば，
もし漏れても大したことはできないはずだし，rebokeもできるし，fork して悪意あるPull Request 作られたら流石に気付くし，
まぁそもそもそんなこと GitHub の 権限すくないPersonal Access Token 得るためにやる人は
少ないのでは&hellip; という感じですね．ただ使う場合はもちろん自己責任でお願いします．</p>

<p>Circle CI か travis あたりが drone.io みたいに yaml のチェックサム+環境変数が使えるスコープを制限する機能がもし実装されたらそれを使っていきたい</p>

<p>(ところで他のCIサービスとして wrecker 試したんですが，fork からの pull-request で普通に秘密の環境変数使えてしまった気がする&hellip;問題では&hellip;あとPull Request hook によるビルドがなさそうだった)</p>

<h3>終わりに</h3>

<p>reviewdog 完全に便利という感じなのでぜひ使ってみてください〜</p>

<p>CI 用環境変数とか設定すれば Jenkins とかいろんな環境で導入できるはずだし，
一度導入したら撤退しずらいとかもないので，ギョームとかでも使えるような気がしますが
リリース直後なのでいろいろ変わるかも知れないしそのへんはよしなにお願いします．
GitHub Enterprise とか BitBucket 対応は気が向いたらするかもしれない．
特にGitHub Enterprise はGitHub 用の base の url 変えるだけで対応できる&hellip;?</p>

<p>ちょくちょく気になるところはあるのでちまちま改善していこうかなーと思います</p>
</div>
  
  


      <footer>
      
      - <a href="/reviewdog/">reviewdog を飼ってコードレビューや開発を改善しませんか</a>
      <time datetime="2016-10-24T07:44:34+09:00" pubdate><span class='month'>Oct</span> <span class='day'>24</span> <span class='year'>2016</span></time>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/hatena-pepabo-kyoto/">はてな・ペパボ技術大会〜インフラ技術基盤〜@京都 行ってきたメモ</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2016-07-02T20:06:46+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><h2>はてな・ペパボ技術大会〜インフラ技術基盤〜@京都 7/2</h2>

<p><a href="http://hatena.connpass.com/event/33521/">はてな・ペパボ技術大会〜インフラ技術基盤〜@京都 - connpass</a></p>

<p>行ってきました．メモってたのでせっかくなので共有しておきます．
gistでいいかとおもったけどスライド埋め込みとか考えたらブログに雑に投げたほうが見なおしやすそうと思ったのでブログで．
自分で発表したわけでもないし，感想とか書いてるわけでもないけどまぁいいかってカンジ．</p>

<h2>注意</h2>

<p>わかってない人が書いたメモなのでいろいろわかってないメモが書かれてます．
理解度に関係なく聞き漏らしたところ雑に書いたりしてるので発表様がおっしゃってた話とちがうところもあるかもしれない．
特に座談会の内容とかは Twitterのハッシュタグみてたら <a href="https://twitter.com/matsumotory">@matsumotory</a> さんと <a href="https://twitter.com/yumu19">@yumu19</a> さんがまとめてたのでそっち見たほうがわかりやすいかも．</p>

<h3>Togetter</h3>

<p><del><a href="http://togetter.com/li/994969">http://togetter.com/li/994969</a></del></p>

<p><del>ということで雑にtogetterつくっておきました．#pepabohatena で検索したやつからスパム2-3個消しただけです．
そういえばtogetterだめな人とかいるかもじゃん&hellip;!ということに気づいたんですが全員に連絡するの流石につらいのでダメなひと
<a href="https://twitter.com/haya14busa">@haya14busa</a> まで連絡していただければ幸いです．勝手に使って申し訳ないでした :bow: </del></p>

<p>記事書いてる間に @yumu19 さんが作ってた -> <a href="http://togetter.com/li/994986">はてな・ペパボ技術大会〜インフラ技術基盤〜@京都 #pepabohatena ツイートまとめ - Togetterまとめ</a></p>

<h3>タイムテーブル</h3>

<table>
<thead>
<tr>
<th>time </th>
<th> 名前 </th>
<th> タイトル </th>
<th> 時間</th>
</tr>
</thead>
<tbody>
<tr>
<td>13:30 </td>
<td>  </td>
<td> 受付開始・開場 </td>
<td> 30分</td>
</tr>
<tr>
<td>14:00 </td>
<td> y_uuki(はてな) </td>
<td> 開会宣言・会場説明 </td>
<td> 5分</td>
</tr>
<tr>
<td>14:05 </td>
<td> y_uuki(はてな) </td>
<td> はてなにおけるLinuxネットワークスタックの性能改善 </td>
<td> 25分</td>
</tr>
<tr>
<td>14:30 </td>
<td> matsumotory(ペパボ) </td>
<td> Webサービス基盤の自律制御と動的平衡性 </td>
<td> 25分</td>
</tr>
<tr>
<td>14:55 </td>
<td>  </td>
<td> 休憩 </td>
<td> 5分</td>
</tr>
<tr>
<td>15:00 </td>
<td> ichirin2501(はてな) </td>
<td> 計算量と僕とWeb開発 </td>
<td> 25分</td>
</tr>
<tr>
<td>15:25 </td>
<td> pyama(ペパボ) </td>
<td> STNS 〜点と線を結び新しい何かを作るコト〜 </td>
<td> 25分</td>
</tr>
<tr>
<td>15:50 </td>
<td>  </td>
<td> 休憩 </td>
<td> 5分</td>
</tr>
<tr>
<td>15:55 </td>
<td> masayoshi(はてな) </td>
<td> 負荷分散技術を選ぶ時に考えること </td>
<td> 25分</td>
</tr>
<tr>
<td>16:20 </td>
<td> monochromegane(ペパボ) </td>
<td> サービスに寄り添うログ基盤 - ログ収集のその先に - </td>
<td> 25分</td>
</tr>
<tr>
<td>16:45 </td>
<td>  </td>
<td> 休憩 </td>
<td> 10分</td>
</tr>
<tr>
<td>16:55 </td>
<td> masayoshi(はてな) taketo957(はてな) alotofwe(ペパボ) hanazuki(ペパボ) モデレータ stanaka(はてな) </td>
<td> 若手インフラ座談会 </td>
<td> 40分</td>
</tr>
<tr>
<td>17:35 </td>
<td>  </td>
<td> 懇親会 軽食と飲み物を用意しています！ </td>
<td></td>
</tr>
<tr>
<td>19:00 </td>
<td>  </td>
<td> お開き</td>
<td></td>
</tr>
</tbody>
</table>


<h2>開会宣言・会場説明</h2>

<p>14:00 | y_uuki(はてな) | 開会宣言・会場説明 | 5分</p>

<ul>
<li>発表6本+座談会</li>
<li>アンケート</li>
</ul>


<h2>はてなにおけるLinuxネットワークスタックの性能改善</h2>

<p>14:05 | y_uuki(はてな) | はてなにおけるLinuxネットワークスタックの性能改善 | 25分</p>

<p><a href="https://speakerdeck.com/yuukit/linux-network-performance-improvement-at-hatena">はてなにおけるLinuxネットワークスタックパフォーマンス改善 / Linux network performance improvement at hatena // Speaker Deck</a></p>

<script async class="speakerdeck-embed" data-id="1c0ab465dca74bc7b0f955cb6955ba8a" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>


<ul>
<li>はてなのウェブオペレーションエンジニア．新卒1年目の仕事</li>
<li>今は3年目</li>
<li>3層構成 LB <-> proxy <-> application <-> database</li>
<li>ボトルネックどこ?

<ul>
<li>CPU: %user/%sys/%iowait</li>
<li>Mem: used/cached/buffer</li>
<li>Disk: read/write</li>
<li>NW: tx/rx/tx</li>
</ul>
</li>
<li>ソフト割り込み(パケット受信)の負荷が高いときの話 (%soft)</li>
<li>ネットワークスタック

<ul>
<li>ネットワークi/oを実現するために必要な要素群．低レイヤより

<ul>
<li>NIC/パケット送受信/etc&hellip;</li>
</ul>
</li>
</ul>
</li>
<li>ネットワークI/O 高速化</li>
<li>パケット受信フロー  NIC -> Kernel -> Process

<ul>
<li>この辺の話かな? <a href="https://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/s-network-packet-reception.html">8.3. パケット受信の概要</a></li>
<li><img src="https://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/images/packet-reception.png" alt="" /></li>
<li>NIC: 物理デバイス</li>
<li><a href="https://ja.wikipedia.org/wiki/%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%AB%E3%83%BC%E3%83%89">ネットワークカード - Wikipedia</a></li>
<li>NIC ->(ハード割り込み) -> パケット受信 -> プロトコル処理 -> データ受信処理 -> Process</li>
<li>割り込み2種類ある．なぜか?</li>
<li>ハード割り込みだけだとパケット受信のたびにプロトコル処理まで実行しちゃう</li>
<li>なので一旦バッファにいれる．ソフト割り込み</li>
</ul>
</li>
<li>NAPI (New API)

<ul>
<li>1パケットずつでなく複数パケットごとに割り込み</li>
<li>ポーリングによってとってくる．待ち時間発生するので負荷が高い時だけやるみたいに賢くなってる</li>
<li>ソフト割り込みを減らす</li>
</ul>
</li>
<li>HAProxy の台数増問題 (実際に取り組んだやつ)</li>
<li>割り込みが多い -> 割り込み減らしたい</li>
<li>HAProxy のネットワーク負荷が高いのでHAProxyを DNS RR で並べた</li>
<li>Interrupt Coalescing

<ul>
<li>ハード割り込みを減らす</li>
</ul>
</li>
<li>NICドライバのパラメータ検証した</li>
<li>RPS (Receive Packet Steering)

<ul>
<li>コア間割り込み</li>
</ul>
</li>
<li>RPS でRedisチューニング

<ul>
<li>Redisは1スレッド</li>
<li>カーネルのネットワークI/O処理するスレッドと Redisのスレッドは分散可能</li>
<li>-> CPU% 10% 減 (コンテキストスイッチが減ったり，キャッシュが効くようになったからっぽい)</li>
<li>redisの公式ページにやりかた書いてある <a href="http://redis.io/topics/benchmarks">http://redis.io/topics/benchmarks</a></li>
</ul>
</li>
<li>ユーザランドへゼロコピー

<ul>
<li>そもそもカーネルに処理しないという変態処理．</li>
<li>パケットを NIC -> ユーザランドへバイパス</li>
<li>実装: netmap</li>
<li>まだ実用ではなさそうだけど研究されてる</li>
<li>ソケットAPIの限界

<ul>
<li>ソケットAPIではゼロコピーできない</li>
</ul>
</li>
</ul>
</li>
<li>まとめ

<ul>
<li>OSの内部面白い．OS内部の技術の外出し</li>
<li>ソフト割り込みにより遅延処理</li>
<li>ジョブキューのような非同期処理</li>
<li>割り込みとポーリング</li>
<li>OSの技術をもうちょっと上のレイヤの技術に応用してやったりするのベンリ</li>
</ul>
</li>
</ul>


<h2>Webサービス基盤の自律制御と動的平衡性</h2>

<p>14:30 | matsumotory(ペパボ) | Webサービス基盤の自律制御と動的平衡性 | 25分</p>

<script async class="speakerdeck-embed" data-id="60124a9e42bf4939b3d64687ef266d5c" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script>


<ul>
<li>@matsumotory <a href="http://research.matsumoto-r.jp/">松本亮介の研究・開発業績ページ by matsumoto-r</a></li>
<li>技術基盤チームで研究開発してる</li>
<li>目次

<ul>
<li>なめらかなシステム</li>
<li>Webサービスの現状・課題</li>
<li>自立制御</li>
<li>動的平衡性</li>
</ul>
</li>
<li>なめらかなシステム

<ul>
<li>システムにとってのユーザ，システムを構成するサーバ等の要素のカテゴリや特徴を詳細に認識する</li>
<li>人間の労苦は避けたい</li>
</ul>
</li>
<li>Webサービスの現状・課題

<ul>
<li>bad UI / 遅い / etc&hellip; -> 快適に利用できるのが当たり前</li>
<li>サーバの運用大変

<ul>
<li>高負荷・障害対応</li>
<li>問い合わせ</li>
<li>バジョンアップ</li>
<li>監視</li>
<li>新規構築</li>
</ul>
</li>
</ul>
</li>
<li>監視に注目してみる

<ul>
<li>閾値設定はムズカシイ</li>
<li>1時的な高負荷は無視したい．すぐもどるならok</li>
<li>傾向が変わるならすぐ知りたい</li>
<li>正常にみえるけど異常っぽいものを検知したい</li>
<li>段階的な傾向の変化を検知したい．階段みたいな．でも1時的なものは無視</li>
</ul>
</li>
<li>詳細な変化と原因を知るには人の目が必要．でも自動で制御したい

<ul>
<li>人は何をみてるか? 対象の振る舞いをみてる</li>
<li>振る舞いを表す特徴が知りたい!</li>
<li>人工知能でやれるか</li>
</ul>
</li>
<li>考え方

<ul>
<li>特徴がある</li>
<li>通常の状態を学習</li>
<li>外れた状態を解析</li>
<li>連速的に外れた状態が異常のはじまり</li>
</ul>
</li>
<li>各種基盤技術

<ul>
<li>[x] 設定をプログラム化</li>
<li>[x] リソース制御連携</li>
<li>[ ] 特徴量定義と解析 &lt;- ここ</li>
</ul>
</li>
<li>特徴量解析

<ul>
<li>変化点検出やクラスタリングなど研究はされている</li>
<li>mruby-changefinder <a href="https://github.com/matsumoto-r/mruby-changefinder">matsumoto-r/mruby-changefinder: ChangeFinder class detect change points via continuous outlier and smoothing.</a></li>
<li>複数データの関係性を得る</li>
</ul>
</li>
<li>Webサーバの自律制御

<ul>
<li>特徴量抽出による検知できる点の増加</li>
<li>閾値以下でも傾向変化の細かい検知ができる</li>
</ul>
</li>
<li>細かい傾向変化した時点でどうするか?

<ul>
<li>異常検知．誤検知もある．false positive/negative?</li>
<li>すぐ制限とかは影響でかい</li>
<li>なんかアクションはとりたい</li>
<li>システムとしてバランスを取りたい条件ある

<ul>
<li>マルチテナント環境とする．</li>
<li>リソースが逼迫してきたのみ制限かけたい．自動で制限したい．</li>
<li>グラフなめらかにしたい．</li>
</ul>
</li>
<li>e.g.

<ul>
<li>どのホストが変化点スコアが高い?</li>
<li>重み付け (優先順位つける) example.com:95, matsumoto-r.jp:93, &hellip;</li>
<li>傾向変化ごとに重みつけリスト更新</li>
<li>全リソースが逼迫 -> リストを元に自動制御</li>
<li>逼迫してないなら重みつけリストをつくるところだけしとく</li>
</ul>
</li>
<li>時系列データの生成

<ul>
<li>相関関係の時系列データも作れる</li>
<li>全体の負荷とホストの負荷どっちか</li>
</ul>
</li>
</ul>
</li>
<li>要素技術

<ul>
<li>機能拡張 mod_mruby</li>
<li>mruby-resource</li>
<li>mruby-changefineder</li>
<li>etc&hellip;</li>
</ul>
</li>
<li>制限の実装方法

<ul>
<li>リクエスト単位でCPU/IOなどの割当を変更</li>
<li>cgroup/rlimit</li>
<li>e.g. 特定のcgroupにリクエストをアタッチしてCPUを20%に制限する．レスポンス返したらデタッチ</li>
</ul>
</li>
<li>ミドルウェアが特徴量抽出解析・制限行いたい</li>
<li>webサービスの動的平衡性

<ul>
<li>生命とは? 動的平衡にある流れ</li>
<li><blockquote><p>動的平衡（どうてきへいこう、英語：dynamic equilibrium）とは、物理学・化学などにおいて、互いに逆向きの過程が同じ速度で進行することにより、系全体としては時間変化せず平衡に達している状態を言う。
&ndash; <cite><a href="https://ja.wikipedia.org/wiki/%E5%8B%95%E7%9A%84%E5%B9%B3%E8%A1%A1">動的平衡 - Wikipedia</a></p></blockquote></li>
<li><a href="https://ja.wikipedia.org/wiki/%E7%B4%B0%E8%83%9E%E5%91%A8%E6%9C%9F%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88">細胞周期チェックポイント - Wikipedia</a>

<ul>
<li>細胞: さーば</li>
<li>動的平衡: サーバの構築と破壊</li>
<li>Web サービス基盤を生命のように扱う

<ul>
<li>異常・エントロピー増大からは逃れられない</li>
<li>自分で自らを破壊・増殖・再構築していく</li>
<li>一つ一つの細胞の調子わるいな?とかは僕らだってみてない．1部変でも全体としては大丈夫．</li>
</ul>
</li>
<li>詳しくは: <a href="https://speakerdeck.com/matsumoto_r/namerakad-idea-design">なめらかなシステムのアイデアと設計概要 / namerakad-idea-design // Speaker Deck</a>
<script async class="speakerdeck-embed" data-id="51e39a56e84e4b79a957f653b8c941d0" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script></li>
</ul>
</li>
</ul>
</li>
<li>今後: STNS/haconiwa, &hellip;</li>
<li>Q&amp;A:

<ul>
<li>フォールトトレランスとの違い?

<ul>
<li>現時点はそこまで．循環するパターン．状態を持つサーバと持たないサーバがある．この辺とかの落とし所を考えてる</li>
</ul>
</li>
<li>from yuuki: Docckerとかで動的にスケールしてるけど，違うアプローチっぽい．どう違う? キューバネティスとか?

<ul>
<li>こちらはサーバを積極的に，自主的に落として循環していくといった部分が違う．元気なサーバでも任意の時間経過で落としたり．</li>
</ul>
</li>
<li>from astj: バースト．イベントやyahoo砲とかのバズり，が怖い．これを異常検知するのはむずくてなかなか考えても答えが出ない．自律制御のスピード超えてバースト来たらどうする?

<ul>
<li>全体的にはバーストに対応したい．落とす条件．3時間で落ちそうなやつが1.5時間で落ちたなら1つではく2つのVMを再構築するといった方法あるかも．落としたときに条件によって10倍再構築するとか．</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>netflix とかも似たようなことやってる感じらしい?</p>

<p>mackerel で出来たりしたら最高だな〜と思った．</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="ja" dir="ltr">なめらかなシステムのシミュレーションはこれを見るとわかりやすいです <a href="https://t.co/PK3jn4cJvi">https://t.co/PK3jn4cJvi</a> <a href="https://twitter.com/hashtag/pepabohatena?src=hash">#pepabohatena</a></p>&mdash; 松本 亮介 / まつもとりー (@matsumotory) <a href="https://twitter.com/matsumotory/status/749135118095163394">July 2, 2016</a></blockquote>


<h2>計算量と僕とWeb開発</h2>

<p>15:00 | ichirin2501(はてな) | 計算量と僕とWeb開発 | 25分</p>

<ul>
<li>@ichirin2501 いちりんちゃんさん

<ul>
<li>アプリケーションエンジニア2年 ->(転職) web オペレーションエンジニア1年(hatena)</li>
<li>スピリチュアルな発表!</li>
</ul>
</li>
<li>もくじ

<ul>
<li>計算量について</li>
<li>mysql クエリ改善</li>
</ul>
</li>
<li>計算量とは?

<ul>
<li>大変さの指標．</li>
<li>係数無視 O(3n<sup>3</sup>) -> O(n<sup>3</sup>)</li>
<li>でかいやつだけ O(n<sup>3</sup> + n<sup>2</sup>) -> O(n<sup>3</sup>)</li>
</ul>
</li>
<li>計算量といちりんちゃん

<ul>
<li>競プロで向き合う．</li>
<li>計算量と時間の基準・感覚がある</li>
<li>O(10<sup>7</sup>) ~ O(10<sup>9</sup>) 0 -> 1s くらいじゃん?みたいな感じ</li>
<li>データサイズからの見積もり

<ul>
<li>1sec デッドラインの見積もりならこんな感じやろ的な．</li>
<li>n &lt;= 10<sup>6</sup> -> O(n)</li>
<li>n &lt;= 10<sup>5</sup> -> O(nlogn)</li>
<li>n &lt;= 3000 -> O(n<sup>2</sup>)</li>
<li>n &lt;= 100 -> O(n<sup>3</sup>)</li>
<li>n &lt;= 20 -> O(2<sup>n</sup>)</li>
</ul>
</li>
</ul>
</li>
<li>MySQL 改善のはなし

<ul>
<li>group by / distinct の迷い．どっちでも重複除外できるので実現可．

<ul>
<li>follow/followerテーブル的なものを想定</li>
<li>friend_id 重複なしで 1000件ほしい</li>
<li>結果を言うと group by だと遅いケースがあった</li>
<li>group_by で OR句のuser_idが多いと異常におそくなった</li>
<li>どう計算してるか知ればいいじゃん</li>
</ul>
</li>
<li>インデックス構造

<ul>
<li>インデックス B+tree</li>
<li>主キーのインデックス clustered index</li>
<li>主キー以外のインデックス secondary index (主キーがこれでわかる)</li>
<li>B+tree はleafが連結リスト．rangeで検索とかのときにベンリ</li>
<li>例とか．この辺発表の図をみるとわかりやすくてベンリ</li>
</ul>
</li>
<li>話をもどしてfriend_id. なぜ遅いのか?

<ul>
<li>オーダーが違うかも</li>
<li>意図してないインデックスで検索してるかも -> オーダー線形なってるかも</li>
</ul>
</li>
<li>結論そうだった

<ul>
<li>explainするとわかる</li>
<li>オプティマイザが間違った判断してた(あるある．経験則). distinct だと解決した</li>
<li>経験則やexplain使わなくても計算量と時間の感覚でどこがまずそうかわかることもあるよ!

<ul>
<li>ミドルウェアのどのへんが悪いかとか計算量の感覚やインデックスの使われ方を理解して推測したり出来るとベンリ</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Redis の話

<ul>
<li>redis とか

<ul>
<li>kvs nosql(ほかにもグラフデータベースとかあるよねー)</li>
<li>list/set/sorted sets(rankingの実装らくとか)/etc .. データ構造いっぱいあってベンリ</li>
<li>メモリ最適化 2.2 から入ってる．勝手に圧縮してもらえる

<ul>
<li>-> パラメータ眺めてオーダーとか変わったりするのでは?と推測</li>
</ul>
</li>
</ul>
</li>
<li>怪しいのでパラメータ変えて実際試す

<ul>
<li>データ数と実行時間からオーダーわかる</li>
<li>データ数10kで1 sec超えるのオカシイのではと気づく．</li>
</ul>
</li>
<li>やっぱり -> データ構造違ってた

<ul>
<li>ドキュメントに実は書かれてたりも．</li>
</ul>
</li>
</ul>
</li>
<li>まとめ

<ul>
<li>知識だけじゃなく感覚を身に着けてるとすぐわかったりしてベンリ．現場で検証しまくるとかできなかたったりするし．</li>
<li>まつもとりーさんも言ってたが快適にウェブサービス使えるのは当たり前だし，この辺にコミットするために計算量ベンリ</li>
</ul>
</li>
<li>Q&amp;A

<ul>
<li>from yuuki: このへんミスったりすると自律制御したりしても一瞬でリソース食いつぶしたりするし，このへん自律制御するのどうするかとかもおもしろそう</li>
</ul>
</li>
</ul>


<p>べんり <a href="http://gigamaker.jimdo.com/">ホーム - 鳥獣戯画制作キット</a></p>

<p>計算量の感覚大事．</p>

<h2>STNS 〜点と線を結び新しい何かを作るコト〜</h2>

<p>15:25 | pyama(ペパボ) | STNS 〜点と線を結び新しい何かを作るコト〜 | 25分</p>

<ul>
<li>やましたさん． @pyama86

<ul>
<li>ムームードメインやってる</li>
</ul>
</li>
<li>Linux のユーザ管理

<ul>
<li>いつから LDAP 主流だと錯覚してい(ry</li>
</ul>
</li>
<li>最近のユーザ管理

<ul>
<li>root おおい．</li>
</ul>
</li>
<li>rootは問題あるよね

<ul>
<li>セキュリティ事故の追跡</li>
<li>sudo権限の分離</li>
<li>userの追加削除管理困難．追加でポリシーのため他のサーバにも足す&hellip;とかやるとこまる．</li>
<li>rootはアブナイ!!!</li>
</ul>
</li>
<li>でもなぜやってしまうか

<ul>
<li>なにかあったときしか困らない</li>
<li>まぁLDAP構築たいへんだよねとかある．</li>
</ul>
</li>
<li>STNS で解決!

<ul>
<li><a href="https://github.com/STNS/STNS">STNS/STNS: Simple Toml Name Service</a></li>
<li>名前解決/公開鍵取得/アカウント認証のみを提供．LDAPはいろいろできすぎて困る．</li>
<li>ls -ltr の名前は実はid. pyama -> id:1000 ．これが名前解決</li>
</ul>
</li>
<li>デプロイユーザの管理できる

<ul>
<li>capistorano とか公開鍵たしてsshでやるよね．authorized_keys 管理だるくなるよね．</li>
<li>stnsだとスッキリ!誰がdeployできるか一目瞭然でよい．</li>
</ul>
</li>
<li>組織構造を表現できる

<ul>
<li>group</li>
</ul>
</li>
<li>シュッとインストールできるよ! 2.5min</li>
<li>事例

<ul>
<li>pepaboさん事例．ユーザ管理もgithub flowで. ghe でpr -> droneでテスト &amp; レビュー -> deploy</li>
<li>承認してマネージャーが承認して&hellip;とかめんどくてそれ解決できてベンリ．エンジニアで管理</li>
<li>ghe で全部管理できるので入退社管理とかも楽</li>
</ul>
</li>
<li>プロダクトを運用すること

<ul>
<li>ヒントとなった技術からアイデア得たり</li>
<li>mackerelのtomlとかgo使ってるやつ参考にしたり</li>
<li>linuxで利用可能な共通ライブラリがgo1.5から作れるようになってこれがでかい．Cを書かなくてもLinuxのシステムに手を入れられる</li>
<li>自分が開発者だし自分がSTNSを最高にできる!!!</li>
</ul>
</li>
</ul>


<p>LDAP とかユーザ管理あんまり関わってないけど便利そうだった．良い話きけて良い．</p>

<ul>
<li>Q&amp;A:

<ul>
<li>from yuuki: hatena は LDAP だけどSTNSよさそう!</li>
</ul>
</li>
</ul>


<h2>負荷分散技術を選ぶ時に考えること</h2>

<p>15:55 | masayoshi(はてな) | 負荷分散技術を選ぶ時に考えること | 25分</p>

<p><a href="https://speakerdeck.com/masayoshi/fu-he-fen-san-ji-shu-woxuan-butokinikao-erukoto-1">負荷分散技術を選ぶときに考えること // Speaker Deck</a></p>

<script async class="speakerdeck-embed" data-id="4069267887dd401c93e8fe6b1de08f34" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>


<ul>
<li>masayoshi @yoyogidesaiz

<ul>
<li>新卒．めでたい．</li>
<li>SDN(Software-Defined Networking) 大学でやってた <a href="http://e-words.jp/w/SDN.html">SDNとは｜Software-Defined Networking - 意味/定義 ： IT用語辞典</a></li>
</ul>
</li>
<li>負荷分散技術の概要

<ul>
<li>データセンター分散したり</li>
<li>ロードバランサーでbackend web分散したり</li>
<li>サーバ内/ロールごと/サーバごと のだいたい3つの分散ある</li>
</ul>
</li>
<li>サーバ内リソースの負荷分散

<ul>
<li>ハードウェア機能: hyper-threading, raid0</li>
<li>ハードウェア意識のOSの負荷分散: numa, rss/rfs/rps</li>
<li>OS意識のアプリケーションの作り方: fork()/clone() などのシステムコール</li>
<li>Numa <a href="https://ja.wikipedia.org/wiki/NUMA">NUMA - Wikipedia</a>

<ul>
<li><blockquote><p>NUMA（Non-Uniform Memory Access、ヌマ）とは、共有メモリ型マルチプロセッサコンピュータシステムのアーキテクチャのひとつで、複数プロセッサが共有するメインメモリへのアクセスコストが、メモリ領域とプロセッサに依存して均一でないアーキテクチャである
&ndash; <cite><a href="https://ja.wikipedia.org/wiki/NUMA">NUMA - Wikipedia</a></p></blockquote></li>
</ul>
</li>
<li>application

<ul>
<li>fork() プロセス</li>
<li>clone() スレッド</li>
<li>select() プロセス &lt;- x (io多重化とかに影響するだけでCPUには影響しない?)</li>
<li>このへんいろいろ理解してアプリケーションコードかく! (なるほど)</li>
</ul>
</li>
</ul>
</li>
<li>ロールごとの分散

<ul>
<li>proxy/web/db などのロールの分散</li>
<li>proxyでキャッシュしたり，全部のリクエストがdbまで到達しないようにとか</li>
<li>キャッシュ

<ul>
<li>ユーザに近いところで返す</li>
<li>キャッシュヒットしなくて破綻とか実装に無理があったりとかもする．</li>
<li>-> 使いどころを見極める．キャッシュは麻薬</li>
</ul>
</li>
</ul>
</li>
<li>サーバごとの負荷分散

<ul>
<li>この辺がインフラエンジニアに特にやりがいあったり</li>
<li>拠点ごとに分散．</li>
<li>load balancerでパケットを分散</li>
<li>負荷分散技術を実現するために分散システムの考え方を参考にしたり</li>
<li>透過性: <a href="https://ja.wikipedia.org/wiki/%E9%80%8F%E9%81%8E%E6%80%A7_(%E6%83%85%E5%A0%B1%E5%B7%A5%E5%AD%A6">透過性 (情報工学) - Wikipedia</a>)</li>
<li>DNSラウンドロビン

<ul>
<li>位置透過性を実現</li>
</ul>
</li>
<li>ロードバランサ

<ul>
<li>位置透過性実現</li>
<li>ヘルスチェックできる</li>
<li>でもネットワークの制限受けたり</li>
</ul>
</li>
<li>Proxy

<ul>
<li>haproxy/nginxなど</li>
<li>ヘルスチェックできるし位置透過性も高い</li>
</ul>
</li>
<li>分散先ノードのヘルスチェック

<ul>
<li>監視: how?</li>
<li>異常(どんな?)のあるノードを削除</li>
</ul>
</li>
<li>ヘルスチェックむずい．

<ul>
<li>OK返してるの本当ok? 中身見たら実はngとか</li>
<li>ビザンチン将軍問題．<a href="https://ja.wikipedia.org/wiki/%E3%83%93%E3%82%B6%E3%83%B3%E3%83%81%E3%83%B3%E5%B0%86%E8%BB%8D%E5%95%8F%E9%A1%8C">ビザンチン将軍問題 - Wikipedia</a></li>
<li>Gossip protocol <a href="http://www.slideshare.net/winebarrel/ss-10433600">ゴシッププロトコルによる冗長化と負荷分散の検証</a></li>
<li><a href="http://qiita.com/hshimo/items/b7c0e0f12b7363e2e333">分散型コンセンサス・アルゴリズム プロトコル まとめ - Qiita</a></li>
</ul>
</li>
<li>ロードバランサの耐障害性

<ul>
<li>冗長化技術であって負荷分散技術ではない</li>
</ul>
</li>
</ul>
</li>
<li>まとめ

<ul>
<li>負荷分散の仕方まとめ</li>
<li>必要以上に複雑にしない．コスト増とかもある．simple is best</li>
<li>本当に必要なのか最高する</li>
<li>オープンソースカンファレンスはてなでブースだす． <a href="http://www.ospn.jp/osc2016-kyoto/">オープンソースカンファレンス2016 Kyoto - オープンソースの文化祭！</a></li>
</ul>
</li>
<li>Q&amp;A

<ul>
<li>どこが負荷おおいか?

<ul>
<li>disk がおおい．dbとか．ロールごとに分けておいてキャッシュ聞かせていく戦略おおい．(計算機の仕組み的にdiskがおそい from yuuki)．最近iodriveとかあって速くなってきてるのでスケールアップが多い．</li>
</ul>
</li>
</ul>
</li>
</ul>


<h2>サービスに寄り添うログ基盤 - ログ収集のその先に -</h2>

<p>16:20 | monochromegane(ペパボ) | サービスに寄り添うログ基盤 - ログ収集のその先に - | 25分</p>

<p><a href="https://speakerdeck.com/monochromegane/pepabo-log-infrastructure-bigfoot">サービスに寄り添うログ基盤/pepabo_log_infrastructure_bigfoot // Speaker Deck</a></p>

<script async class="speakerdeck-embed" data-id="5afe99df3d13476d8fd631d22d83d393" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script>


<ul>
<li>monochromegane

<ul>
<li>minne</li>
<li>普段 rails 書いてる．最近ログ基盤の開発してる．</li>
</ul>
</li>
<li>ログはいいぞ!

<ul>
<li>ログはウェブサービスにおいて重要</li>
</ul>
</li>
<li>行動ログ

<ul>
<li>アプリケーション層で出力するログ(apacheのログとかではない)</li>
<li>いつ，だれが，なにをやったか特定できる</li>
<li>最終結果だけでなく，どこであきらめたか．どう迷ったかが分かる

<ul>
<li><blockquote><p>特にどこであきらめたか．どう迷ったかが分かるところにサービス改善のヒントが詰まってる!!!</p></blockquote></li>
</ul>
</li>
</ul>
</li>
<li>行動ログ活用段階

<ul>
<li>収集: とりあとめる</li>
<li>分析: 視覚化したり分析</li>
<li>活用: 分析結果を使って継続的なサービス改善</li>
<li>&ldquo;ログの活用&rdquo;

<ul>
<li>ログがたまるだけとか，グラフでてバンザイ！するだけではだめ!!</li>
</ul>
</li>
<li>-> ログの<strong>活用</strong>基盤をつくる!</li>
</ul>
</li>
<li>Bigfoot

<ul>
<li>ペパボの次世代ログ<strong>活用</strong>基盤</li>
<li>minnneのそれでもある．</li>
<li>UID 振る．アプリでログを吐いて集約基盤へ -> 分析 -> サービス改善など活用</li>
</ul>
</li>
<li>Bigfoot を支える技術

<ul>
<li>ログを送る

<ul>
<li>fluentd rack-bigfoot(rails) OSS的な感じではなさそうか&hellip;?</li>
</ul>
</li>
<li>集約基盤 Treasure Data

<ul>
<li>活用に力入れたかったので集約基盤はとりあえずTDに任せた．あとで自社のものにするかも</li>
<li>Hive QL. 行動ログをSQLライクに扱える</li>
</ul>
</li>
<li>ワークフロー

<ul>
<li>tdのスケジュールクエリを利用．これはwebのコンソールからorAPI.APIだと個々人が勝手にいろいろできたりしてこまる</li>
<li>-> クエリのコード管理にpendulum <a href="http://blog.monochromegane.com/blog/2016/03/21/pendulum/">Treasure Dataのスケジュールジョブをコードで管理するPendulumというgemをつくった · THINKING MEGANE</a></li>
<li>コードレビューとか管理できてよい</li>
<li>digdag というtd社公式のものがあるので移行中 <a href="https://github.com/treasure-data/digdag">treasure-data/digdag: Workload Automation System</a></li>
</ul>
</li>
<li>属性情報

<ul>
<li>行動ログのidから性別などなど属性情報を組み合わせると分析の幅が広がる</li>
</ul>
</li>
<li>名寄せ

<ul>
<li>サービスのアカウントと各クライアントをマッピング</li>
<li>未ログイン状態のアカウントも名寄せ後に過去に遡って紐付け</li>
<li>cookie syncと組み合わせてサービス間の紐付け</li>
</ul>
</li>
<li>Big Cube とCube

<ul>
<li>BigCube: 全サービスの行動ログを集約してる</li>
<li>切り口が確定したらCubeに切り出す(cubeに切り出されるとpostgresに入るので速く集計できたりする)</li>
</ul>
</li>
<li>視覚化と分析

<ul>
<li>pivot tableのすごいやつ． Tableau社のTableau Desktopを使う <a href="http://www.tableau.com/ja-jp/products/desktop">Tableau Desktop | Tableau Software</a></li>
<li>データソースとしてtdつかえる</li>
</ul>
</li>
<li>活用

<ul>
<li>画面デザインの変更．ステップ見直し</li>
<li>A/Bテスト</li>
<li>-> 静的なフィードバック．人が判断．固定化する．</li>
</ul>
</li>
<li>動的なフィードバックがよいのでは?

<ul>
<li>システムが行動ログを吐く -> 変換したものをシステムが受け取る -> 挙動を変える</li>
<li>バンディットアルゴリズム

<ul>
<li>いまやってみてる．</li>
<li>A/Bテストの機会損失減らしてる．</li>
<li><a href="https://www.oreilly.co.jp/books/9784873116273/">O&#8217;Reilly Japan - バンディットアルゴリズムによる最適化手法</a></li>
<li>強欲な感じで期間内の最良の手法を探す．最大はそれにbetする(活用)が他のものにもbet(探求)．</li>
</ul>
</li>
<li>リコメンド

<ul>
<li>matrix factorization</li>
<li>強調フィルタリングの一種</li>
<li>tdのなんかでできるらしい?</li>
</ul>
</li>
</ul>
</li>
<li>browse,card abondonment</li>
</ul>
</li>
<li>サービスに寄り添うログ基盤

<ul>
<li>単に集めるだけじゃなくて分析，活用の段階を補助する</li>
<li>静的フィードバックから動的フィードバックへ</li>
<li>行動ログの循環によって<strong>なめらかな世界</strong>へ．ということでログはいいぞ</li>
</ul>
</li>
<li>Q&amp;A

<ul>
<li>Q「送る側のサービスからログ基盤への負荷の問題はどうか」A「fluentdがよく出来ているから問題ない」 <a href="https://twitter.com/matsumotory/status/749151437850980352">https://twitter.com/matsumotory/status/749151437850980352</a></li>
<li>Q「fluentd自体の負荷はどうか」A「ない、今の設計規模では大丈夫」もともとfluentd自体はつかってて大丈夫ならしい</li>
<li>td負荷? ログを送りつけるぶんには負荷は気にしなくて良い．送ったあとにインデックス使わずに集計したりするとまずい．プランやすかったりすると特に．</li>
</ul>
</li>
</ul>


<blockquote class="twitter-tweet" data-lang="en"><p lang="ja" dir="ltr">これ、みやけさんほぼ一人でやってたからやばすごなんですよ… <a href="https://twitter.com/hashtag/pepabohatena?src=hash">#pepabohatena</a></p>&mdash; 松本 亮介 / まつもとりー (@matsumotory) <a href="https://twitter.com/matsumotory/status/749146241422860288">July 2, 2016</a></blockquote>


<p>まじか&hellip;</p>

<p>活用を重要視していてよさそう．おもしろい話だった．</p>

<p>「ログはいいぞ」．</p>

<h2>若手インフラ座談会</h2>

<p>16:55 | masayoshi(はてな) taketo957(はてな) alotofwe(ペパボ) hanazuki(ペパボ) モデレータ stanaka(はてな) | 若手インフラ座談会 | 40分</p>

<ul>
<li>新卒1,2年目の人達で座談会．stanakaさん仕切ってる</li>
<li>自己紹介

<ul>
<li>taketo957: hatena. 新卒．インフラしてる． <a href="https://twitter.com/taketo957">taketo957 (@taketo957) | Twitter</a></li>
<li>masayoshi: hatena. 新卒．さっき発表した <a href="https://twitter.com/yoyogidesaiz">まさよし (@yoyogidesaiz) | Twitter</a></li>
<li>hanazuki: pepabo. 大学京都．インフラしてる．渋谷．去年入社 <a href="https://github.com/hanazuki">hanazuki (Kasumi Hanazuki)</a></li>
<li>alotofwe: pepabo. 読み方:すずぴー．ねっとではれいか??? 去年入社．競プロ学生からやってる <a href="https://twitter.com/alotofwe">玲香@健康 (@alotofwe) | Twitter</a></li>
</ul>
</li>
<li>なんでインフラ?

<ul>
<li>masayoshi: ネットワーク系の研究してたり．かっこいいじゃん?</li>
<li>hanazuki: KMC入ってた．サーバーいじったりするの楽しかった．</li>
<li>taketo957: B3くらいでRailsやってたらブラックボックスおおくていろいろ調べてた．京都ならはてなでインフラできそうということでアルバイトしてisuconしたりなどなど．面白くてそういう形式で入社した．</li>
<li>alotofwe: 大学時代はそんなにインフラしてたわけじゃなかった．アプリは書いていたけど，やっていてアプリはもういいやという感じになった．インフラorセキュリティやろうとおもって，セキュリティ志望だけどセキュリティするためにはインフラ知らなきゃだめなので今インフラやってる

<ul>
<li><ol type="a">
<li>せきゅりてぃ専門のひとpepaboにいる?</li>
</ol>
</li>
<li><ol type="a">
<li>ちょっといる．matsumotoryさんとかも?</li>
</ol>
</li>
<li>はてなではセキュリティ専門はいない．みんなでやる．</li>
</ul>
</li>
</ul>
</li>
<li>アプリとインフラの境界? たとえばDBへのクエリ，スキーマあたりの責任や分担とかどう?

<ul>
<li>masayoshi: 監視業務のアルバイトしてその時はじめてインフラやった．そのときはコード書いてる人はいなかった．DBの設計まではしないけど性能のチェック，クエリのパフォーマンスチェックなどはしてた．はてなでは? -> だいたい一緒．</li>
<li>taketo957: 入社以前はもっとハッキリした境界あると思ってたけど，入ってみたらアプリ側が一緒にやってくれたりとか．インフラはmiddle wareより下はだいたいみてる．</li>
<li>hanazuki: パフォーマンスチューニングとかが境界．どっちからもみる．上からみるか下からみるかって感じ．境界がハッキリはしてない．</li>
<li>alotofwe: だいたいhanazukiさんと同じ．開発のひとからpull-reqが飛んできてレビューするとかまであるくらい境界は曖昧．ある程度権限はあるけどソレ以外はほとんど境界はない．</li>
</ul>
</li>
<li>インフラエンジニアになって1-2年，おもしろかったことや印象的なエピソードとかある?

<ul>
<li>masayoshi: はてなはオンプレ環境ある．ネットワーク機器をみてエラーパケットとかみたりした．そこで傾向とかがみれて面白い</li>
<li>hanazuki: プライベートクラウド使ってる．チョット前まではオンプレ．仮想環境を使う側．awsを使うのとは違ってどう動かすかとかツールとか作っていく．この辺が楽しい</li>
<li>taketo957: いろいろわかってきて嬉しい!</li>
<li>alotofwe: 推理小説がスキ．障害の何が原因か調べるのが探偵の推理っぽくて楽しい．</li>
</ul>
</li>
<li>研修でよかったこと

<ul>
<li>taketo957: 今年からインフラでも新卒研修．知識編と設計編．設計編がおもしろかった．実際に動いてるサービスにたいしてこのくらいのリクエストならどう設計するか．身になる部分でよかった．</li>
<li>hanazuki: 1ヶ月間くらい研修ある．内容自体はだいたい知ってたりもしたけど試行錯誤がおもしろかった．</li>
<li>alotofwe: 今年は研修作る側．内容: railsつくって運用基盤つくってmobileつくる．最低限の生き延びるための知識を得るようなもの．インフラのものはあまり知らなかったので特に勉強になった．</li>
<li>masayoshi: 全部taketoくんに言われた! ミドルウェアの組み合わせだけじゃなくて構築するとかコードを書いて作ってみるとどこがボトルネックになるのかとかわかったりする．作ったり構築・コード書くのも研修でやるとその辺に気づけて勉強になるのでベンリ．</li>
</ul>
</li>
<li>hatena は京都と東京．pepaboは福岡と東京にある．2拠点でやってることに関して感じることとか?

<ul>
<li>taketo957: 自分がやった話ではない．東京とのコミュニケーションコストを下げる．提示前15minのslack call雑談とかやってる．(yuukiさんが導入した)</li>
<li>masayoshi: taketoさんの続きってかんじ．今すぐ，まだまとまってないけど考えを話し合い，そういうときに音声チャットあってすぐに話せる環境があるとよい．ちょっと話したいけどいいですか?って聞いたらすぐ聞けるという環境が大事でベンリ．</li>
<li>taketo957: 補足．はてなは社内の文化的にこんなことも残すのか．というところまで残す．音声もベンリだけどチャットなどのテキストで何でも残すというところもよい．</li>
<li>hanazuki: みてるサービスが違うのでそこまでコミュニケーションをする必要はそもそもない．週1でビデオコールとかしてる．コミュニケーションとりたいけど取れないときもあるのでなんとかしたい．</li>
<li>alotofwe: slackべんり．アイコンが顔写真でよい．</li>
<li>masayoshi: アイコンもよいよね!</li>
<li>どうしても落ちがちな情報．手元で詰まってるけど大変とかいう情報とか．</li>
</ul>
</li>
<li>ロールモデル．将来どうなりたいとか．社内社外問わず目標としてる人とかいるか?

<ul>
<li>masayoshi: 具体的な人物とかはあんまりない．エンジニアとアカデミック系では本来あんまり境界はない．インフラのパフォーマンスチューニングとかは個人の技術という側面がおおいので体系化して学術分野にも広めたりアウトプットしたい．</li>
<li>taketo957: 入社したときはyuukiさんにあこがれてといった．ネットワーク周り喋ってるひとがおおい．アプリ観点から観てるひとはあんまりすくなさそう．研究室でやってきた人力でやる仕組みとか応用したりしていきたい．(クラウドソーシング?)</li>
<li>hanazuki: あんまり決まってない．人力の認知力でやったりするのはうっかりとかが発生して困るのでつらい．半分寝てても仕事できるようにしたい</li>
<li>alotofwe: よくばりさんなので側面によって尊敬してる人が異なる．つまみ食いしていきたい．食べてる最中なのであんまり決まってない．</li>
</ul>
</li>
<li>インフラエンジニアの醍醐味?．会社のいいところは?

<ul>
<li>taketo957: レイヤーが下がるにつれて相手にするものが多くなる．それにつれて自分の知識も増やす必要がある．いろんな知識を裏側まで見通してやっていったりするのは面白い．会社のよいところ．新しい技術・古い技術と幅がでていてよい．</li>
<li>masayoshi: 基盤をつくるのが面白い．大規模なものを支えるところが面白い．裏方だけど支えがないと動かない．このアラート放置していいんすか?とか聞くと先輩とかが話してくれて一緒に解決してくれたり．</li>
<li>hanazuki: インフラといってもハードウェアみたりチューニングしたりなどいろいろな分野・仕事がある．いろいろできるのよい．それぞれスキなレイヤで改善できるところとかよい．</li>
<li>alotofwe: アプリと比較．アプリ開発だと適当に書いても動いちゃう．インフラだと1行追加すると大きい影響があってじっくり考慮してかかなきゃだめだったりする．向上心強い人がおおい．よくしていきたいという気持ち．勉強しやすい会社．</li>
</ul>
</li>
</ul>


<h2>僕の(雑)まとめ感想とか</h2>

<p>インフラ系のことはほとんどできていなくて，知識も全然ないけど，どんな感じでやってるのかなぁと興味はあったので参加しました．
アプリケーション書くときもインフラ意識して書くとよかったりするのでインフラエンジニアとかウェブオペレーションエンジニアみたいな職種につかなくても知っておくと便利．
実際座談会の話では，はてなさんでもペパボさんでもアプリケーションエンジニアとインフラエンジニアの仕事の境界とかは曖昧で，上から見るか下から見るかの違い程度しかないみたいな話をしてた気がする．
僕も，もっとインフラ意識しながら開発していきたいなーという気持ち高まった．</p>

<p>ネットワーク周りだとシステムコールとかいろいろ正直よくわからんくて前提知識僕が持ってないんだなーという話は多かったけど，
わかんない話でもおもしろいなーと得られる部分あったり，割とまだ分かる話(相対的に)でも知らないことがたくさん学べたり，なるほどなーとかそうだよなーよいよい!という話ばかりで
どの発表もよくて来てよかった．</p>

<p>運営・発表者の皆さんありがとうございました．</p>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

</div>
  
  


      <footer>
      
      - <a href="/hatena-pepabo-kyoto/">はてな・ペパボ技術大会〜インフラ技術基盤〜@京都 行ってきたメモ</a>
      <time datetime="2016-07-02T20:06:46+09:00" pubdate><span class='month'>Jul</span> <span class='day'>02</span> <span class='year'>2016</span></time>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/amazon-kindle-sale-til-2016-06-02/">6/2までKindle本50%オフセール!IT系の本で僕が欲しい本をまとめた!!!</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2016-05-30T22:41:43+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><p>2016年5月27日(金)00時00分～2016年6月2日(木)23時59分(日本時間)まで
<a href="http://www.amazon.co.jp/b/ref=s9_acss_bw_hsb_x_s1_s?_encoding=UTF8&amp;ie=UTF8&amp;node=4465565051&amp;pf_rd_m=AN1VRQENFRJN5&amp;pf_rd_s=merchandised-search-2&amp;pf_rd_r=1FY1PHQK4QC1KVKMZR6D&amp;pf_rd_t=101&amp;pf_rd_p=322009209&amp;pf_rd_i=2275256051">Kindle 50%OFF セール</a>
をやっているらしく，コンピュータ・IT系の本で僕が欲しい!!!よさそう!!!と思った本をまとめました．</p>

<p>先日 <a href="http://www.amazon.co.jp/gp/product/B00QJDQM9U/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=B00QJDQM9U&linkCode=as2&tag=haya14busa-22">Kindle Paperwhite Wi-Fi</a> を買った勢としてはこのKindle セールに乗るしかない!!!
積んでいた Soft skills の原著をKindle paperwhite で最近読んでますが，paperwhite かなり読みやすくて感動してます． いくつか固定レイアウト型の本がセールになってて， paperwhite で読むのはそこまでよさそうでもないけどそんなことは気にしない．</p>

<p>なおまとめてみると全部ポイント還元ではなく50%OFFセール本でした． 基本的にここから集めました． <a href="http://www.amazon.co.jp/gp/search/ref=sr_pg_1?rh=n%3A2250738051%2Cn%3A%212275265051%2Cn%3A%212275277051%2Cn%3A4469648051%2Cn%3A2275256051%2Cn%3A2291657051&amp;bbn=4469648051&amp;ie=UTF8&amp;qid=1464614758&amp;lo=digital-text">Amazon.co.jp: コンピュータ・IT - Kindle本: Kindleストア</a></p>

<h2>かなり欲しい!!!というか多分買う本</h2>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00CY9256C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/41oruV%2BaJIL._SL160_.jpg" alt="プログラミングコンテストチャレンジブック [第2版]　～問題解決のアルゴリズム活用力とコーディングテクニックを鍛える～" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00CY9256C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">プログラミングコンテストチャレンジブック [第2版]　～問題解決のアルゴリズム活用力とコーディングテクニックを鍛える～</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2012-01-28)<br />売り上げランキング: 1,619<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00CY9256C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>昔，図書館で借りてたけど途中で返しちゃった．プロコンでオススメの本といえば蟻本が必ず上がるし欲しい! プロコン最近やってないけど時間とってやりたい&hellip;</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B017X3D3GE/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51OBAUr%2BcpL._SL160_.jpg" alt="セキュリティコンテストチャレンジブック　CTFで学ぼう！情報を守るための戦い方" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B017X3D3GE/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">セキュリティコンテストチャレンジブック　CTFで学ぼう！情報を守るための戦い方</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2015-09-30)<br />売り上げランキング: 553<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B017X3D3GE/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>(途中までしか読めてないけど)蟻本よかったしセキュリティコンテスト版もよいでしょ．という気持ち．CTFどんなもんか気になる．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HR19TSO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/416JLYmhVvL._SL160_.jpg" alt="世界で闘うプログラミング力を鍛える150問　トップIT企業のプログラマになるための本" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HR19TSO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">世界で闘うプログラミング力を鍛える150問　トップIT企業のプログラマになるための本</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2012-11-13)<br />売り上げランキング: 476<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HR19TSO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>去年インターンの面接の対策として物理本を借りて読んだ．コーディング面接&hellip;?なにそれ&hellip;?という状態の自分にとってめっちゃよかった．読んだことあるけど手元にKindle本としてあってもよいかも．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00MN5AO7E/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51TtVaDHjeL._SL160_.jpg" alt="世界で闘うプロダクトマネジャーになるための本　トップIT企業のPMとして就職する方法" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00MN5AO7E/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">世界で闘うプロダクトマネジャーになるための本　トップIT企業のPMとして就職する方法</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2014-08-22)<br />売り上げランキング: 560<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00MN5AO7E/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>「世界で闘うプログラミング力を鍛える150問　トップIT企業のプログラマになるための本」がよくて，プロジェクトマネージャー版がでるとの噂を聞いて本屋でちらっと立ち読みした．
全然内容覚えてないけどよさそうな雰囲気だったので欲しい．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GSHI04M/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51cCs-aJ6xL._SL160_.jpg" alt="闘うプログラマー［新装版］　ビル・ゲイツの野望を担った男達" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GSHI04M/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">闘うプログラマー［新装版］　ビル・ゲイツの野望を担った男達</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2013-11-20)<br />売り上げランキング: 299<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GSHI04M/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>名著感．確かちょっと読んだことがあるのは情熱プログラマーで，闘うプログラマーの方は読んだことなかった．よさそうなので欲しい．情熱プログラマーはKindle版がそもそもなかった&hellip;<a href="http://www.amazon.co.jp/gp/product/B00AYQNR5U/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B00AYQNR5U&amp;linkCode=as2&amp;tag=haya14busa-22">洋書版</a>ならあるけど&hellip;洋書版セールじゃないけどほしいな．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01AN97W08/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51f-xfTWkkL._SL160_.jpg" alt="レガシーコード改善ガイド" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01AN97W08/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">レガシーコード改善ガイド</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">翔泳社 (2016-01-15)<br />売り上げランキング: 264<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01AN97W08/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>聞いたことある名著感．レガシーコード改善したいし，今回のセールで一番欲しいかも知れない．(上記に挙げてる本はほとんど固定レイアウトだし&hellip;)
レガシーコード改善ガイドを読んで <a href="https://github.com/easymotion/vim-easymotion">vim-easymotion</a> といった割とレガシーなメンテしてるプロダクトをリファクタリングするゾ!!!という気持ち．</p>

<h2>買うか迷ってるけど欲しい!!!本</h2>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00U5MVXZO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51GbST65OIL._SL160_.jpg" alt="プログラミングコンテスト攻略のためのアルゴリズムとデータ構造" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00U5MVXZO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">プログラミングコンテスト攻略のためのアルゴリズムとデータ構造</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2015-01-30)<br />売り上げランキング: 383<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00U5MVXZO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>プロコンとかアルゴリズム本の文脈でたまに聞く．ちらっと本屋で立ち読みしたことがあった気がするけどよさそうだった．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00L7FYBMK/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51onMQNa9sL._SL160_.jpg" alt="オンラインジャッジではじめるC/C++プログラミング入門" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00L7FYBMK/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">オンラインジャッジではじめるC/C++プログラミング入門</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2014-06-28)<br />売り上げランキング: 6,224<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00L7FYBMK/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>C/C++わかってなくて，オンラインジャッジでやれるところがよさそう．C言語学んで Vim のコードベースにコントリビュートするゾ!!!という気持ち．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HK6ZU0W/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51pJqy%2BHgzL._SL160_.jpg" alt="TCP/IP の基礎" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HK6ZU0W/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">TCP/IP の基礎</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2011-02-23)<br />売り上げランキング: 18,345<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HK6ZU0W/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>TCP/IP，よくみる有名な本ではないけど，評価も高そうだし基礎として読みたい．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B017SH8GZ8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51QVdlOsTiL._SL160_.jpg" alt="徳丸浩のWebセキュリティ教室（日経BP Next ICT選書）" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B017SH8GZ8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">徳丸浩のWebセキュリティ教室（日経BP Next ICT選書）</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2015-11-10)<br />売り上げランキング: 86<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B017SH8GZ8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>自分が書いたコードが知らないうちに脆弱性持ってたりすると怖いし，セキュリティ系は知識として知っておくと便利そう．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00FR78X64/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51bZA91ZWqL._SL160_.jpg" alt="世界でもっとも強力な9のアルゴリズム" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00FR78X64/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">世界でもっとも強力な9のアルゴリズム</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2013-10-10)<br />売り上げランキング: 246<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00FR78X64/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>聞いたことあるし読み物として面白そう?</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00SY2UKHY/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/5158xm%2BqWpL._SL160_.jpg" alt="Webエンジニアが知っておきたいインフラの基本" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00SY2UKHY/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Webエンジニアが知っておきたいインフラの基本</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">マイナビ出版 (2014-12-27)<br />売り上げランキング: 990<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00SY2UKHY/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>インフラ，わかってないので基本を知りたい!</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00UJ42A0K/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/61norbW9CfL._SL160_.jpg" alt="コンピュータの構成と設計 第5版 上" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00UJ42A0K/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">コンピュータの構成と設計 第5版 上</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2015-02-25)<br />売り上げランキング: 484<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00UJ42A0K/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>「パタ&amp;へネ」本．名著感．この辺の知識全然なさそうなので読むと便利そう．<a href="http://www.amazon.co.jp/gp/product/B00SF6JN7M/ref=as_li_ss_tl?ie=UTF8&amp;camp=247&amp;creative=7399&amp;creativeASIN=B00SF6JN7M&amp;linkCode=as2&amp;tag=haya14busa-22">「ヘネパタ」本</a>はセールじゃなかった&hellip;</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00UJ42A3C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/61BPSJwn03L._SL160_.jpg" alt="コンピュータの構成と設計 第5版 下" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00UJ42A3C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">コンピュータの構成と設計 第5版 下</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2015-02-25)<br />売り上げランキング: 475<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00UJ42A3C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00G9QITO8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51yD4FCOXCL._SL160_.jpg" alt="OSの仕組みの絵本" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00G9QITO8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">OSの仕組みの絵本</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">翔泳社 (2013-05-20)<br />売り上げランキング: 6,184<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00G9QITO8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>OSの仕組みに関する知識も全然もってないのでよさそう．</p>

<h2>「なぜなのか」系</h2>

<p>コンピュータはなぜ動くのかは昔読んだことあってよかった．
なのでこの「なぜなのか」系統の本はよさそうというイメージ．
「なぜなのか」系は他にもセールだったけど気になるタイトルだけ抜粋．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GSHI02Y/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51lpK1KcNeL._SL160_.jpg" alt="コンピュータはなぜ動くのか　知っておきたいハードウエア＆ソフトウエアの基礎知識" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GSHI02Y/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">コンピュータはなぜ動くのか　知っておきたいハードウエア＆ソフトウエアの基礎知識</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2013-11-20)<br />売り上げランキング: 592<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GSHI02Y/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HRN7VK0/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51-RR1ZYgYL._SL160_.jpg" alt="プログラムはなぜ動くのか 第2版　　知っておきたいプログラムの基礎知識" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HRN7VK0/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">プログラムはなぜ動くのか 第2版　　知っておきたいプログラムの基礎知識</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-01-09)<br />売り上げランキング: 228<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00HRN7VK0/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00ISP0QB2/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/518CYcUVM1L._SL160_.jpg" alt="オブジェクト指向でなぜつくるのか 第2版" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00ISP0QB2/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">オブジェクト指向でなぜつくるのか 第2版</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-03-05)<br />売り上げランキング: 114<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00ISP0QB2/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IYE80X8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51ipTmzh7AL._SL160_.jpg" alt="情報はなぜビットなのか　知っておきたいコンピュータと情報処理の基礎知識" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IYE80X8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">情報はなぜビットなのか　知っておきたいコンピュータと情報処理の基礎知識</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-03-12)<br />売り上げランキング: 3,404<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IYE80X8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IYE7ROQ/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51FblFsvHnL._SL160_.jpg" alt="検索エンジンはなぜ見つけるのか　知っておきたいウェブ情報検索の基礎知識" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IYE7ROQ/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">検索エンジンはなぜ見つけるのか　知っておきたいウェブ情報検索の基礎知識</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-03-12)<br />売り上げランキング: 10,078<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IYE7ROQ/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00ISP0OM8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/510OA1JQZtL._SL160_.jpg" alt="システムはなぜダウンするのか" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00ISP0OM8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">システムはなぜダウンするのか</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-03-05)<br />売り上げランキング: 493<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00ISP0OM8/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<h2>ちょっと欲しい気もする</h2>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00I96CJWO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51Dw%2BSbRbFL._SL160_.jpg" alt="ピープルウエア　第3版" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00I96CJWO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">ピープルウエア　第3版</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-02-05)<br />売り上げランキング: 339<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00I96CJWO/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>聴いたことあるし名著っぽいので</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IE3B522/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51Jx3FqHtwL._SL160_.jpg" alt="テストから見えてくるグーグルのソフトウェア開発" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IE3B522/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">テストから見えてくるグーグルのソフトウェア開発</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2014-02-12)<br />売り上げランキング: 5,657<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00IE3B522/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>




<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GLFI5J6/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51jemnVucZL._SL160_.jpg" alt="Linuxサーバーセキュリティ徹底入門" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GLFI5J6/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Linuxサーバーセキュリティ徹底入門</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">翔泳社 (2013-11-12)<br />売り上げランキング: 4,856<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00GLFI5J6/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>サーバのセキュリティ，ちょっとくらい知っておいても損はなさそう．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00VHW3PKW/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51cVluyW7XL._SL160_.jpg" alt="Linuxコンテナー最新ツール Dockerを支える技術（日経BP Next ICT選書） 日経Linux技術解説書" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00VHW3PKW/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Linuxコンテナー最新ツール Dockerを支える技術（日経BP Next ICT選書） 日経Linux技術解説書</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2015-03-25)<br />売り上げランキング: 9,511<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00VHW3PKW/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>Docker わかってないので知っておきたい．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00EH93MOQ/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51CW4gupfKL._SL160_.jpg" alt="ソーシャル・エンジニアリング" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00EH93MOQ/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">ソーシャル・エンジニアリング</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経ＢＰ社 (2013-08-28)<br />売り上げランキング: 4,286<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00EH93MOQ/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>セキュリティ系は知っておいて損がなさそう．</p>

<h2>持ってるけどオススメ!本</h2>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01E5DYK1C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51Sdan3jlwL._SL160_.jpg" alt="【電子合本版】Code Complete 第2版　完全なプログラミングを目指して" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01E5DYK1C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">【電子合本版】Code Complete 第2版　完全なプログラミングを目指して</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2016-04-14)<br />売り上げランキング: 658<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01E5DYK1C/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>持ってるけどまだ読んだとは言ってない! 読みたい!!!</p>

<h2>技術書・ビジネス書 大賞 部門</h2>

<p><a href="https://www.shoeisha.co.jp/campaign/award/result">ITエンジニアに読んでほしい！技術書・ビジネス書 大賞 2016</a> に含まれている本．Kindle セールになってるの2つしかなかったけど．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00W535LOU/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/41NEFDfkNAL._SL160_.jpg" alt="HARD THINGS　答えがない難問と困難にきみはどう立ち向かうか" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00W535LOU/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">HARD THINGS　答えがない難問と困難にきみはどう立ち向かうか</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2015-04-17)<br />売り上げランキング: 14<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00W535LOU/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>おすすめされた． 2015年の電子書籍で一番売れたとか評判よさそうだし読み物として買いたい．</p>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B014UR9R3Y/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51Z00YSPLcL._SL160_.jpg" alt="21世紀のビジネスにデザイン思考が必要な理由" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B014UR9R3Y/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">21世紀のビジネスにデザイン思考が必要な理由</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">クロスメディア・パブリッシング（インプレス） (2015-07-22)<br />売り上げランキング: 214<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B014UR9R3Y/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>55%なので6/2までのセール対象というわけではないかも．</p>

<h3>追記．記事書いた後に見つけた本</h3>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00F3UTIQY/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51EnYk6XEWL._SL160_.jpg" alt="リーン・スタートアップ　ムダのない起業プロセスでイノベーションを生みだす" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00F3UTIQY/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">リーン・スタートアップ　ムダのない起業プロセスでイノベーションを生みだす</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">日経BP社 (2013-09-11)<br />売り上げランキング: 343<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B00F3UTIQY/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<h3>おわりに． テンプレ的な何か</h3>

<div class="amazlet-box" style="margin-bottom:0px;"><div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B008H2USUK/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51Aw8JRwqdL._SL160_.jpg" alt="Amazonギフト券- Eメールタイプ - Amazon Kindle" style="border: none;" /></a></div><div class="amazlet-info" style="line-height:120%; margin-bottom: 10px"><div class="amazlet-name" style="margin-bottom:10px;line-height:120%"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B008H2USUK/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazonギフト券- Eメールタイプ - Amazon Kindle</a><div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.05.30</div></div><div class="amazlet-detail">Amazonギフト券 (2012-12-10)<br />売り上げランキング: 17<br /></div><div class="amazlet-sub-info" style="float: left;"><div class="amazlet-link" style="margin-top: 5px"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B008H2USUK/haya14busa-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a></div></div></div><div class="amazlet-footer" style="clear: left"></div></div>


<p>Kindle 本は欲しいものリストでプレゼントできないらしいですが，Amazon ギフト券で<a href="https://twitter.com/haya14busa">僕</a> (hayabusa1419 at gmail.com) にプレゼントしてくれてもいいですよ???</p>
</div>
  
  


      <footer>
      
      - <a href="/amazon-kindle-sale-til-2016-06-02/">6/2までKindle本50%オフセール!IT系の本で僕が欲しい本をまとめた!!!</a>
      <time datetime="2016-05-30T22:41:43+09:00" pubdate><span class='month'>May</span> <span class='day'>30</span> <span class='year'>2016</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/book/'>book</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/revital-vim-makes-vital-vim-a-lot-faster/">revital.vim で vital.vim を爆速にしてお前らの Vim Plugin を速くする</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2016-03-23T04:45:43+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><div class="github-card" data-github="haya14busa/revital.vim" data-width="500" data-height="150" data-theme="default"></div>


<p><a href="https://github.com/haya14busa/revital.vim">haya14busa/revital.vim</a></p>

<p>この度， revital.vim というプラグインを作って vital.vim のモジュールのローディングを爆速にしてお前らが使ってる Vim plugin を速くしました．</p>

<p>めでたい．</p>

<p>あと気づいたんですが今日は僕の誕生日のですね．これもまためでたい．</p>

<p>そして本当のところは vital.vim を使ってるプラグイン開発者が， revital.vim を使って初めて速くなるので実はまだ速くなってないものが多いです．
待ちきれない方はこの記事を読んで revital.vim の使い方を覚えてプルリクしていきましょう．
また爆速にはなったと思うんですが，体感には個人差・環境差があり，もともとほとんど速度が気にならない人も多いかと思うのでご注意ください．
Windows だか symlink だか virtualbox だか neovim だか何かはまだよくわかってませんが，特定の
環境が原因なのか vital.vim をヘビーに使用しているプラグインにまれによく「遅いぞ?」という issue が飛んできたりしていて，
そういった方には顕著に効果があると思います．(たぶん)</p>

<p>参考: <a href="https://github.com/easymotion/vim-easymotion/issues/242">遅いと</a>，<a href="https://github.com/easymotion/vim-easymotion/issues/136">言ってる</a>，<a href="https://github.com/haya14busa/incsearch.vim/issues/85">人たち</a>
(放置気味でｽｲﾏｾﾝ&hellip;いや workaround な修正なら前からできたんだけど手元でも再現しないものをその場対処はあんまりやりたくなくてやる気が&hellip;)</p>

<h2>vital.vim とは?</h2>

<p><a href="https://github.com/vim-jp/vital.vim">https://github.com/vim-jp/vital.vim</a></p>

<p>Vim script の最高のライブラリです．vital.vimのいいところとダメなところを個人的に上げるとこんな感じです．</p>

<h3>vital.vim のいいところ</h3>

<ol>
<li>組み込み式なので依存ライブラリがアップデートされても安心</li>
<li>プラグインのユーザはvital.vimを別途インストールする必要がない</li>
<li>めっちゃ気軽に外部ライブラリを作って使える</li>
<li>けっこういろんなものがそろっていて種類が豊富</li>
<li>日本人の凄腕 Vimmer 達が開発・メンテしているので品質も高い</li>
</ol>


<p><strong>とにかくベンリ</strong></p>

<h3>vital.vim のダメなところ</h3>

<ol>
<li>(ロードが) <strong>遅い</strong> (ケースがある)(基本的に気にならないけど)</li>
<li>ドキュメントがたぶん足りないので敷居が高い(ように見えるだけで使い方は簡単なんだけど&hellip;)</li>
<li>インストールやアップデートでハマることが多い印象</li>
</ol>


<p>他のところで，ファイルをコピーするのが無駄だとかキッチンシンクじゃない?みたいな
話を聞いたことがありますが，前者は全然気にする時代じゃないはずだし，後者は単なる勘違いで
vital.vim は使うライブラリのみ組み込めるので問題ないはずです．</p>

<p><a href="https://github.com/vim-jp/vital.vim">Githubのリポジトリ</a>では</p>

<blockquote><p>This is like a plugin which has both aspects of Bundler and jQuery at the same time.</p></blockquote>

<p>と(たぶん昔から)書いてあって，Bundler はともかく jQuery はちょっとあんまり良い印象ではないのかなぁと思う．
どちらかというと lodash とか Bundler に合わせるなら npm と言ってもいい気がする．</p>

<p>で，話が少々それていますが，今回 1つ目のモジュールの読み込みが<strong>遅い</strong>という部分を revital.vim で解決してみました．
2と3はドキュメントを拡充したり，<code>:Vitalizer</code>というコマンドをもうちょっとユーザフレンドリーにしてあげるといいのかなぁと個人的に思うのでなんとかしたいと思います．
(去年くらい前から思っているのでつらい)</p>

<p>とにかく <a href="https://github.com/vim-jp/vital.vim">vital.vim</a> 最高なので
<a href="https://github.com/haya14busa/revital.vim">revital.vim</a> と一緒に使っていきましょう．</p>

<h2>速くなったというならまずはベンチマークじゃん?(雑)</h2>

<h3>スクリプト</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>command<span class="p">!</span> <span class="p">-</span><span class="k">bar</span> TimerStart <span class="k">let</span> start_time <span class="p">=</span> reltime<span class="p">()</span>
</span><span class='line'>command<span class="p">!</span> <span class="p">-</span><span class="k">bar</span> TimerEnd echo reltimestr<span class="p">(</span>reltime<span class="p">(</span>start_time<span class="p">))</span> <span class="p">|</span> unlet start_time
</span><span class='line'>
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:_vital_of<span class="p">()</span> abort
</span><span class='line'>  <span class="k">let</span> V <span class="p">=</span> vital#of<span class="p">(</span><span class="s1">&#39;incsearch&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">call</span> V.<span class="k">load</span><span class="p">(</span><span class="s1">&#39;Data.List&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">call</span> V.unload<span class="p">()</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:_vital_incsearch_of<span class="p">()</span> abort
</span><span class='line'>  <span class="k">let</span> V <span class="p">=</span> vital#<span class="nb">incsearch</span>#of<span class="p">()</span>
</span><span class='line'>  <span class="k">call</span> V.<span class="k">load</span><span class="p">(</span><span class="s1">&#39;Data.List&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">call</span> V.unload<span class="p">()</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="k">let</span> <span class="k">s</span>:times <span class="p">=</span> <span class="m">100</span>
</span><span class='line'>
</span><span class='line'>TimerStart
</span><span class='line'><span class="k">for</span> _ <span class="k">in</span> range<span class="p">(</span><span class="k">s</span>:times<span class="p">)</span>
</span><span class='line'>  <span class="k">call</span> <span class="k">s</span>:_vital_of<span class="p">()</span>
</span><span class='line'><span class="k">endfor</span>
</span><span class='line'>TimerEnd
</span><span class='line'><span class="c">&quot; =&gt; 1.565324</span>
</span><span class='line'>
</span><span class='line'>TimerStart
</span><span class='line'><span class="k">for</span> _ <span class="k">in</span> range<span class="p">(</span><span class="k">s</span>:times<span class="p">)</span>
</span><span class='line'>  <span class="k">call</span> <span class="k">s</span>:_vital_incsearch_of<span class="p">()</span>
</span><span class='line'><span class="k">endfor</span>
</span><span class='line'>TimerEnd
</span><span class='line'><span class="c">&quot; =&gt; 0.028437</span>
</span></code></pre></td></tr></table></div></figure>


<h4>結果: vital#of() と V.import(&lsquo;Data.List&rsquo;) 相当を100回回したベンチマーク</h4>

<table>
<thead>
<tr>
<th>vital.vim (x 100) </th>
<th> revital.vim (x 100)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.565324 sec </td>
<td> <strong>0.028437 sec</strong></td>
</tr>
</tbody>
</table>


<p>ref: <a href="https://github.com/haya14busa/incsearch.vim/pull/112#issue-142680963">https://github.com/haya14busa/incsearch.vim/pull/112#issue-142680963</a></p>

<p><strong>速くなってますね!!!</strong></p>

<p>(まぁ僕の環境ではもともと1回分にすると0.01秒くらいで全然遅いと感じたことなかったのですが)</p>

<p>上記のベンチマークは <a href="https://github.com/haya14busa/incsearch.vim">https://github.com/haya14busa/incsearch.vim</a> のコードで回しましたが，<a href="https://github.com/easymotion/vim-easymotion">https://github.com/easymotion/vim-easymotion</a> や 手元でテスト用に作った全部のvital モジュールをインストールしたプラグインでも同じような結果になりました．</p>

<h2>revital.vim の使い方</h2>

<p>さぁこれだけ速くなってるならvital.vimを既に使ってる人なんかは特に revital.vim を使ってみたくなりましたよね?
使い方は簡単です．</p>

<h3>わかってる人向けの簡単説明</h3>

<ol>
<li>vital.vim で :Vitalize しておく</li>
<li>revital.vim の :Revitalize コマンドを実行</li>
<li><code>vital#of('{plugin-name}')</code> の変わりに <code>vital#{plugin-name}#of()</code>を使う．</li>
</ol>


<p>これだけです．インターフェースは vital.vim をそのまま使う場合とほとんど変わりません．</p>

<h3>ちょっと丁寧な説明</h3>

<h4>a) モジュールをインストール</h4>

<p><code>{pluginname}</code> をあなたかが開発しているプラグインの名前に置き換えましょう．</p>

<ol>
<li><code>:cd /path/to/your/plugin</code> プラグインのディレクトリに移動．もちろん shell で移動してから Vim を起動するとかコマンドで指定してもOK.</li>
<li><code>:Vitalize --name={pluginname} . +Data.List</code> <code>Data.List</code> モジュールを組み込んでみる</li>
<li>※  <code>--name</code>には<code>.</code>や<code>-</code>が使えないので適宜<code>vim-</code>とか<code>.vim</code>とかいらない部分は削る．</li>
<li><code>:Revitalize .</code> Revitalize 実行!</li>
</ol>


<h4>b) モジュールの使い方</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">let</span> <span class="k">s</span>:V <span class="p">=</span> vital#{pluginname}#of<span class="p">()</span>
</span><span class='line'><span class="k">let</span> <span class="k">s</span>:List <span class="p">=</span> <span class="k">s</span>:V.import<span class="p">(</span><span class="s1">&#39;Data.List&#39;</span><span class="p">)</span>
</span><span class='line'>echo <span class="k">s</span>:List.uniq<span class="p">(</span>[<span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span>]<span class="p">)</span>
</span><span class='line'><span class="c">&quot; =&gt; [1, 2, 3]</span>
</span></code></pre></td></tr></table></div></figure>


<p>簡単で vital.vim のみで使うケースとほとんど変わりません．</p>

<h4>c) モジュールのアップデート</h4>

<p><code>:Vitalize</code>でアップデートしたあとにもう一度 <code>:Revitalize</code> する必要があります．</p>

<ol>
<li><code>:cd /path/to/your/plugin</code> プラグインのディレクトリに移動．</li>
<li><code>:Vitalize .</code> アップデートするときはこれだけ．</li>
<li><code>:Revitalize .</code> Revitalize 実行</li>
</ol>


<h2>どうして revitalize.vim は速いのか?</h2>

<p>vital.vim はモジュールをロードする際(<code>s:V.import('Module.Name')</code>)に</p>

<ol>
<li>モジュール名から目的のファイルを探す</li>
<li>そのファイルからモジュール用のオブジェクトを作る</li>
</ol>


<p>というざっくり2段階が必要です．このうち1などはsimlinkをたどるといった関数が遅
いせいで結構な時間が環境によってはかかっていますし，2はそこまで遅くはない気もし
ますがいろいろ内部でやっています．(ちゃんとprofileはしてない．)
vital.vim の組み込みライブラリであるという性質上，普通にやるなら上記の段階が必要です．
また歴史的経緯も含まれているかもしれないですが上記の2段階の前にはライブラリを
ロードするためのローダーを同じような手順で作成する必要があります(<code>vital#of({plugin-name})</code>)．</p>

<p>速くする方法はないものかなぁと考えると1つ思い当たります．</p>

<p>モジュール名から目的のファイルを Vim script で素早く探すのにはなかなか骨が折れますが，Vim script には
autoload function という機能があり，autoload 関数をいい感じに定義しいい感じに呼
べば(<code>path#to#module#file</code>)，対応したファイルを勝手に内部で見つけてきて関数を呼
んでくれるという仕組みが存在します．Vim script で頑張るよりも組み込み機能を
使ったほうが速いはずです!! autoload 関数使いたい!!!</p>

<p>しかし，autoload 関数をいい感じに定義する際にはファイルのパス情報が必要になります．
ここでvital.vim は別のプラグインに組み込まれることが前提のライブラリなのでパスが定まっていません．
よって autoload はそのままでは使えませんでした&hellip;</p>

<p>うーん．困ったな&hellip;</p>

<p>でもでも，よくよく考えてみると最初からパスが定まっていなくても，モジュールをプラグインに組み込んだあとのパスは決定しています．
つまり，<code>:Vitalize</code> でモジュールをプラグインに組み込んだあとにモジュールのファイルに適切な autoload 関数を追加してしまえばいいのです．</p>

<p>もうわかったでしょか?</p>

<p>revital.vim が提供する <code>:Revitalize</code> コマンドは組み込んだモジュールのファイルに
適切なautoload関数を追加し， <code>s:V.import('Module.Name')</code> の内部では追加した autoload 関数を呼ぶようになっているのです．
また，autoload関数を追加する際にモジュールのオブジェクトの雛形となるようなオブジェクトをついでに生成してやっているので，
そのオブジェクトの生成するプロセス分も速くなっています．</p>

<p>最後にファイルを探したりといろいろと大変な <code>vital#of({plugin-name})</code> の代わりに
直接 vital のローダーオブジェクトを返す <code>vital#{plugin-name}#of()</code> を作って revital.vim の仕事は終了です．</p>

<p>モジュールのファイルに autoload 関数を追加するというちょっと刺激的なハックをすることによって vital.vim のロードを爆速化することができました．
ただモジュールのファイルといっても組み込んだあとのモジュールのファイルを書き換
えるだけなのでオリジナルのファイルは書き換えないし，これくらいのハックは別に問題ないかなと思います．
一応vitalモジュールのファイルの途中で <code>:finish</code> されると使えなくなるという問題がありますが，まずそんなケースはないでしょう．</p>

<h2>本家に入れたいような気もするけど要相談?</h2>

<p>確実に速くなるし，本家ではテストされてないような部分もテストしているので，少々
ランニングして安定すれば本家にオプションかなにかで入れてもいいんじゃないかなぁと思います．</p>

<p>しかし，一応入り口のインターフェースが変わることと，ちょっと実装にハック感があ
ること，ドラスティックな変更なのでいろいろ待つよりもまずは実装して見てみるということで
revital.vim を作ってみました．</p>

<p>後方互換性は崩さないような仕組みになっているので時が来たらvital.vim 本家に同じ機能が実装されるとよさがありますね．</p>

<h2>おわり</h2>

<p><a href="https://github.com/haya14busa/revital.vim">haya14busa/revital.vim</a> で
vital.vim が爆速になるので vital.vim を使っている Vim プラグイン開発者各位や
これから <a href="https://github.com/vim-jp/vital.vim">vital.vim</a> を使ってみたいという
各位は是非お試しください!</p>

<p><strong>「爆ぜろリアル！ 弾けろシナプス！ Rev!talize Th!s World！」</strong></p>

<script src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>

</div>
  
  


      <footer>
      
      - <a href="/revital-vim-makes-vital-vim-a-lot-faster/">revital.vim で vital.vim を爆速にしてお前らの Vim plugin を速くする</a>
      <time datetime="2016-03-23T04:45:43+09:00" pubdate><span class='month'>Mar</span> <span class='day'>23</span> <span class='year'>2016</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/vim-easymotion-ver-3-dot-0-overwin-motions/">Vimのカーソル移動はもっともっと爆速になる! Vim-EasyMotion v3.0 をリリースしました</a></h1>
    
    
      <div class="post-meta">
        <p class="meta">
          <span class="timestamp">- 








  



<time datetime="2016-01-19T03:14:43+09:00" pubdate data-updated="true"></time> -</span>
          
        </p>
      </div>
    
  </header>


  <div class="entry-content"><p>Vim-EasyMotion でウィンドウをまたいだ移動ができるようになりました!!!</p>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/2753bd4dd1dfdf5962dbdbffabf24244e4e14243/easymotion/overwin-motions.gif" alt="" /></p>

<div class="github-card" data-github="easymotion/vim-easymotion" data-width="500" data-height="150" data-theme="default"></div>


<p><a href="https://github.com/easymotion/vim-easymotion">easymotion/vim-easymotion</a></p>

<h3>過去の関連記事</h3>

<ul>
<li><a href="http://haya14busa.com/vim-lazymotion-on-speed/">Vim-Easymotionを拡張してカーソルを縦横無尽に楽々移動する - haya14busa</a>

<ul>
<li>まだ fork でやってた時代の記事． 自分のVim歴より始まりが古く，1年続いたという伝説のVim Advent Calendar 2012の363日目の記事で懐かしい．</li>
</ul>
</li>
<li><a href="http://haya14busa.com/mastering-vim-easymotion/">Vim-EasyMotionでカーソル移動を爆速にして生産性をもっと向上させる - haya14busa</a>

<ul>
<li>easymotionのメンテナになってからの便利機能まとめ的な記事.</li>
</ul>
</li>
</ul>


<p>そして今回の記事はvim-easymotionのリポジトリがorganization持ちになって<del>久々に</del>便利機能追加したという記事になります．</p>

<p>vim-easymotionとはVimのカーソル移動をブラウザでいうHit-A-Hint機能のように行うカーソル移動改善系プラグインです．
よく知らないよ〜という方は<a href="https://github.com/easymotion/vim-easymotion">README</a>眺めたり， 過去記事 (<a href="http://haya14busa.com/mastering-vim-easymotion/">Vim-EasyMotionでカーソル移動を爆速にして生産性をもっと向上させる - haya14busa</a> ) をさらっと読むと分かるかと思います．過去記事は<code>n-key Find Motion</code>の節以外はだいたい現役で使えると思います．</p>

<h2>vim-easymotion v3.0</h2>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/2753bd4dd1dfdf5962dbdbffabf24244e4e14243/easymotion/overwin-motions.gif" alt="" /></p>

<p><a href="https://github.com/easymotion/vim-easymotion/releases/tag/v3.0.0">Release EasyMotion now supports moving cursor over/across windows · easymotion/vim-easymotion</a></p>

<p>vim-easymotionではこれまでカーソルと同一ウィンドウ内にしか移動できなかったのですが，v3.0でとうとう他のウィンドウにも移動できるようになりました! めでたい．
実はv3.0 で追加するメイン機能はこれだけなんですが，個人的にかなり気に入ってしまい，「これはメジャーバージョンアップするしかない」と思い勢いだけでバージョンあげています．
他にはバグフィックスとか細かい修正で，とくに後方互換性は壊してないはずなので気軽にアップデートできると思います．</p>

<h3>追加したマッピング</h3>

<table>
<thead>
<tr>
<th> mapping </th>
<th> description </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;Plug&gt;(easymotion-overwin-f){char}</code> </td>
<td> <code>{char}</code> にマッチする位置を対象として移動 </td>
</tr>
<tr>
<td><code>&lt;Plug&gt;(easymotion-overwin-f2){char}{char}</code> </td>
<td> <code>{char}{char}</code> にマッチする位置を対象として移動 </td>
</tr>
<tr>
<td><code>&lt;Plug&gt;(easymotion-overwin-line)</code> </td>
<td> 行を対象として移動 </td>
</tr>
<tr>
<td><code>&lt;Plug&gt;(easymotion-overwin-w)</code> </td>
<td> 単語の先頭を対象として移動 </td>
</tr>
</tbody>
</table>


<h4>マッピング例</h4>

<p>ヴィジュアルモードやオペレータ待機モードで他のウィンドウに移動するというのは意味をなさないので，
他のウィンドウに移動する overwin モーションは <code>Normal</code> モードのマッピングのみ提供しています．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; &lt;Leader&gt;f{char} to move to {char}</span>
</span><span class='line'>map  <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">f</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span><span class="k">bd</span><span class="p">-</span><span class="k">f</span><span class="p">)</span>
</span><span class='line'>nmap <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">f</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span>overwin<span class="p">-</span><span class="k">f</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; s{char}{char} to move to {char}{char}</span>
</span><span class='line'>nmap <span class="k">s</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span>overwin<span class="p">-</span>f2<span class="p">)</span>
</span><span class='line'>vmap <span class="k">s</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span><span class="k">bd</span><span class="p">-</span>f2<span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Move to line</span>
</span><span class='line'>map <span class="p">&lt;</span>Leader<span class="p">&gt;</span>L <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span><span class="k">bd</span><span class="p">-</span>jk<span class="p">)</span>
</span><span class='line'>nmap <span class="p">&lt;</span>Leader<span class="p">&gt;</span>L <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span>overwin<span class="p">-</span>line<span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Move to word</span>
</span><span class='line'>map  <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">w</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span><span class="k">bd</span><span class="p">-</span><span class="k">w</span><span class="p">)</span>
</span><span class='line'>nmap <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">w</span> <span class="p">&lt;</span>Plug<span class="p">&gt;(</span>easymotion<span class="p">-</span>overwin<span class="p">-</span><span class="k">w</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>EasyMotion触ったことなくてミニマムに始めたい場合は上記設定から気に入ったもの +
以下の設定でデフォルトマッピングをオフにするとよいかなと思います．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">let</span> <span class="k">g</span>:EasyMotion_do_mapping <span class="p">=</span> <span class="m">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>もしひとつだけおすすめするなら<code>nmap s &lt;Plug&gt;(easymotion-overwin-f2)</code>がオススメです．
このマッピングだと画面上の見えているところへならどこへでも <code>s{char}{char}{hint}</code>の4 キーストロークで移動できます．
<code>&lt;Plug&gt;(easymotion-overwin-f)</code>や<code>&lt;Plug&gt;(easymotion-overwin-w)</code>だと候補が多すぎてヒントを2回以上打たないとダメなケースがよくあるのですが，
<code>{char}{char}</code>と2文字打つと候補が劇的に減ってヒントは大抵のケースで1文字入力するだけですみます．</p>

<h4>incsearch.vim との連携</h4>

<p>vim-easymotionには<code>&lt;Plug&gt;(easymotion-sn)</code>という <code>N</code> 文字入力してマッチした位置
を対象として移動するモーション，言わばeasymotionの検索(<code>/</code>)版マッピングを提供していたのですが，
今回，それのウィンドウ間移動できるマッピングは提供していません．</p>

<p>というのも，<code>&lt;Plug&gt;(easymotion-sn)</code>はVimデフォルトの検索との互換性が甘いところがあり，
<a href="http://haya14busa.com/incsearch-dot-vim-ver-2/">Vimの検索はもっともっと便利になる! incsearch.vim v2.0 をリリースしました - haya14busa</a>
の記事で紹介した incsearch.vim と vim-easymotion を連携させたほうが基本的に便利になっていて，
こちらを推奨したいなという訳です．</p>

<h4>必要なもの</h4>

<ul>
<li><a href="https://github.com/easymotion/vim-easymotion">easymotion/vim-easymotion</a></li>
<li><a href="https://github.com/haya14busa/incsearch.vim">haya14busa/incsearch.vim</a></li>
<li><a href="https://github.com/haya14busa/incsearch-easymotion.vim">haya14busa/incsearch-easymotion.vim</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; You can use other keymappings like &lt;C-l&gt; instead of &lt;CR&gt; if you want to</span>
</span><span class='line'><span class="c">&quot; use these mappings as default search and somtimes want to move cursor with</span>
</span><span class='line'><span class="c">&quot; EasyMotion.</span>
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:incsearch_config<span class="p">(</span>...<span class="p">)</span> abort
</span><span class='line'>  <span class="k">return</span> <span class="nb">incsearch</span>#util#deepextend<span class="p">(</span>deepcopy<span class="p">(</span>{
</span><span class='line'>  \   <span class="s1">&#39;modules&#39;</span>: [<span class="nb">incsearch</span>#config#easymotion#module<span class="p">(</span>{<span class="s1">&#39;overwin&#39;</span>: <span class="m">1</span>}<span class="p">)</span>]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;keymap&#39;</span>: {
</span><span class='line'>  \     <span class="s2">&quot;\&lt;CR&gt;&quot;</span>: <span class="s1">&#39;&lt;Over&gt;(easymotion)&#39;</span>
</span><span class='line'>  \   }<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;is_expr&#39;</span>: <span class="m">0</span>
</span><span class='line'>  \ }<span class="p">),</span> <span class="k">get</span><span class="p">(</span><span class="k">a</span>:<span class="p">,</span> <span class="m">1</span><span class="p">,</span> {}<span class="p">))</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> /  <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>incsearch_config<span class="p">())</span>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> ?  <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>incsearch_config<span class="p">(</span>{<span class="s1">&#39;command&#39;</span>: <span class="s1">&#39;?&#39;</span>}<span class="p">))</span>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> <span class="k">g</span>/ <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>incsearch_config<span class="p">(</span>{<span class="s1">&#39;is_stay&#39;</span>: <span class="m">1</span>}<span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>&lt;CR&gt;</code> を <code>&lt;C-l&gt;</code>とかにすることで普段は普通の incsearch.vim, <code>&lt;C-l&gt;</code>押した時に
easymotion発動といったことができたりします．僕はそういう設定にしていて，便利につかえてます．</p>

<h2>おまけ</h2>

<h3>incsearch-migemo 連携</h3>

<p><a href="https://github.com/haya14busa/incsearch-migemo.vim">haya14busa/incsearch-migemo.vim</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:config_migemo<span class="p">(</span>...<span class="p">)</span> abort
</span><span class='line'>  <span class="k">return</span> extend<span class="p">(</span>copy<span class="p">(</span>{
</span><span class='line'>  \   <span class="s1">&#39;converters&#39;</span>: [
</span><span class='line'>  \     <span class="nb">incsearch</span>#config#migemo#converter<span class="p">(),</span>
</span><span class='line'>  \   ]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;modules&#39;</span>: [<span class="nb">incsearch</span>#config#easymotion#module<span class="p">(</span>{<span class="s1">&#39;overwin&#39;</span>: <span class="m">1</span>}<span class="p">)</span>]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;keymap&#39;</span>: {<span class="s2">&quot;\&lt;C-l&gt;&quot;</span>: <span class="s1">&#39;&lt;Over&gt;(easymotion)&#39;</span>}<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;is_expr&#39;</span>: <span class="m">0</span><span class="p">,</span>
</span><span class='line'>  \ }<span class="p">),</span> <span class="k">get</span><span class="p">(</span><span class="k">a</span>:<span class="p">,</span> <span class="m">1</span><span class="p">,</span> {}<span class="p">))</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> <span class="k">m</span>/ <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>config_migemo<span class="p">())</span>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> <span class="k">m</span>? <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>config_migemo<span class="p">(</span>{<span class="s1">&#39;command&#39;</span>: <span class="s1">&#39;?&#39;</span>}<span class="p">))</span>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> mg/ <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>config_migemo<span class="p">(</span>{<span class="s1">&#39;is_stay&#39;</span>: <span class="m">1</span>}<span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>fuzzy search で easymotion</h3>

<p><img src="https://raw.githubusercontent.com/haya14busa/i/eab1d12a8bd322223d551956a4fd8a21d5c4bfe9/easymotion/fuzzy-incsearch-easymotion.gif" alt="" /></p>

<ul>
<li><a href="https://github.com/haya14busa/incsearch.vim">haya14busa/incsearch.vim</a></li>
<li><a href="https://github.com/haya14busa/incsearch-fuzzy.vim">haya14busa/incsearch-fuzzy.vim</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:config_easyfuzzymotion<span class="p">(</span>...<span class="p">)</span> abort
</span><span class='line'>  <span class="k">return</span> extend<span class="p">(</span>copy<span class="p">(</span>{
</span><span class='line'>  \   <span class="s1">&#39;converters&#39;</span>: [<span class="nb">incsearch</span>#config#fuzzyword#converter<span class="p">()</span>]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;modules&#39;</span>: [<span class="nb">incsearch</span>#config#easymotion#module<span class="p">(</span>{<span class="s1">&#39;overwin&#39;</span>: <span class="m">1</span>}<span class="p">)</span>]<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;keymap&#39;</span>: {<span class="s2">&quot;\&lt;CR&gt;&quot;</span>: <span class="s1">&#39;&lt;Over&gt;(easymotion)&#39;</span>}<span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;is_expr&#39;</span>: <span class="m">0</span><span class="p">,</span>
</span><span class='line'>  \   <span class="s1">&#39;is_stay&#39;</span>: <span class="m">1</span>
</span><span class='line'>  \ }<span class="p">),</span> <span class="k">get</span><span class="p">(</span><span class="k">a</span>:<span class="p">,</span> <span class="m">1</span><span class="p">,</span> {}<span class="p">))</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="nb">noremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;&lt;</span>expr<span class="p">&gt;</span> <span class="p">&lt;</span>Space<span class="p">&gt;</span>/ <span class="nb">incsearch</span>#<span class="k">go</span><span class="p">(&lt;</span>SID<span class="p">&gt;</span>config_easyfuzzymotion<span class="p">())</span>
</span></code></pre></td></tr></table></div></figure>


<h2>実装とか背景の話</h2>

<p>実はこのウィンドウをまたいだ移動についてはvim-easymotionの開発を引き継いだころからずっと欲しいなぁ〜やりたいな〜と思っていた待望の機能でした．
emacs版easymotionである <a href="https://github.com/winterTTr/ace-jump-mode">winterTTr/ace-jump-mode</a> や atomのsmalls (<a href="http://qiita.com/t9md/items/bca96d45af1a5244b5d1">ATOM - smalls つくった - Qiita</a>)ではラベルジャンプでウィンドウ移動ができています．</p>

<p>どの拡張も，もともとはEasyMotion にインスパイアされて作ったもので，他の機能はともかく少なくともウィンドウ間をまたげるという一点ではvim-easymotionを上回っていました．
ではなぜ，vim-easymotionでもやりたいなぁと思っていたのに，これまで実装できていなかったかというと，
これは<strong>「vim-easymotionのコードがちょっと闇でつらかった&hellip;」</strong>というわけではなく Vim の機能でやるのがきつかったことに起因します．
Vimにはオーバーレイで文字を表示するといった機能がないのでvim-easymotionでは一旦バッファの文字を書き換えて戻すという実装になっていました．
この実装だと同じバッファを別ウィンドウに表示している場合にラベルがバッティングしてしまいます．</p>

<p>では今回どうしたかというと Vim の conceal 機能, <a href="http://vim-jp.org/vimdoc-ja/syntax.html#%3Asyn-cchar">:h syn-cchar</a> を使っています．
この機能を使えば直接バッファを書き換えずにラベルを表示できるので，同じバッファが別ウィンドウにあっても違ったラベルを表示することが可能です．</p>

<h3>Conceal の syn-cchar つらい問題</h3>

<p>しかし，このconcealでラベルを表示するというアイデア自体は以前からあって <a href="https://github.com/justinmk/vim-sneak">justinmk/vim-sneak</a>
がこのスタイルで表示しています(カーソルと同一ウィンドウだけですが)．
前からアイデアを知っていたのにやれなかったのは，決して<strong>「vim-easymotionのコードがちょっと闇でつらかった&hellip;」</strong>というわけではなく
conceal機能はかなり制限があってやりたいことができなさそうだなぁと長らく思っていたからです．
というも，syn-ccharでは1文字しか表示できないし，空白行といった無の部分に文字を表示することができません．
この制限からラベルが2文字以上の時でも1文字しか表示できなかったり，
Tab文字や文字幅が2以上のマルチバイトの文字をラベルに置き換えるとラベル表示時に表示にズレが生じてしまいます．</p>

<h3>結局<strong>「vim-easymotionのコードがちょっと闇でつらかった&hellip;」</strong></h3>

<p>じゃあどうすればいいかというと，ここまでの話・実装を組み合わせると実は答えは出ています．
ラベルを表示するさいに対象が空白行や行末，マルチバイト文字であれば一旦スペースを追加またはスペースに置き換えてしまう前処理をすればOKです．
そうすれば空白行や行末を対象とできるし，2文字のラベルも表示できるし，ラベルを表示した際に表示のズレが生じません!
やったぜこれで理論上実装可能じゃん!</p>

<p>なぜこれに気づくのに時間がかかったのかというと結局<strong>「vim-easymotionのコードがちょっと闇でつらかった&hellip;」</strong>
のでしばらくeasymotionにまともに向き合ってなかったからでした．
vim-easymotionはforkする前のもともとコードがそんなに綺麗じゃなかった上に，
プログラミング自体ほとんど初心者だった僕が以前に便利な機能を追加したりVimとの互換性を保ったりすることと引き換えに，
コードは比較的カオス状態になっていました．
僕の実装力ではこれを互換性を保った状態でリファクタして他のウィンドウへ移動する抜本的な機能改善なんて無理や&hellip;
と内心思っていましたし，実際無理感あります．
こういった理由でウィンドウ間移動という待望の機能は2年間ほど待望の機能であり続けました．</p>

<h3>1から作って互換性意識すればいいんじゃん?</h3>

<p>互換性保ちながらリファクタしていくのがつらいなら1から作って，インターフェースを既存のeasymotionと合わせればいいんじゃないか?
と気付き，今回の機能は実装されました．</p>

<p>「パンがなければお菓子を食べればいいじゃない」に通ずるものがあります(ない)</p>

<p>これに気づいてやってみると，一旦動くところまで実装する程度なら1日程度で待望の機能が実装できました．
やってみるものですね．</p>

<p>しかし，vim-easymotionを活発に開発していた2年前の僕にはできなかったかなぁと感じていて，
これまでに incsearch.vim といった他のプラグインを作った知見や，他の Vim プラグイン開発者から得た知見，
そして2年間でちょっと基本的な開発力があがったおかげで開発できたなぁと思います．
みなさまありがとうございました．そして自分，まだまだですがちょっと頑張ったなって思いました．</p>

<p>開発の実装や背景の話と2年前に熱を入れて取り組んでいたvim-easymotionに今の自分が取り組んでみたらちょっと感慨深かったなという話でした．</p>

<h2>おわりに</h2>

<p><a href="https://github.com/easymotion/vim-easymotion">vim-easymotion</a>, また一段と便利になったので是非使ってみてください!</p>

<p>僕はもうこの機能なしでは生きていけなさそうです．</p>

<p><strong>あぁ〜カーソルがぴょんぴょんするんじゃぁ〜</strong></p>

<blockquote class="twitter-tweet" lang="en"><p lang="ja" dir="ltr">vim-easymotion, あぁ〜カーソルがぴょんぴょんするんじゃぁ〜 って感じだ</p>&mdash; はやぶさ (@haya14busa) <a href="https://twitter.com/haya14busa/status/687679866175500288">January 14, 2016</a></blockquote>


<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>




<script src="http://lab.lepture.com/github-cards/widget.js"></script>

</div>
  
  


      <footer>
      
      - <a href="/vim-easymotion-ver-3-dot-0-overwin-motions/">Vimのカーソル移動はもっともっと爆速になる! Vim-EasyMotion v3.0 をリリースしました</a>
      <time datetime="2016-01-19T03:14:43+09:00" pubdate><span class='month'>Jan</span> <span class='day'>19</span> <span class='year'>2016</span></time>
      
      <span class="categories">posted in <a class='category' href='/categories/vim/'>vim</a></span>
      
      </footer>
    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/archives">Blog Archives</a>
    
  </div><!-- /div.pagination -->
</div><!-- /div.blog-index -->

      </div><!-- /div#content -->
    </div><!-- /div#main -->
  </div><!-- /div.container -->
  <footer><div id="footer-widgets-wrapper">
  <div id="footer-first" class="footer-widget">
    <h3>About Me</h3>
    <section class="about-me">
      
        <img class="icon-image" src="https://0.gravatar.com/avatar/dca89778aa3e6bc49f0e100df1a1a1f0?s=240" alt="icon_image">
      
      <div>
        <ul>
          
            <li>GitHub: <a href="https://github.com/haya14busa">@haya14busa</a></li>
          
          
            <li>Twitter: <a href="https://twitter.com/haya14busa">@haya14busa</a></li>
          
            <li>Blog: <a href="http://haya14busa.com">http://haya14busa.com</a></li>
        </ul>
        <p>
          V!mm!shment Th!s World!
        </p>
      </div>
    </section>
  </div><!-- /div#footer-second -->

  <div id="footer-second" class="footer-widget">
    <h3>Recent Posts</h3>
    <section id="hatena-popular" class="hatena-bookmark">
      <script language="javascript" type="text/javascript" src="http://b.hatena.ne.jp/js/widget.js" charset="utf-8"></script>
      <script language="javascript" type="text/javascript">
        Hatena.BookmarkWidget.url   = "http://haya14busa.com";
        Hatena.BookmarkWidget.title = "Recent Posts";
        Hatena.BookmarkWidget.sort  = "hot";
        Hatena.BookmarkWidget.width = 0;
        Hatena.BookmarkWidget.num   = 10;
        Hatena.BookmarkWidget.theme = "notheme";
        Hatena.BookmarkWidget.load();
      </script>
    </section>
  </div><!-- /div#footer-second -->

  <div id="footer-third" class="footer-widget">
    <h3>Popular Posts</h3>
    <section id="hatena-popular" class="hatena-bookmark">
      <script language="javascript" type="text/javascript" src="http://b.hatena.ne.jp/js/widget.js" charset="utf-8"></script>
      <script language="javascript" type="text/javascript">
        Hatena.BookmarkWidget.url   = "http://haya14busa.com";
        Hatena.BookmarkWidget.title = "Popular Posts";
        Hatena.BookmarkWidget.sort  = "count";
        Hatena.BookmarkWidget.width = 0;
        Hatena.BookmarkWidget.num   = 10;
        Hatena.BookmarkWidget.theme = "notheme";
        Hatena.BookmarkWidget.load();
      </script>
    </section>
  </div><!-- /div#footer-third -->
</div><!-- /div#footer-widgets-wrapper -->

<div id="credit" role="contentinfo">
  <p>
    Copyright &copy; 2016 - <a href="https://github.com/haya14busa/">haya14busa</a> -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/haya14busa/mjolvim-octotheme">Mjolvim</a></span>
  </p>
</div>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'haya14busa-s-memo';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
